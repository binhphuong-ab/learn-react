# REACT MASTERY BLUEPRINT: T·ª™ T∆Ø DUY OBJECT ƒê·∫æN KI·∫æN TR√öC ·ª®NG D·ª§NG

## GI·ªöI THI·ªÜU

T√†i li·ªáu n√†y ƒë∆∞·ª£c thi·∫øt k·∫ø d·ª±a tr√™n tri·∫øt l√Ω: **"React kh√¥ng ph·∫£i l√† ma thu·∫≠t, React l√† C·∫•u tr√∫c d·ªØ li·ªáu v√† H√†m"**. Ch∆∞∆°ng tr√¨nh t·∫≠p trung v√†o vi·ªác hi·ªÉu s√¢u b·∫£n ch·∫•t (Deep Dive) thay v√¨ ch·ªâ h·ªçc c√∫ ph√°p b·ªÅ m·∫∑t.

## PH·∫¶N 1: L·ªò TR√åNH H·ªåC T·∫¨P CHI TI·∫æT (SYLLABUS)

### Giai ƒëo·∫°n 1: B·∫£n ch·∫•t c·ªët l√µi (The Core & Mental Model)

_M·ª•c ti√™u: Hi·ªÉu nh·ªØng g√¨ x·∫£y ra "d∆∞·ªõi n·∫Øp capo" tr∆∞·ªõc khi React v·∫Ω l√™n m√†n h√¨nh._

1. **React Element: Gi·∫£i ph·∫´u "T·∫ø b√†o" c·ªßa React**
    - 1.1. ƒê·ªãnh nghƒ©a l·∫°i
    - 1.2. C·∫•u tr√∫c gi·∫£i ph·∫´u (Anatomy)
2. **Component: C√°i m√°y in Object**
    - 2.1. √în t·∫≠p: C√∫ ph√°p h√†m chu·∫©n (Standard Function Syntax)
    - 2.2. B·∫£n ch·∫•t
    - 2.3. Ph√¢n lo·∫°i `type`
3. **Props & Children: C∆° ch·∫ø truy·ªÅn t·∫£i**
    - 3.1. Props l√† b·∫•t bi·∫øn (Read-only)
    - 3.2. Children: L·ªó h·ªïng kh√¥ng gian
4. **B√†i t·∫≠p th·ª±c h√†nh (Module 1)**

### Giai ƒëo·∫°n 2: S·ª± s·ªëng c·ªßa ·ª®ng d·ª•ng (State & Interactivity)

_M·ª•c ti√™u: Bi·∫øn c√°c Object tƒ©nh th√†nh giao di·ªán ƒë·ªông._

1. **T·∫°i sao bi·∫øn th∆∞·ªùng kh√¥ng ho·∫°t ƒë·ªông?**
2. **Hook `useState`: B·ªô nh·ªõ c·ªßa Component**
    - 2.1. C√∫ ph√°p chu·∫©n
    - 2.2. Mental Model: Snapshot (·∫¢nh ch·ª•p)
    - 2.3. Can you use other data types?
    - 2.4. A Warning on Objects & Arrays
3. **Event Handling: B·∫Øt s·ª± ki·ªán ƒë√∫ng c√°ch**
4. **Rendering Lists: Hi·ªÉn th·ªã m·∫£ng d·ªØ li·ªáu**
    - 4.0. B·∫£n ch·∫•t c·ªët l√µi: Array vs Object
    - 4.1. S·ª≠ d·ª•ng `.map()`
    - 4.2. T·∫°i sao c·∫ßn `key`?
5. **V√≠ d·ª• t·ªïng h·ª£p (Complex Example)**
    - 5.0. B√†i to√°n v√† Code m·∫´u
    - 5.1. Ph√¢n t√≠ch chi ti·∫øt v√≠ d·ª• (Deep Dive)
    - 5.2. Lu·ªìng d·ªØ li·ªáu m·ªôt chi·ªÅu (One-way Data Flow)
    - 5.3. Props Destructuring: Hi·ªÉu s√¢u v·ªÅ Input
    - 5.4. Quy t·∫Øc ƒë·∫∑t t√™n tham s·ªë (Parameter Naming)
    - 5.5. Quy ∆∞·ªõc ƒë·∫∑t t√™n trong React (Naming Conventions)
    - 5.6. T√≥m t·∫Øt: 4 Tr·ª• c·ªôt React trong v√≠ d·ª•
6. **B√†i t·∫≠p th·ª±c h√†nh (Module 2)**

### Giai ƒëo·∫°n 3: K·∫øt n·ªëi th·∫ø gi·ªõi b√™n ngo√†i (Side Effects)

_M·ª•c ti√™u: Tho√°t kh·ªèi "h·ªôp k√≠n" c·ªßa React ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi API, Browser._

1. **Pure Function vs Side Effects**
    - 1.1. Pure Function (H√†m thu·∫ßn khi·∫øt) - Ti√™u chu·∫©n v√†ng
    - 1.2. Side Effects (T√°c d·ª•ng ph·ª•) - Nh·ªØng k·∫ª ph√° bƒ©nh
2. **Hook `useEffect`: N∆°i tr√∫ ·∫©n c·ªßa Side Effects**
    - 2.1. Logic ho·∫°t ƒë·ªông
3. **Dependency Array: C√°i phanh c·ªßa useEffect**
4. **Cleanup Function: D·ªçn d·∫πp chi·∫øn tr∆∞·ªùng**
5. **B√†i t·∫≠p th·ª±c h√†nh (Module 3)**

### Giai ƒëo·∫°n 4: Ki·∫øn tr√∫c v√† Lu·ªìng d·ªØ li·ªáu (Architecture)

_M·ª•c ti√™u: T·ªï ch·ª©c code cho ·ª©ng d·ª•ng l·ªõn, Clean Code._

1. **Lifting State Up: ƒê∆∞a tr·∫°ng th√°i l√™n cao**
2. **Context API: ƒê∆∞·ªùng h·∫ßm xuy√™n kh√¥ng**
3. **Custom Hooks: V≈© kh√≠ c·ªßa chuy√™n gia**
4. **B√†i t·∫≠p th·ª±c h√†nh (Module 4)**

### Giai ƒëo·∫°n 5: Hi·ªáu nƒÉng & H·ªá sinh th√°i (Advanced)

1. **Performance: Ngh·ªá thu·∫≠t c·ªßa vi·ªác "L∆∞·ªùi bi·∫øng"**
    - 1.1. React.memo: Chi·∫øc khi√™n b·∫£o v·ªá
    - 1.2. useMemo & useCallback: B·ªô nh·ªõ ƒë·ªám (Cache)
2. **Forms: Giao ti·∫øp v·ªõi ng∆∞·ªùi d√πng**
    - 2.1. Controlled Component (Khuy√™n d√πng)
    - 2.2. Uncontrolled Component
3. **Routing: ·∫¢o thu·∫≠t chuy·ªÉn trang (SPA)**
    

## PH·∫¶N 2: T√ÄI LI·ªÜU CHI TI·∫æT - MODULE 1: B·∫¢N CH·∫§T C·ª¶A ELEMENT

### 1. React Element: Gi·∫£i ph·∫´u "T·∫ø b√†o" c·ªßa React

#### 1.1. ƒê·ªãnh nghƒ©a l·∫°i

React Element kh√¥ng ph·∫£i l√† m·ªôt node HTML th·∫≠t tr√™n tr√¨nh duy·ªát. N√≥ l√† m·ªôt **Plain JavaScript Object** (Object thu·∫ßn t√∫y) m√¥ t·∫£ giao di·ªán.

> **Mental Model:** H√£y coi Element l√† m·ªôt "B·∫£n thi·∫øt k·∫ø" ho·∫∑c m·ªôt "T·ªù order m√≥n ƒÉn". B·∫°n ƒë∆∞a t·ªù order n√†y cho React (ƒë·∫ßu b·∫øp), React s·∫Ω l√†m ra m√≥n ƒÉn th·∫≠t (DOM Node).

#### 1.2. C·∫•u tr√∫c gi·∫£i ph·∫´u (Anatomy)

M·ªôt Element Object ti√™u chu·∫©n ƒë∆∞·ª£c React t·∫°o ra s·∫Ω c√≥ d·∫°ng:

```javascript
const element = {
  // 1. Lo·∫°i danh t√≠nh (Identity)
  type: 'div', // Ho·∫∑c l√† function component: type: MyComponent
  
  // 2. T√∫i d·ªØ li·ªáu (Data bag)
  props: {
    id: 'container',
    className: 'wrapper',
    style: { color: 'red' }, // Style lu√¥n l√† object (L∆∞u √Ω: property d√πng camelCase, v√≠ d·ª• `backgroundColor` thay v√¨ `background-color`)
    
    // 3. N·ªôi dung b√™n trong (Nesting)
    children: [
        // Ch·ª©a c√°c Element Object con kh√°c
        { type: 'span', props: { children: 'Hello' } } 
    ]
  },
  
  // 4. C√°c ƒë·ªãnh danh ƒë·∫∑c bi·ªát (S·∫Ω h·ªçc ·ªü Module 2)
  key: null,
  ref: null
};
```

### 2. Component: C√°i m√°y in Object

#### 2.1. √în t·∫≠p: C√∫ ph√°p h√†m chu·∫©n (Standard Function Syntax)

C√∫ ph√°p chung cho m·ªôt h√†m chu·∫©n trong JavaScript (v√† React) tu√¢n theo m·∫´u sau:

```javascript
function functionName(parameters) {
  // Th√¢n h√†m (Body)
  // ... th·ª±c hi·ªán c√¥ng vi·ªác ...
  
  return value; // K·∫øt qu·∫£ tr·∫£ v·ªÅ
}
```

Gi·∫£i th√≠ch c√°c th√†nh ph·∫ßn:

1. **`function`**: T·ª´ kh√≥a b√°o hi·ªáu "T√¥i s·∫Øp ƒë·ªãnh nghƒ©a m·ªôt h√†nh ƒë·ªông m·ªõi."
2. **`functionName`**: T√™n b·∫°n ƒë·∫∑t cho h√†m (v√≠ d·ª•: `calculateTotal`, `handleClick`).
3. **`(parameters)`**: C√°c ƒë·∫ßu v√†o (inputs) c·∫ßn thi·∫øt ƒë·ªÉ h√†m l√†m vi·ªác. C√≥ th·ªÉ ƒë·ªÉ tr·ªëng `()` n·∫øu kh√¥ng c·∫ßn ƒë·∫ßu v√†o.
4. **`{ ... }`**: "Th√¢n h√†m" hay "kh·ªëi l·ªánh". M·ªçi logic code ƒë·ªÅu n·∫±m trong c·∫∑p ngo·∫∑c nh·ªçn n√†y.
5. **`return`**: T·ª´ kh√≥a ƒë·ªÉ d·ª´ng h√†m v√† g·ª≠i k·∫øt qu·∫£ v·ªÅ n∆°i ƒë√£ g·ªçi n√≥.

**V√≠ d·ª• 1: H√†m c√≥ ƒë·∫ßu v√†o v√† ƒë·∫ßu ra**

M·ªôt c·ªó m√°y nh·∫≠n nguy√™n li·ªáu v√† tr·∫£ v·ªÅ m·ªôt chi·∫øc b√°nh.

```javascript
// Input: m·ªôt s·ªë (x)
// Output: tr·∫£ v·ªÅ m·ªôt s·ªë
function double(x) {
  // 1. Th·ª±c hi·ªán c√¥ng vi·ªác (Do some work)
  console.log("ƒêang t√≠nh to√°n nh√¢n ƒë√¥i cho s·ªë: " + x);
  let result = x * 2;

  // 2. Tr·∫£ v·ªÅ k·∫øt qu·∫£ (Return result)
  return result;
}

// S·ª≠ d·ª•ng:
let result = double(5); // result tr·ªü th√†nh 10
```

**V√≠ d·ª• 2: H√†m kh√¥ng c√≥ ƒë·∫ßu v√†o (Tham s·ªë r·ªóng)**

M·ªôt c·ªó m√°y ch·ªâ ƒë∆°n gi·∫£n l√† cho b·∫°n bi·∫øt th·ªùi gian.

```javascript
// Input: Kh√¥ng
// Output: tr·∫£ v·ªÅ chu·ªói
function sayHello() {
  return "Hello World!";
}
```

**V√≠ d·ª• 3: H√†m kh√¥ng c√≥ gi√° tr·ªã tr·∫£ v·ªÅ (Void)**

M·ªôt c·ªó m√°y b·∫≠t ƒë√®n l√™n nh∆∞ng kh√¥ng ƒë∆∞a l·∫°i cho b·∫°n th·ª© g√¨.

```javascript
// Input: Kh√¥ng
// Output: Kh√¥ng (void)
function turnOnLight() {
  console.log("Light is on");
  // Kh√¥ng c√≥ t·ª´ kh√≥a return ·ªü ƒë√¢y ng·∫ßm hi·ªÉu l√† tr·∫£ v·ªÅ 'undefined'
}
```

To understand the difference, think of a function like a **Calculator** (Returner), a **Commander** (Doer), or a **Cashier** (Both).

Here are the three types of arrow functions broken down by their behavior and syntax.

---

### **1. Returner Only (The "Calculator")**

These functions are pure logic. They take an input, process it, and hand back a result immediately. They do not change anything in the outside world.

```javascript
const double = (n) => n * 2;
```

| Category | Component | Description |
| --- | --- | --- |
| **Action** | `n * 2` | **Implicit Return:** The result is sent back automatically because there are no `{}`. |
| **Input** | `n` | **Data Type:** `Number`. |
| **Output** | `n * 2` | **Data Type:** `Number`. |
| **Behavior** | **Pure Calculation:** If you call this 100 times, nothing in your app changes; you just get numbers back. |  |

---

### **2. Doer Only (The "Commander")**

These functions perform an action but return "nothing" (`undefined`). They are used for side effects like logging, alerts, or updating global variables.

```javascript
const logSuccess = (userName) => {
  console.log("Access granted for: " + userName);
  alert("Welcome back!");
};
```

| Category | Component | Description |
| --- | --- | --- |
| **Action** | `console.log`, `alert` | **Side Effects:** Tasks performed in the browser/console. |
| **Input** | `userName` | **Data Type:** `String`. |
| **Output** | `undefined` | **Data Type:** `Undefined`. The function finishes and "dies" without giving data back. |
| **Behavior** | **Task Execution:** This changes the UI (shows an alert) but cannot be used to set a variable value. |  |

---

### **3. Both: Returner & Doer (The "Cashier")**

These functions perform a task (like logging or saving) **and** give you a result back. This is common when you want to confirm an action was successful or see the "before and after" of data.

```javascript
const updateAndNotify = (price, tax) => {
  const total = price + tax;          // 1. Math (Internal Variable)
  console.log("Total is: " + total);  // 2. Doer (Action)
  return total;                       // 3. Returner (Output)
};
```

| Category | Component | Description |
| --- | --- | --- |
| **Action** | `total = p + t` | **Calculation:** Preparing the data. |
| **Action** | `console.log` | **Action:** Notifying the developer. |
| **Input** | `price`, `tax` | **Data Type:** `Number`, `Number`. |
| **Output** | `total` | **Data Type:** `Number`. The final result sent back to the caller. |
| **Behavior** | **Hybrid:** It changes the outside world (log) and provides a value to be stored in state or another variable. |  |

---

### **Summary Table**

| Type | Syntax Hint | Analogy | Resulting Value |
| --- | --- | --- | --- |
| **Returner Only** | No `{}` or `return` keyword | A **Thermometer** (tells you the temp). | The calculation result. |
| **Doer Only** | Uses `{}` but no `return` | A **Doorbell** (makes a sound). | `undefined` |
| **Both** | Uses `{}` AND `return` | A **ATM** (gives cash AND prints a receipt). | The returned value. |

---

### **Natural Language Summary**

"You choose your arrow function style based on the goal: use the shorthand 'Returner' for quick math, the bracketed 'Doer' for triggering actions, and the full 'Hybrid' version when you need to perform a task and get an answer back at the same time."

#### 2.2. B·∫£n ch·∫•t

Component hi·ªán ƒë·∫°i l√† m·ªôt **H√†m (Function)** b·∫Øt bu·ªôc c√≥ t√™n b·∫Øt ƒë·∫ßu b·∫±ng **ch·ªØ c√°i in hoa** (v√≠ d·ª•: `UserCard`).

- **Input:** Nh·∫≠n v√†o m·ªôt object t√™n l√† `props`.
    
- **Process:** X·ª≠ l√Ω logic, t√≠nh to√°n.
    
- **Output:** Tr·∫£ v·ªÅ m·ªôt Element Object (th∆∞·ªùng vi·∫øt d∆∞·ªõi d·∫°ng JSX).
    

#### 2.3. Ph√¢n lo·∫°i `type`

React d·ª±a v√†o thu·ªôc t√≠nh `type` trong Element Object ƒë·ªÉ quy·∫øt ƒë·ªãnh h√†nh ƒë·ªông:

| **Lo·∫°i type** | **Gi√° tr·ªã**                    | **H√†nh ƒë·ªông c·ªßa React**                                                                                             |
| ------------- | ------------------------------ | ------------------------------------------------------------------------------------------------------------------- |
| **DOM Tag**   | Chu·ªói String (`'div'`, `'h1'`) | **V·∫Ω ngay:** T·∫°o DOM Node t∆∞∆°ng ·ª©ng tr√™n tr√¨nh duy·ªát.                                                               |
| **Component** | H√†m Function (`UserCard`)      | **H·ªèi ti·∫øp:** G·ªçi h√†m `UserCard(props)` ƒë·ªÉ xem b√™n trong n√≥ tr·∫£ v·ªÅ c√°i g√¨. Ti·∫øp t·ª•c ƒë·ªá quy ƒë·∫øn khi ƒë·∫°t ƒë·∫øn DOM Tag. |

### 3. Props & Children: C∆° ch·∫ø truy·ªÅn t·∫£i

#### 3.1. Props l√† b·∫•t bi·∫øn (Read-only)

M·ªôt nguy√™n t·∫Øc v√†ng: **Component kh√¥ng bao gi·ªù ƒë∆∞·ª£c s·ª≠a ƒë·ªïi `props` c·ªßa ch√≠nh n√≥.** `props` l√† d·ªØ li·ªáu t·ª´ "S·∫øp" (Component cha) ƒë∆∞a xu·ªëng. "Nh√¢n vi√™n" (Component con) ch·ªâ ƒë∆∞·ª£c d√πng, kh√¥ng ƒë∆∞·ª£c s·ª≠a.

#### 3.2. Children: L·ªó h·ªïng kh√¥ng gian

`children` l√† m·ªôt prop ƒë·∫∑c bi·ªát gi√∫p t·∫°o ra c√°c Component d·∫°ng **Container** (H·ªôp ch·ª©a).

**Best Practice:** S·ª≠ d·ª•ng `children` ƒë·ªÉ t·ªëi ∆∞u h√≥a vi·ªác t√°i s·ª≠ d·ª•ng layout.

**V√≠ d·ª• Code (T∆∞ duy Best Practice):**

```jsx
// 1. T·∫°o c√°i Khung (Container)
// Component n√†y kh√¥ng quan t√¢m n·ªôi dung b√™n trong l√† g√¨, ch·ªâ lo c√°i v·ªè.
const Card = ({ children, theme }) => { // Destructuring props tr·ª±c ti·∫øp
  const style = theme === 'dark' ? { background: '#333', color: '#fff' } : { background: '#fff' };
  return (
    <div className="card-shadow" style={style}>
      {children} {/* N∆°i n·ªôi dung ƒë∆∞·ª£c b∆°m v√†o */}
    </div>
  );
};

// 2. S·ª≠ d·ª•ng (Implementation)
function App() {
  return (
    <main>
      {/* T√°i s·ª≠ d·ª•ng l·∫ßn 1: Ch·ª©a ·∫£nh v√† text */}
      <Card theme="light">
         <img src="avatar.png" />
         <h3>User Profile</h3>
      </Card>

      {/* T√°i s·ª≠ d·ª•ng l·∫ßn 2: Ch·ª©a form */}
      <Card theme="dark">
         <h3>Login</h3>
         <input type="text" />
      </Card>
    </main>
  );
}
```

### 4. B√†i t·∫≠p th·ª±c h√†nh (Module 1)

**Y√™u c·∫ßu:** Kh√¥ng d√πng JSX, h√£y d√πng `React.createElement` (ho·∫∑c vi·∫øt object literal gi·∫£ l·∫≠p) ƒë·ªÉ t·∫°o ra c·∫•u tr√∫c sau. B√†i t·∫≠p n√†y gi√∫p n√£o b·ªô kh·∫Øc ghi c·∫•u tr√∫c Object.

**HTML m·ª•c ti√™u:**

```html
<div id="app">
  <h1 class="title">My App</h1>
  <button onclick="alert('hi')">Click me</button>
</div>
```

**L·ªùi gi·∫£i (T∆∞ duy Object):**

```javascript
const appElement = {
  type: 'div',
  props: {
    id: 'app',
    children: [
      {
        type: 'h1',
        props: { className: 'title', children: 'My App' }
      },
      {
        type: 'button',
        props: { 
            onClick: () => alert('hi'), // Ch√∫ √Ω: Event trong React d√πng camelCase (onClick) kh√°c v·ªõi HTML (onclick) 
            children: 'Click me' 
        }
      }
    ]
  }
};
```

## PH·∫¶N 3: T√ÄI LI·ªÜU CHI TI·∫æT - MODULE 2: STATE V√Ä S·ª∞ T∆Ø∆†NG T√ÅC (INTERACTIVITY)

### 1. T·∫°i sao bi·∫øn th∆∞·ªùng kh√¥ng ho·∫°t ƒë·ªông?

H√£y b·∫Øt ƒë·∫ßu b·∫±ng m·ªôt sai l·∫ßm kinh ƒëi·ªÉn c·ªßa ng∆∞·ªùi m·ªõi h·ªçc. Gi·∫£ s·ª≠ ta mu·ªën l√†m b·ªô ƒë·∫øm s·ªë l·∫ßn click.

**‚ùå C√°ch l√†m sai (T∆∞ duy Javascript th∆∞·ªùng):**

```jsx
function Counter() {
  let count = 0; // Bi·∫øn c·ª•c b·ªô

  function handleClick() {
    count = count + 1;
    console.log(count); // Log ra 1, 2, 3... nh∆∞ng m√†n h√¨nh v·∫´n hi·ªán 0
  }

  return <button onClick={handleClick}>{count}</button>;
}
```

**T·∫°i sao sai?**

1. **Bi·∫øn c·ª•c b·ªô kh√¥ng t·ªìn t·∫°i l√¢u d√†i:** M·ªói khi Component render l·∫°i (ch·∫°y l·∫°i h√†m `Counter`), bi·∫øn `count` l·∫°i ƒë∆∞·ª£c kh·ªüi t·∫°o l·∫°i b·∫±ng 0.
    
2. **React kh√¥ng bi·∫øt:** Vi·ªác thay ƒë·ªïi bi·∫øn `count` kh√¥ng k√≠ch ho·∫°t c∆° ch·∫ø render l·∫°i. React "m√π" tr∆∞·ªõc s·ª± thay ƒë·ªïi n√†y.
    

üëâ **Gi·∫£i ph√°p:** C·∫ßn m·ªôt c∆° ch·∫ø ƒë·ªÉ b√°o hi·ªáu cho React: _"D·ªØ li·ªáu thay ƒë·ªïi r·ªìi, h√£y ch·∫°y l·∫°i h√†m component v√† v·∫Ω l·∫°i giao di·ªán ƒëi!"_ => ƒê√≥ l√† **State**.

### 2. Hook `useState`: B·ªô nh·ªõ c·ªßa Component

`useState` l√† m·ªôt Hook (c√°i m√≥c) gi√∫p Component c√≥ th·ªÉ "ghi nh·ªõ" th√¥ng tin gi·ªØa c√°c l·∫ßn render.

#### 2.1. C√∫ ph√°p chu·∫©n

```javascript
const [state, setState] = useState(initialValue);
```

- **`state`**: Bi·∫øn ch·ª©a gi√° tr·ªã hi·ªán t·∫°i (V√≠ d·ª•: `count` = 0).
    
- **`setState`**: H√†m d√πng ƒë·ªÉ c·∫≠p nh·∫≠t gi√° tr·ªã **V√Ä** k√≠ch ho·∫°t React render l·∫°i.
    
- **`initialValue`**: Gi√° tr·ªã kh·ªüi t·∫°o l·∫ßn ƒë·∫ßu ti√™n.
    

#### 2.2. Mental Model: Snapshot (·∫¢nh ch·ª•p)

ƒê√¢y l√† ph·∫ßn kh√≥ hi·ªÉu nh·∫•t nh∆∞ng quan tr·ªçng nh·∫•t. H√£y kh·∫Øc c·ªët ghi t√¢m c√¢u n√†y:

> **"State updates trigger re-renders." (C·∫≠p nh·∫≠t State s·∫Ω k√≠ch ho·∫°t Render l·∫°i)**

**Quy tr√¨nh di·ªÖn ra:**

1. **L·∫ßn ƒë·∫ßu ti√™n (Mount):**
    
    - React g·ªçi `Counter()`.
        
    - `useState(0)` tr·∫£ v·ªÅ `[0, setCount]`.
        
    - Component tr·∫£ v·ªÅ JSX v·ªõi s·ªë `0`.
        
    - React v·∫Ω s·ªë `0` l√™n m√†n h√¨nh.
        
2. **Ng∆∞·ªùi d√πng b·∫•m n√∫t (Click):**
    
    - H√†m `handleClick` g·ªçi `setCount(1)`.
        
    - React nh·∫≠n t√≠n hi·ªáu: "√Ä, d·ªØ li·ªáu c≈© h·ªèng r·ªìi, c·∫ßn v·∫Ω l·∫°i".
        
3. **L·∫ßn render th·ª© 2 (Re-render):**
    
    - React g·ªçi l·∫°i `Counter()`.
        
    - `useState(0)` l√∫c n√†y c·ª±c th√¥ng minh, n√≥ nh·ªõ gi√° tr·ªã c≈© l√† 1, n√™n tr·∫£ v·ªÅ `[1, setCount]`.
        
    - Component tr·∫£ v·ªÅ JSX v·ªõi s·ªë `1`.
        
    - React c·∫≠p nh·∫≠t s·ªë `1` l√™n m√†n h√¨nh.
        

**V√≠ d·ª• code minh h·ªça:**

```jsx
import { useState } from 'react';

function Counter() {
  // useState creates a "memory slot" for this component
  // Initial value: 0
  const [count, setCount] = useState(0);

  function handleClick() {
    // This tells React: "Hey, the data changed! Please re-render!"
    setCount(count + 1);
  }

  return (
    <div>
      <h1>Count: {count}</h1>
      <button onClick={handleClick}>
        Click me!
      </button>
    </div>
  );
}

export default Counter;
```

**ƒêi·ªÅu g√¨ x·∫£y ra khi b·∫°n click n√∫t 3 l·∫ßn?**

| L·∫ßn click | Gi√° tr·ªã `count` | H√†nh ƒë·ªông c·ªßa React |
|---|---|---|
| **L·∫ßn ƒë·∫ßu (Mount)** | `0` | Render l·∫ßn ƒë·∫ßu, hi·ªÉn th·ªã "Count: 0" |
| **Click 1** | `0 ‚Üí 1` | `setCount(1)` ƒë∆∞·ª£c g·ªçi ‚Üí React so s√°nh ‚Üí Re-render ‚Üí Hi·ªÉn th·ªã "Count: 1" |
| **Click 2** | `1 ‚Üí 2` | `setCount(2)` ƒë∆∞·ª£c g·ªçi ‚Üí React so s√°nh ‚Üí Re-render ‚Üí Hi·ªÉn th·ªã "Count: 2" |
| **Click 3** | `2 ‚Üí 3` | `setCount(3)` ƒë∆∞·ª£c g·ªçi ‚Üí React so s√°nh ‚Üí Re-render ‚Üí Hi·ªÉn th·ªã "Count: 3" |

**ƒêi·ªÉm quan tr·ªçng:**

**V·ªÅ Event Handler:**
- `handleClick() {}` l√† **Wrapper Function** (Outer Function), ƒë√≥ng vai tr√≤ l√† **Event Handler**.
- Khi user click, tr√¨nh duy·ªát g·ªçi Wrapper Function n√†y, v√† b√™n trong n√≥ m·ªõi g·ªçi `setState()`/`setCount()`.

**V·ªÅ c∆° ch·∫ø Nh√¢n - Qu·∫£ (Cause & Effect):**

> **NGUY√äN NH√ÇN:** S·ª± thay ƒë·ªïi c·ªßa `A` (trong `setState(A)`) k√≠ch ho·∫°t re-render.  
> **K·∫æT QU·∫¢:** Bi·∫øn `state` thay ƒë·ªïi ch·ªâ sau khi re-render ho√†n t·∫•t.

**L∆∞u √Ω:** `A` c√≥ th·ªÉ l√†:

**1. Gi√° tr·ªã c·ª• th·ªÉ** (Literal Value): `setState(5)`, `setState("Hello")`
- React so s√°nh gi√° tr·ªã m·ªõi v·ªõi gi√° tr·ªã c≈©.
- **N·∫øu kh√°c nhau** ‚Üí Re-render.
- **N·∫øu gi·ªëng nhau** ‚Üí React b·ªè qua, kh√¥ng re-render (t·ªëi ∆∞u h√≥a).

**V√≠ d·ª• minh h·ªça:**

```jsx
function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(5)}>Set to 5</button>
      <button onClick={() => setCount(10)}>Set to 10</button>
    </div>
  );
}
```

**K·ªãch b·∫£n click:**

| H√†nh ƒë·ªông | Gi√° tr·ªã c≈© | Gi√° tr·ªã m·ªõi (`A`) | So s√°nh | K·∫øt qu·∫£ |
|---|---|---|---|---|
| Click "Set to 5" l·∫ßn 1 | `0` | `5` | `0 ‚â† 5` | ‚úÖ Re-render |
| Click "Set to 5" l·∫ßn 2 | `5` | `5` | `5 = 5` | ‚ùå Kh√¥ng re-render |
| Click "Set to 5" l·∫ßn 3 | `5` | `5` | `5 = 5` | ‚ùå Kh√¥ng re-render |
| Click "Set to 10" | `5` | `10` | `5 ‚â† 10` | ‚úÖ Re-render |
| Click "Set to 5" l·∫ßn 4 | `10` | `5` | `10 ‚â† 5` | ‚úÖ Re-render (v√¨ kh√°c!) |

**K·∫øt lu·∫≠n:** Gi√° tr·ªã c·ª• th·ªÉ **kh√¥ng ph·∫£i** ch·ªâ re-render 1 l·∫ßn. N√≥ c√≥ th·ªÉ re-render nhi·ªÅu l·∫ßn, mi·ªÖn l√† gi√° tr·ªã m·ªõi **kh√°c** v·ªõi gi√° tr·ªã hi·ªán t·∫°i.

---

**2. Bi·∫øn** (Variable): `setState(newValue)`

**C√¢u h·ªèi quan tr·ªçng:** T√¥i c√≥ th·ªÉ thay ƒë·ªïi bi·∫øn `newValue` ·ªü b√™n ngo√†i, sau ƒë√≥ g·ªçi `setState(newValue)` ƒë·ªÉ k√≠ch ho·∫°t re-render kh√¥ng?

**Tr·∫£ l·ªùi:** **C√ì**, nh∆∞ng ph·ª• thu·ªôc v√†o **ki·ªÉu d·ªØ li·ªáu** c·ªßa bi·∫øn.

React so s√°nh theo 2 c√°ch kh√°c nhau:

**A. Ki·ªÉu nguy√™n th·ªßy (Primitive Types):** Number, String, Boolean
- React so s√°nh **GI√Å TR·ªä** (Value Comparison).
- B·∫°n c√≥ th·ªÉ thay ƒë·ªïi bi·∫øn b√™n ngo√†i v√† `setState(newValue)` s·∫Ω ho·∫°t ƒë·ªông.

**V√≠ d·ª• - Ho·∫°t ƒë·ªông t·ªët:**

```jsx
function Counter() {
  const [count, setCount] = useState(0);
  
  function handleClick() {
    let newValue = 10;        // T·∫°o bi·∫øn b√™n ngo√†i
    newValue = newValue + 5;  // Bi·∫øn ƒë·ªïi bi·∫øn
    setCount(newValue);       // G·ªçi setState v·ªõi bi·∫øn ƒë√£ thay ƒë·ªïi
    // React so s√°nh: 0 ‚â† 15 ‚Üí Re-render ‚úÖ
  }
  
  return <button onClick={handleClick}>Count: {count}</button>;
}
```

**B. Ki·ªÉu tham chi·∫øu (Reference Types):** Object, Array
- React so s√°nh **ƒê·ªäA CH·ªà B·ªò NH·ªö** (Reference Comparison), kh√¥ng so s√°nh n·ªôi dung b√™n trong.
- **N·∫øu b·∫°n ch·ªâ s·ª≠a n·ªôi dung** m√† kh√¥ng t·∫°o object/array m·ªõi ‚Üí React **KH√îNG** ph√°t hi·ªán thay ƒë·ªïi.

**V√≠ d·ª• - ‚ùå KH√îNG ho·∫°t ƒë·ªông:**

```jsx
function UserProfile() {
  const [user, setUser] = useState({ name: "An", age: 25 });
  
  function handleClick() {
    let newUser = user;      // newUser tr·ªè ƒë·∫øn C√ôNG ƒë·ªãa ch·ªâ v·ªõi user
    newUser.age = 30;        // S·ª≠a n·ªôi dung (Mutation)
    setUser(newUser);        // ‚ùå React so s√°nh ƒë·ªãa ch·ªâ: GI·ªêNG NHAU ‚Üí Kh√¥ng re-render
  }
  
  return <button onClick={handleClick}>Age: {user.age}</button>;
}
```

**V√≠ d·ª• - ‚úÖ Ho·∫°t ƒë·ªông (T·∫°o object m·ªõi):**

```jsx
function UserProfile() {
  const [user, setUser] = useState({ name: "An", age: 25 });
  
  function handleClick() {
    let newUser = { ...user };  // T·∫°o object M·ªöI (ƒë·ªãa ch·ªâ kh√°c)
    newUser.age = 30;           // S·ª≠a n·ªôi dung
    setUser(newUser);           // ‚úÖ React so s√°nh ƒë·ªãa ch·ªâ: KH√ÅC NHAU ‚Üí Re-render
  }
  
  return <button onClick={handleClick}>Age: {user.age}</button>;
}
```

**B·∫£ng t√≥m t·∫Øt:**

| Ki·ªÉu d·ªØ li·ªáu | C√°ch so s√°nh | Thay ƒë·ªïi bi·∫øn b√™n ngo√†i | K·∫øt qu·∫£ |
|---|---|---|---|
| **Primitive** (Number, String, Boolean) | So s√°nh **gi√° tr·ªã** | `let x = 5; x = 10; setState(x)` | ‚úÖ Ho·∫°t ƒë·ªông |
| **Object/Array** (Mutation) | So s√°nh **ƒë·ªãa ch·ªâ** | `let obj = state; obj.x = 10; setState(obj)` | ‚ùå Kh√¥ng re-render |
| **Object/Array** (New Reference) | So s√°nh **ƒë·ªãa ch·ªâ** | `let obj = {...state}; obj.x = 10; setState(obj)` | ‚úÖ Ho·∫°t ƒë·ªông |

**K·∫øt lu·∫≠n:** B·∫°n c√≥ th·ªÉ thay ƒë·ªïi bi·∫øn b√™n ngo√†i, nh∆∞ng v·ªõi Object/Array, b·∫°n **PH·∫¢I t·∫°o b·∫£n sao m·ªõi** (new reference) thay v√¨ s·ª≠a tr·ª±c ti·∫øp (mutation).

**3. H√†m** (Function/Callback): `setState(prev => prev + 1)`

---

#### Ki·∫øn th·ª©c n·ªÅn t·∫£ng: Callback Function l√† g√¨?

Tr∆∞·ªõc khi ƒëi s√¢u v√†o `setState(prev => ...)`, h√£y hi·ªÉu **Callback Function** - m·ªôt kh√°i ni·ªám c·ªët l√µi trong JavaScript.

**ƒê·ªãnh nghƒ©a:**

**Callback Function** l√† m·ªôt h√†m ƒë∆∞·ª£c b·∫°n **truy·ªÅn v√†o** m·ªôt h√†m kh√°c nh∆∞ m·ªôt tham s·ªë. H√†m nh·∫≠n tham s·ªë ƒë√≥ s·∫Ω th·ª±c thi (g·ªçi l·∫°i - "call back") h√†m c·ªßa b·∫°n t·∫°i m·ªôt th·ªùi ƒëi·ªÉm n√†o ƒë√≥.

> *"T√¥i giao cho b·∫°n nhi·ªám v·ª• n√†y. Khi n√†o l√†m xong th√¨ **g·ªçi l·∫°i** (callback) cho t√¥i nh√©."*

---

#### M√¥ h√¨nh c∆° b·∫£n: `functionA(functionB)`

**Ch√≠nh x√°c 100%!** ƒê·ªãnh nghƒ©a ng·∫Øn g·ªçn nh·∫•t:

> B·∫•t c·ª© khi n√†o b·∫°n truy·ªÅn **t√™n** m·ªôt h√†m (`functionB`) v√†o b√™n trong ngo·∫∑c ƒë∆°n c·ªßa m·ªôt h√†m kh√°c (`functionA`), th√¨ `functionB` ch√≠nh l√† **Callback Function**.

Trong m√¥ h√¨nh `functionA(functionB)`:

1. **`functionB`**: ƒê∆∞·ª£c g·ªçi l√† **Callback Function** (H√†m ƒë∆∞·ª£c g·ªçi l·∫°i). N√≥ ƒë√≥ng vai tr√≤ l√† "kh√°ch" ho·∫∑c "c√¥ng c·ª•" ƒë∆∞·ª£c g·ª≠i ƒëi.
2. **`functionA`**: Trong k·ªπ thu·∫≠t, ng∆∞·ªùi ta g·ªçi n√≥ l√† **Higher-Order Function** (H√†m b·∫≠c cao). N√≥ ƒë√≥ng vai tr√≤ l√† "ch·ªß nh√†" ho·∫∑c "ng∆∞·ªùi th·ª±c thi". N√≥ nh·∫≠n `functionB` v√† s·∫Ω quy·∫øt ƒë·ªãnh *khi n√†o* th√¨ k√≠ch ho·∫°t `functionB`.

#### Quy t·∫Øc "s·ªëng c√≤n" ƒë·ªÉ nh·∫≠n di·ªán Callback

ƒê·ªÉ l√† m·ªôt callback h·ª£p l·ªá, khi truy·ªÅn v√†o, b·∫°n **KH√îNG ƒê∆Ø·ª¢C** d√πng d·∫•u ngo·∫∑c tr√≤n `()` sau t√™n h√†m.

* ‚úÖ **ƒê√öNG l√† Callback:**
  ```javascript
  functionA(functionB)
  ```
  *(D·ªãch: "N√†y A, c·∫ßm l·∫•y c√°i b·∫£n thi·∫øt k·∫ø B n√†y, l√∫c n√†o c·∫ßn th√¨ d√πng nh√©.")*

* ‚ùå **SAI (Kh√¥ng ph·∫£i Callback):**
  ```javascript
  functionA(functionB())
  ```
  *(D·ªãch: "N√†y A, t√¥i ƒë√£ ch·∫°y xong h√†m B r·ªìi, t√¥i ƒë∆∞a cho √¥ng c√°i k·∫øt qu·∫£ (v√≠ d·ª• s·ªë 10, hay chu·ªói text) m√† h√†m B tr·∫£ v·ªÅ nh√©.")* 
  
  ‚Üí L√∫c n√†y `functionA` nh·∫≠n **k·∫øt qu·∫£** ch·ª© kh√¥ng nh·∫≠n **c√°i h√†m**.

#### H√¨nh ·∫£nh ·∫©n d·ª•: N·ªìi ƒëa nƒÉng

B·∫°n c·ª© nh·ªõ h√¨nh ·∫£nh n√†y:

* **Callback (`functionB`)**: L√† c√°i **ph∆∞∆°ng ph√°p** (V√≠ d·ª•: ph∆∞∆°ng ph√°p "chi√™n", "x√†o", "lu·ªôc").
* **H√†m ch√≠nh (`functionA`)**: L√† c√°i **n·ªìi ƒëa nƒÉng**.

B·∫°n b·ªè ph∆∞∆°ng ph√°p "chi√™n" v√†o n·ªìi ‚Üí N·ªìi s·∫Ω chi√™n.  
B·∫°n b·ªè ph∆∞∆°ng ph√°p "lu·ªôc" v√†o n·ªìi ‚Üí N·ªìi s·∫Ω lu·ªôc.

---

**V√≠ d·ª• ƒë·ªùi s·ªëng: ƒê·∫∑t Pizza**

1. **H√†nh ƒë·ªông:** B·∫°n g·ªçi ƒëi·ªán ƒë·∫∑t Pizza.
2. **V·∫•n ƒë·ªÅ:** Pizza c·∫ßn 20 ph√∫t ƒë·ªÉ n∆∞·ªõng. B·∫°n kh√¥ng mu·ªën c·∫ßm ƒëi·ªán tho·∫°i ch·ªù im l·∫∑ng su·ªët 20 ph√∫t (ƒëi·ªÅu n√†y s·∫Ω l√†m "treo" b·∫°n).
3. **Gi·∫£i ph√°p (Callback):** B·∫°n n√≥i: *"Khi n√†o Pizza xong, h√£y g·ªçi v√†o s·ªë n√†y cho t√¥i"* (s·ªë ƒëi·ªán tho·∫°i = **Callback Function**).
4. **K·∫øt qu·∫£:** B·∫°n c√∫p m√°y v√† l√†m vi·ªác kh√°c. Khi Pizza xong, nh√¢n vi√™n g·ªçi l·∫°i s·ªë b·∫°n ƒë√£ ƒë∆∞a (th·ª±c thi Callback).

**T·∫°i sao c·∫ßn Callback?**

- **X·ª≠ l√Ω b·∫•t ƒë·ªìng b·ªô (Asynchronous):** M√°y t√≠nh kh√¥ng ph·∫£i ng·ªìi ch·ªù m·ªôt t√°c v·ª• n·∫∑ng (t·∫£i file, g·ªçi API, ch·ªù user click) l√†m xong m·ªõi ch·∫°y ti·∫øp. Ch∆∞∆°ng tr√¨nh kh√¥ng b·ªã "ƒë∆°".
- **T√°i s·ª≠ d·ª•ng code:** Vi·∫øt h√†m chung, cho ph√©p t√πy bi·∫øn h√†nh ƒë·ªông cu·ªëi c√πng b·∫±ng c√°c callback kh√°c nhau.

**Ph√¢n lo·∫°i Callback:**

**A. Callback ƒê·ªìng b·ªô (Synchronous)** - Th·ª±c thi ngay l·∫≠p t·ª©c

```javascript
const numbers = [1, 2, 3, 4, 5];

// isEven l√† callback function
function isEven(num) {
  return num % 2 === 0;
}

// filter() nh·∫≠n isEven l√†m tham s·ªë v√† g·ªçi n√≥ cho t·ª´ng ph·∫ßn t·ª≠
const evenNumbers = numbers.filter(isEven);
console.log(evenNumbers); // [2, 4]
```

**B. Callback B·∫•t ƒë·ªìng b·ªô (Asynchronous)** - Th·ª±c thi sau khi t√°c v·ª• ho√†n th√†nh

```javascript
console.log("1. B·∫Øt ƒë·∫ßu");

// setTimeout nh·∫≠n callback function l√†m tham s·ªë
setTimeout(function() {
  console.log("2. Xin ch√†o sau 2 gi√¢y!");
}, 2000);

console.log("3. K·∫øt th√∫c");

/*
K·∫øt qu·∫£:
1. B·∫Øt ƒë·∫ßu
3. K·∫øt th√∫c
... (ch·ªù 2 gi√¢y) ...
2. Xin ch√†o sau 2 gi√¢y!
*/
```

**L∆∞u √Ω:** D√≤ng s·ªë 3 ch·∫°y tr∆∞·ªõc d√≤ng s·ªë 2 - ƒë√≥ ch√≠nh l√† l·ª£i √≠ch c·ªßa b·∫•t ƒë·ªìng b·ªô: kh√¥ng ch·∫∑n code ph√≠a sau.

---

#### Callback trong React `setState()`

B√¢y gi·ªù √°p d·ª•ng kh√°i ni·ªám callback v√†o React:

**Callback function logic trong `setState()` l√† g√¨?**

Thay v√¨ truy·ªÅn **gi√° tr·ªã c·ªë ƒë·ªãnh** v√†o `setState()`, b·∫°n truy·ªÅn m·ªôt **h√†m (callback function)**. React s·∫Ω:
1. G·ªçi h√†m n√†y
2. Truy·ªÅn v√†o tham s·ªë `prev` (gi√° tr·ªã state **m·ªõi nh·∫•t** t·ª´ h√†ng ƒë·ª£i c·∫≠p nh·∫≠t)
3. L·∫•y gi√° tr·ªã m√† h√†m **return** l√†m state m·ªõi

**ƒê·∫∑c ƒëi·ªÉm:** Callback trong `setState()` l√† **ƒë·ªìng b·ªô** (synchronous) - React g·ªçi n√≥ ngay l·∫≠p t·ª©c trong qu√° tr√¨nh x·ª≠ l√Ω h√†ng ƒë·ª£i c·∫≠p nh·∫≠t.

**C√∫ ph√°p:**
```jsx
setState(prev => prev + 1)
//       ‚Üë      ‚Üë
//       |      ‚îî‚îÄ Gi√° tr·ªã return (state m·ªõi)
//       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Tham s·ªë (state hi·ªán t·∫°i/m·ªõi nh·∫•t)
```

---

**So s√°nh: Gi√° tr·ªã tr·ª±c ti·∫øp vs Callback Function**

**T√¨nh hu·ªëng:** B·∫°n mu·ªën tƒÉng `count` l√™n 3 ƒë∆°n v·ªã khi click 1 l·∫ßn.

**‚ùå C√°ch 1: Truy·ªÅn gi√° tr·ªã tr·ª±c ti·∫øp (Sai - Stale Closure)**

```jsx
function Counter() {
  const [count, setCount] = useState(0);
  
  function handleClick() {
    setCount(count + 1);  // count = 0 ‚Üí L√™n l·ªãch c·∫≠p nh·∫≠t th√†nh 1
    setCount(count + 1);  // count V·∫™N = 0 ‚Üí L√™n l·ªãch c·∫≠p nh·∫≠t th√†nh 1
    setCount(count + 1);  // count V·∫™N = 0 ‚Üí L√™n l·ªãch c·∫≠p nh·∫≠t th√†nh 1
    // K·∫øt qu·∫£: count ch·ªâ tƒÉng l√™n 1 (kh√¥ng ph·∫£i 3!)
  }
  
  return <button onClick={handleClick}>Count: {count}</button>;
}
```

**T·∫°i sao sai?**
- Trong **c√πng m·ªôt l·∫ßn render**, bi·∫øn `count` b·ªã "ƒë√≥ng bƒÉng" (closure) ·ªü gi√° tr·ªã `0`.
- C·∫£ 3 l·∫ßn g·ªçi `setCount` ƒë·ªÅu ƒë·ªçc `count = 0`, n√™n c·∫£ 3 ƒë·ªÅu t√≠nh `0 + 1 = 1`.
- React nh·∫≠n 3 l·ªánh: "C·∫≠p nh·∫≠t th√†nh 1", "C·∫≠p nh·∫≠t th√†nh 1", "C·∫≠p nh·∫≠t th√†nh 1" ‚Üí K·∫øt qu·∫£ cu·ªëi: `1`.

---

**‚úÖ C√°ch 2: Truy·ªÅn callback function (ƒê√∫ng)**

```jsx
function Counter() {
  const [count, setCount] = useState(0);
  
  function handleClick() {
    setCount(prev => prev + 1);  // prev = 0 ‚Üí return 1
    setCount(prev => prev + 1);  // prev = 1 ‚Üí return 2
    setCount(prev => prev + 1);  // prev = 2 ‚Üí return 3
    // K·∫øt qu·∫£: count tƒÉng l√™n 3 ‚úÖ
  }
  
  return <button onClick={handleClick}>Count: {count}</button>;
}
```

**T·∫°i sao ƒë√∫ng?**
- React x·ª≠ l√Ω **tu·∫ßn t·ª±** c√°c callback trong h√†ng ƒë·ª£i (queue).
- L·∫ßn 1: `prev = 0` ‚Üí return `1` ‚Üí React l∆∞u t·∫°m `1`
- L·∫ßn 2: `prev = 1` (gi√° tr·ªã m·ªõi nh·∫•t) ‚Üí return `2` ‚Üí React l∆∞u t·∫°m `2`
- L·∫ßn 3: `prev = 2` ‚Üí return `3` ‚Üí React l∆∞u t·∫°m `3`
- Sau ƒë√≥ m·ªõi re-render v·ªõi `count = 3`.

---

**Timeline so s√°nh chi ti·∫øt:**

| Th·ªùi ƒëi·ªÉm | C√°ch 1: `setCount(count + 1)` | C√°ch 2: `setCount(prev => prev + 1)` |
|---|---|---|
| **Tr∆∞·ªõc click** | `count = 0` | `count = 0` |
| **L·ªánh 1** | ƒê·ªçc `count = 0` ‚Üí L√™n l·ªãch `1` | Callback nh·∫≠n `prev = 0` ‚Üí return `1` |
| **L·ªánh 2** | ƒê·ªçc `count = 0` (v·∫´n c≈©) ‚Üí L√™n l·ªãch `1` | Callback nh·∫≠n `prev = 1` ‚Üí return `2` |
| **L·ªánh 3** | ƒê·ªçc `count = 0` (v·∫´n c≈©) ‚Üí L√™n l·ªãch `1` | Callback nh·∫≠n `prev = 2` ‚Üí return `3` |
| **K·∫øt qu·∫£** | `count = 1` ‚ùå | `count = 3` ‚úÖ |

---

**Khi n√†o d√πng Callback Function?**

| T√¨nh hu·ªëng | D√πng g√¨? | V√≠ d·ª• |
|---|---|---|
| C·∫≠p nh·∫≠t **d·ª±a tr√™n gi√° tr·ªã c≈©** | ‚úÖ Callback | `setCount(prev => prev + 1)` |
| C·∫≠p nh·∫≠t **nhi·ªÅu l·∫ßn li√™n ti·∫øp** trong c√πng event | ‚úÖ Callback | 3 l·∫ßn `setCount` trong 1 `handleClick` |
| C·∫≠p nh·∫≠t **gi√° tr·ªã c·ªë ƒë·ªãnh** | Gi√° tr·ªã tr·ª±c ti·∫øp | `setCount(10)` |
| C·∫≠p nh·∫≠t **kh√¥ng ph·ª• thu·ªôc** state c≈© | Gi√° tr·ªã tr·ª±c ti·∫øp | `setName("John")` |

---

**∆Øu ƒëi·ªÉm c·ªßa Callback Function:**
- ‚úÖ Lu√¥n nh·∫≠n gi√° tr·ªã **m·ªõi nh·∫•t** t·ª´ h√†ng ƒë·ª£i c·∫≠p nh·∫≠t.
- ‚úÖ Tr√°nh l·ªói **stale closure** (ƒë·ªçc gi√° tr·ªã c≈© b·ªã "ƒë√≥ng bƒÉng").
- ‚úÖ An to√†n khi c√≥ nhi·ªÅu l·∫ßn c·∫≠p nh·∫≠t li√™n ti·∫øp.

**K·∫øt lu·∫≠n:** Khi c·∫≠p nh·∫≠t state d·ª±a tr√™n gi√° tr·ªã c≈©, **lu√¥n d√πng callback function** `setState(prev => ...)` thay v√¨ `setState(state + 1)`.

**Timeline chi ti·∫øt (Quy tr√¨nh th·ª±c t·∫ø):**

V√≠ d·ª• v·ªõi `const [count, setCount] = useState(0)`:

1. **H√†nh ƒë·ªông:** User click ‚Üí `handleClick()` g·ªçi `setCount(1)`.
2. **React ki·ªÉm tra:** React l·∫•y gi√° tr·ªã `1` (ƒë·ªëi s·ªë `A`) so s√°nh v·ªõi `0` (gi√° tr·ªã c≈© trong kho l∆∞u tr·ªØ n·ªôi b·ªô).
3. **Quy·∫øt ƒë·ªãnh:** Th·∫•y kh√°c nhau ‚Üí React l√™n l·ªãch (schedule) re-render.
4. **Th·ª±c thi:** React ch·∫°y l·∫°i h√†m `Counter()` l·∫ßn th·ª© 2.
5. **K·∫øt qu·∫£:** ·ªû l·∫ßn ch·∫°y th·ª© 2, `useState(0)` tr·∫£ v·ªÅ `[1, setCount]`. L√∫c n√†y bi·∫øn `count` m·ªõi ch√≠nh th·ª©c mang gi√° tr·ªã `1`.

**T·∫°i sao bi·∫øn `state` kh√¥ng ph·∫£i nguy√™n nh√¢n?**
- V√¨ `const [state, setState] = useState(...)` ‚Üí T·ª´ kh√≥a `const` c√≥ nghƒ©a bi·∫øn `state` **b·ªã ƒë√≥ng bƒÉng** trong m·ªói l·∫ßn render.
- B·∫°n **kh√¥ng th·ªÉ** thay ƒë·ªïi `state` tr·ª±c ti·∫øp. B·∫°n ch·ªâ c√≥ th·ªÉ "y√™u c·∫ßu" React ƒë·ªïi n√≥ cho l·∫ßn render sau th√¥ng qua `setState(A)`.

**Mental Model: M√°y in ·∫£nh**

H√£y t∆∞·ªüng t∆∞·ª£ng Component l√† **M√°y in ·∫£nh** v√† `state` l√† **T·ªù ·∫£nh** ƒëang c·∫ßm tr√™n tay.

- **B·∫°n (User):** G·ªçi `setState(·∫¢nh M·ªõi)`.
- **React:** So s√°nh "·∫¢nh M·ªõi" (A) v√† "·∫¢nh C≈©". Th·∫•y kh√°c nhau ‚Üí React b·∫•m n√∫t "In l·∫°i".
- **M√°y in (Re-render):** Ch·∫°y v√π v√π v√† in ra m·ªôt t·ªù gi·∫•y m·ªõi.
- **K·∫øt qu·∫£:** L√∫c n√†y tr√™n tay b·∫°n m·ªõi c·∫ßm **T·ªù ·∫£nh m·ªõi** (`state` m·ªõi).

**B·∫£ng t√≥m t·∫Øt:**

| ƒê·ªëi t∆∞·ª£ng | Vai tr√≤ | Di·ªÖn gi·∫£i |
|---|---|---|
| **`setState(A)`** | **K√≠ch ho·∫°t (Trigger/Cause)** | "N√†y React, t√¥i mu·ªën gi√° tr·ªã l·∫ßn t·ªõi l√† `A`. H√£y ki·ªÉm tra v√† ch·∫°y l·∫°i ƒëi!" |
| **`state`** | **K·∫øt qu·∫£ (Result/Snapshot)** | L√† gi√° tr·ªã React ƒë∆∞a cho b·∫°n **SAU KHI** ƒë√£ re-render xong. |

**T√≥m l·∫°i:** B·∫°n g·ªçi `setState(A)` ‚Üí React so s√°nh `A` v·ªõi gi√° tr·ªã c≈© ‚Üí Th·∫•y kh√°c bi·ªát ‚Üí React ch·∫°y l·∫°i h√†m ‚Üí Bi·∫øn `state` m·ªõi ƒë∆∞·ª£c sinh ra.

#### 2.3. Can you use other data types?

When you write `useState(0)`, you are telling React: **"The initial value of this variable is the number `0`."**

Because JavaScript is dynamic, `count` becomes a **Number**.

**Yes!** `useState` can hold **absolutely anything** that JavaScript supports. It is not limited to numbers.

Here are the most common examples you will use:

##### 1. Text (String)

Used for names, input fields, or messages.

```javascript
const [name, setName] = useState("Phuong");
// usage: setName("Gemini")
```

##### 2. True/False (Boolean)

Used for toggles, switches, or showing/hiding things (like "Dark Mode").

```javascript
const [isMenuOpen, setIsMenuOpen] = useState(false);
// usage: setIsMenuOpen(true)
```

##### 3. Lists (Arrays)

Used for storing lists of data (like a list of tasks or products).

```javascript
const [tasks, setTasks] = useState(["Buy milk", "Clean room"]);
// usage: setTasks([...tasks, "New Task"])
```

*Note: We will talk about that `...` syntax later; it's a special way to add items to arrays in React.*

##### 4. Objects

Used when you have related data (like a user profile).

```javascript
const [user, setUser] = useState({ 
  name: "Phuong", 
  device: "iMac M1" 
});
```

##### 5. Nothing (null)

Used when you are waiting for data to load (like waiting for a stock price to download).

```javascript
const [data, setData] = useState(null);
```

#### 2.4. A Warning on Objects & Arrays

Remember our discussion about **"The New Object"**? This is very important for **Arrays** and **Objects**.

If you have a user object, you **cannot** just change one property like this:

```javascript
// ‚ùå WRONG: React won't see this change!
user.name = "New Name"; 
setUser(user); 
```

You must give React a **brand new object** for it to recognize the change:

```javascript
// ‚úÖ RIGHT: Create a new object with the new data
setUser({ 
  name: "New Name", 
  device: "iMac M1" 
});
```

### 3. Event Handling: B·∫Øt s·ª± ki·ªán ƒë√∫ng c√°ch

Trong React Element Object, s·ª± ki·ªán (Event) ch·ªâ l√† m·ªôt property n·∫±m trong `props`.

**Quy t·∫Øc:**

1. T√™n s·ª± ki·ªán d√πng **camelCase** (`onClick`, `onSubmit`, `onMouseEnter`).
    
2. Truy·ªÅn v√†o **H√†m definition** (ƒë·ªãnh nghƒ©a h√†m), kh√¥ng ph·∫£i g·ªçi h√†m ngay l·∫≠p t·ª©c.
    

**‚úÖ ƒê√∫ng:**

```jsx
<button onClick={handleClick}>Click me</button>
```

_(D·ªãch: "React ∆°i, khi n√†o user click th√¨ h√£y g·ªçi h√†m n√†y gi√∫p t√¥i")_

**‚ùå Sai (G·ªçi h√†m ngay l·∫≠p t·ª©c):**

```jsx
<button onClick={handleClick()}>Click me</button>
```

_(D·ªãch: "G·ªçi h√†m n√†y ngay b√¢y gi·ªù ƒëi", k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa h√†m s·∫Ω ƒë∆∞·ª£c g√°n v√†o onClick -> Sai logic v√† c√≥ th·ªÉ g√¢y v√≤ng l·∫∑p v√¥ t·∫≠n)_

#### V√≠ d·ª• m√£ ngu·ªìn ƒë·∫ßy ƒë·ªß (Full Simple Example)

ƒê√¢y l√† code c·ªßa m·ªôt component ho√†n ch·ªânh m√† b·∫°n c√≥ th·ªÉ copy ƒë·ªÉ ch·∫°y th·ª≠:

```jsx
function AlertButton() {
  // Logic x·ª≠ l√Ω s·ª± ki·ªán
  function handleClick() {
    alert("Xin ch√†o! B·∫°n ƒë√£ b·∫Øt s·ª± ki·ªán th√†nh c√¥ng.");
  }

  // JSX tr·∫£ v·ªÅ
  return (
    <button onClick={handleClick}>
      B·∫•m v√†o ƒë√¢y
    </button>
  );
}
```

#### V√≠ d·ª• n√¢ng cao: Custom Button v·ªõi Props & Events

Trong th·ª±c t·∫ø, b·∫°n s·∫Ω th∆∞·ªùng xuy√™n truy·ªÅn h√†m x·ª≠ l√Ω s·ª± ki·ªán t·ª´ Component cha xu·ªëng Component con th√¥ng qua Props.

```jsx
// 1. Component con (Nh·∫≠n props)
// Nhi·ªám v·ª•: Hi·ªÉn th·ªã giao di·ªán & b√°o c√°o l·∫°i khi ƒë∆∞·ª£c click
function CustomButton({ label, onCustomClick }) {
  // label: "Delete", "Save", ...
  // onCustomClick: L√† c√°i h√†m t·ª´ cha truy·ªÅn xu·ªëng
  
  return (
    // N·ªëi d√¢y: S·ª± ki·ªán onClick th·∫≠t c·ªßa browser -> g·ªçi h√†m onCustomClick c·ªßa cha
    <button onClick={onCustomClick} style={{ padding: '10px', margin: '5px' }}>
      {label}
    </button>
  );
}

// 2. Component cha (ƒê·ªãnh nghƒ©a logic)
// Nhi·ªám v·ª•: Quy·∫øt ƒë·ªãnh ƒëi·ªÅu g√¨ x·∫£y ra khi con ƒë∆∞·ª£c click
function App() {
  
  const handleDelete = () => {
    alert("ƒêang x√≥a d·ªØ li·ªáu...");
  };

  const handleSave = () => {
    console.log("ƒê√£ l∆∞u th√†nh c√¥ng!");
  };

  return (
    <div>
      <h1>Event Handling Demo</h1>
      {/* Truy·ªÅn h√†m handleDelete xu·ªëng cho con d√πng */}
      <CustomButton label="X√≥a" onCustomClick={handleDelete} />
      
      {/* T√°i s·ª≠ d·ª•ng: Truy·ªÅn h√†m handleSave xu·ªëng */}
      <CustomButton label="L∆∞u" onCustomClick={handleSave} />
    </div>
  );
}
```

#### Mental Model: C∆° ch·∫ø "Chu√¥ng c·ª≠a" (Waiting vs Running)

H√†m `handleDelete` n√†y **kh√¥ng h·ªÅ ch·∫°y li√™n t·ª•c**. N√≥ ƒëang ·ªü tr·∫°ng th√°i **"Ch·ªù l·ªánh" (Waiting)**.

H√£y t∆∞·ªüng t∆∞·ª£ng `handleDelete` gi·ªëng nh∆∞ m·ªôt c√°i **Chu√¥ng c·ª≠a**:

1.  **D√≤ng code `const handleDelete = ...`**: Gi·ªëng nh∆∞ vi·ªác b·∫°n l·∫Øp c√°i chu√¥ng l√™n t∆∞·ªùng. B·∫°n ch·ªâ l·∫Øp n√≥ ·ªü ƒë√≥ th√¥i, l√∫c n√†y n√≥ **im l·∫∑ng**.
2.  **D√≤ng code `<CustomButton ... />`**: Gi·ªëng nh∆∞ vi·ªác b·∫°n d√°n t·ªù gi·∫•y "H√£y b·∫•m v√†o ƒë√¢y" l√™n c√°i chu√¥ng.
3.  **H√†nh ƒë·ªông Click**: Ch·ªâ khi ng√≥n tay ng∆∞·ªùi d√πng **ch·∫°m v√†o n√∫t**, c√°i chu√¥ng m·ªõi k√™u (h√†m `alert` m·ªõi ch·∫°y).

**Quy tr√¨nh th·ª±c t·∫ø di·ªÖn ra nh∆∞ sau:**

1.  **Kh·ªüi t·∫°o (Definition):** Khi `App` (Component cha) hi·ªán l√™n m√†n h√¨nh, n√≥ t·∫°o ra h√†m `handleDelete` v√† gi·ªØ n√≥ trong b·ªô nh·ªõ. L√∫c n√†y h√†m **ch∆∞a ch·∫°y**.
2.  **Truy·ªÅn ƒëi (Passing Props):** N√≥ ƒë∆∞a h√†m n√†y cho `CustomButton` (Component con) th√¥ng qua prop `onCustomClick`.
3.  **G·∫Øn s·ª± ki·ªán (Wiring):** `CustomButton` g·∫Øn h√†m n√†y v√†o s·ª± ki·ªán `onClick` c·ªßa th·∫ª `<button>`.
4.  **K√≠ch ho·∫°t (Trigger):** Ng∆∞·ªùi d√πng b·∫•m chu·ªôt -> Tr√¨nh duy·ªát b√°o "C√≥ click r·ªìi!" -> H√†m `handleDelete` m·ªõi ƒë∆∞·ª£c g·ªçi -> **Alert hi·ªán ra**.

#### Khi n√†o th√¨ m·ªôt h√†m ch·∫°y li√™n t·ª•c? (L·ªói th∆∞·ªùng g·∫∑p)

H√†m ch·ªâ ch·∫°y li√™n t·ª•c (ho·∫∑c t·ª± ƒë·ªông ch·∫°y ngay l·∫≠p t·ª©c) n·∫øu b·∫°n m·∫Øc l·ªói vi·∫øt sai nh∆∞ sau:

**‚ùå Sai (Ch·∫°y ngay khi m·ªü web):**

```jsx
// N·∫øu b·∫°n vi·∫øt th√™m d·∫•u () ·ªü cu·ªëi
<button onClick={handleDelete()} /> 
// handleDelete() -> D·∫•u () c√≥ nghƒ©a l√† "Ch·∫°y ngay ƒëi!"
// K·∫øt qu·∫£: Alert hi·ªán l√™n ngay khi trang web v·ª´a t·∫£i xong, kh√¥ng c·∫ßn b·∫•m.
```

---

##### G√≥c chuy√™n gia: 3 Tr·∫°ng th√°i c·ªßa h√†m (Function)

D∆∞·ªõi ƒë√¢y l√† b·∫£ng t·ªïng k·∫øt to√†n di·ªán v·ªÅ 3 tr·∫°ng th√°i c·ªßa h√†m (Function) trong React/JavaScript. ƒê√¢y l√† ki·∫øn th·ª©c c·ªët l√µi ƒë·ªÉ b·∫°n l√†m ch·ªß vi·ªác x·ª≠ l√Ω s·ª± ki·ªán.

Gi·∫£ s·ª≠ ch√∫ng ta c√≥ m·ªôt h√†m g·ªëc:

```javascript
function nauAn(monAn) {
  console.log("ƒêang n·∫•u m√≥n: " + monAn);
}
```

##### 1. EXECUTION (Th·ª±c thi ngay)

* **C√∫ ph√°p:** `nauAn('Ph·ªü')` (C√≥ d·∫•u ngo·∫∑c `()`).
* **√ù nghƒ©a:** **"CH·∫†Y NGAY ƒêI!"**
* **C∆° ch·∫ø:**
    * Tr√¨nh duy·ªát th·∫•y d√≤ng n√†y -> G·ªçi h√†m ch·∫°y ngay l·∫≠p t·ª©c.
    * Sau khi ch·∫°y xong, n√≥ l·∫•y **k·∫øt qu·∫£ tr·∫£ v·ªÅ** (return value) ƒë·ªÉ g√°n v√†o bi·∫øn. N·∫øu h√†m kh√¥ng return g√¨, k·∫øt qu·∫£ l√† `undefined`.


* **Trong `onClick`:** ƒê√¢y th∆∞·ªùng l√† **L·ªñI SAI**.
    * `onClick={nauAn()}` -> N·∫•u ngay khi m·ªü web -> G√°n `undefined` v√†o n√∫t b·∫•m -> B·∫•m n√∫t kh√¥ng t√°c d·ª•ng.



##### 2. DEFINITION (ƒê·ªãnh nghƒ©a / Khai b√°o m·ªõi)

* **C√∫ ph√°p:** `() => nauAn('Ph·ªü')` (H√†m m≈©i t√™n).
* **√ù nghƒ©a:** **"T·∫†O QUY TR√åNH M·ªöI"**.
* **C∆° ch·∫ø:**
    * B·∫°n ƒëang t·∫°o ra m·ªôt c√°i h·ªôp (h√†m ·∫©n danh) b·ªçc l·∫•y l·ªánh g·ªçi b√™n trong.
    * Tr√¨nh duy·ªát th·∫•y d√≤ng n√†y -> N√≥ ch·ªâ t·∫°o c√°i h·ªôp v√† ƒë·ªÉ ƒë√≥, **ch∆∞a ch·∫°y** ru·ªôt b√™n trong.
    * Ch·ªâ khi n√†o `onClick` ƒë∆∞·ª£c k√≠ch ho·∫°t, n√≥ m·ªõi m·ªü h·ªôp ra v√† ch·∫°y l·ªánh.


* **Trong `onClick`:** D√πng khi c·∫ßn **TRUY·ªÄN THAM S·ªê**.

##### 3. REFERENCE (Tham chi·∫øu / Tr·ªè t·ªõi)

* **C√∫ ph√°p:** `nauAn` (Kh√¥ng c√≥ d·∫•u ngo·∫∑c).
* **√ù nghƒ©a:** **"ƒê∆ØA ƒê·ªäA CH·ªà"**.
* **C∆° ch·∫ø:**
    * B·∫°n kh√¥ng g·ªçi h√†m, c≈©ng kh√¥ng t·∫°o h√†m m·ªõi. B·∫°n ch·ªâ ch·ªâ tay v√†o c√°i h√†m ƒë√£ c√≥ s·∫µn trong b·ªô nh·ªõ.
    * B·∫°n b·∫£o React: "ƒê√¢y l√† ƒë·ªãa ch·ªâ c·ªßa th·ª£ n·∫•u ƒÉn. Khi n√†o c·∫ßn th√¨ g·ªçi n√≥".


* **Trong `onClick`:** C√°ch **T·ªêI ∆ØU NH·∫§T** (n·∫øu kh√¥ng c·∫ßn truy·ªÅn tham s·ªë).

---

##### B·∫£ng so s√°nh t√≥m t·∫Øt

| ƒê·∫∑c ƒëi·ªÉm | **EXECUTION** (Th·ª±c thi) | **DEFINITION** (ƒê·ªãnh nghƒ©a) | **REFERENCE** (Tham chi·∫øu) |
| --- | --- | --- | --- |
| **C√∫ ph√°p** | `handleDelete()` | `() => handleDelete()` | `handleDelete` |
| **H√¨nh ·∫£nh** | Ch√¢m ng√≤i ph√°o n·ªï ngay. | G√≥i ph√°o v√†o h·ªôp qu√†. | ƒê∆∞a t·∫•m b·∫£n ƒë·ªì kho b√°u. |
| **Khi n√†o ch·∫°y?** | **NGAY L·∫¨P T·ª®C** (khi Render). | **KHI CLICK** (S·ª± ki·ªán x·∫£y ra). | **KHI CLICK** (S·ª± ki·ªán x·∫£y ra). |
| **Hi·ªáu nƒÉng** | (Kh√¥ng b√†n v√¨ logic sai). | T·ªën ch√∫t b·ªô nh·ªõ (T·∫°o h√†m m·ªõi m·ªói l·∫ßn render). | **T·ªët nh·∫•t** (D√πng l·∫°i h√†m c≈©). |
| **Truy·ªÅn tham s·ªë** | C√≥ (Nh∆∞ng b·ªã l·ªói ch·∫°y ngay). | **ƒê∆Ø·ª¢C** (C√°ch duy nh·∫•t ƒë·ªÉ truy·ªÅn tham s·ªë an to√†n). | Kh√¥ng (Ch·ªâ nh·∫≠n tham s·ªë m·∫∑c ƒë·ªãnh `event`). |
| **K·∫øt lu·∫≠n** | ‚ùå **SAI** (Tr·ª´ tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát). | ‚úÖ **D√ôNG** khi c·∫ßn tham s·ªë (ID, index...). | ‚úÖ **D√ôNG** cho c√°c n√∫t b·∫•m ƒë∆°n gi·∫£n. |

---

##### V√≠ d·ª• Code th·ª±c t·∫ø

H√£y xem s·ª± kh√°c bi·ªát trong m·ªôt Component:

```javascript
function Menu() {
  
  // H√†m x·ª≠ l√Ω chung
  const order = (food) => {
    alert("B·∫°n ƒë√£ g·ªçi m√≥n: " + food);
  }

  // H√†m ƒë∆°n gi·∫£n kh√¥ng tham s·ªë
  const goHome = () => {
    alert("ƒêi v·ªÅ!");
  }

  return (
    <div>
      {/* TR∆Ø·ªúNG H·ª¢P 1: REFERENCE (Chu·∫©n, g·ªçn g√†ng) */}
      {/* D√πng khi h√†m kh√¥ng c·∫ßn tham s·ªë ri√™ng t·ª´ m√¨nh */}
      <button onClick={goHome}>
        V·ªÅ nh√†
      </button>

      {/* TR∆Ø·ªúNG H·ª¢P 2: DEFINITION (Chu·∫©n, linh ho·∫°t) */}
      {/* D√πng khi B·∫ÆT BU·ªòC ph·∫£i truy·ªÅn tham s·ªë ("Ph·ªü") */}
      <button onClick={() => order("Ph·ªü")}>
        G·ªçi Ph·ªü
      </button>

      {/* TR∆Ø·ªúNG H·ª¢P 3: EXECUTION (L·ªñI !!!) */}
      {/* Alert "C∆°m T·∫•m" hi·ªán l√™n ngay khi F5 trang web */}
      {/* B·∫•m n√∫t n√†y s·∫Ω KH√îNG ch·∫°y g√¨ c·∫£ */}
      <button onClick={order("C∆°m T·∫•m")}>
        G·ªçi C∆°m (L·ªói)
      </button>
    </div>
  );
}
```

##### L·ªùi khuy√™n "b·ªè t√∫i":

1. Vi·∫øt `onClick={tenHam}` tr∆∞·ªõc.
2. N·∫øu th·∫•y b√°o l·ªói thi·∫øu tham s·ªë, ho·∫∑c c·∫ßn truy·ªÅn ID -> S·ª≠a th√†nh `onClick={() => tenHam(id)}`.
3. Tuy·ªát ƒë·ªëi tr√°nh `onClick={tenHam()}`.

**‚úÖ ƒê√∫ng (Ch·ªù click m·ªõi ch·∫°y):**

```jsx
// Kh√¥ng c√≥ d·∫•u ()
<button onClick={handleDelete} />
// handleDelete -> C√≥ nghƒ©a l√† "ƒê√¢y l√† c√°i h√†m, gi·ªØ h·ªô t√¥i, khi n√†o click th√¨ h√£y ch·∫°y n√≥".
```

V√¨ b·∫°n vi·∫øt ƒë√∫ng c√∫ ph√°p (truy·ªÅn t√™n h√†m, kh√¥ng g·ªçi h√†m), n√™n n√≥ **an to√†n** v√† ch·ªâ ch·∫°y khi b·∫°n mu·ªën.

### 4. Rendering Lists: Hi·ªÉn th·ªã m·∫£ng d·ªØ li·ªáu

#### 4.0. B·∫£n ch·∫•t c·ªët l√µi: Array vs Object

> "Array l√† Object v·ªõi t√™n ng·∫ßm ƒë·ªãnh (s·ªë th·ª© t·ª±), c√≤n Object l√† Array v·ªõi t√™n t√πy ch·ªânh."

##### 1. B·∫£n ch·∫•t c·ªët l√µi (Mental Model)

H√£y t∆∞·ªüng t∆∞·ª£ng b·ªô nh·ªõ m√°y t√≠nh l√† m·ªôt t·ªß ƒë·ª±ng ƒë·ªì kh·ªïng l·ªì.

| ƒê·∫∑c ƒëi·ªÉm | **Array (M·∫£ng) `[...]`** | **Object (ƒê·ªëi t∆∞·ª£ng) `{...}`** |
| --- | --- | --- |
| **H√¨nh ·∫£nh** | Gi·ªëng m·ªôt **ƒëo√†n t√†u** c√≥ ƒë√°nh s·ªë toa. | Gi·ªëng m·ªôt **ch√πm ch√¨a kh√≥a** c√≥ d√°n nh√£n. |
| **T√™n (Key)** | **Ng·∫ßm ƒë·ªãnh (Implicit):** M√°y t·ª± ƒë·∫∑t l√† `0, 1, 2, 3...` | **T√πy ch·ªânh (Custom):** B·∫°n t·ª± ƒë·∫∑t l√† `"name", "age", "email"...` |
| **Th·ª© t·ª±** | **Quan tr·ªçng:** Toa 1 lu√¥n ƒë·ª©ng sau toa 0. | **Kh√¥ng quan tr·ªçng:** Ch√¨a kh√≥a "nh√†" hay "xe" l·∫•y c√°i n√†o tr∆∞·ªõc c≈©ng ƒë∆∞·ª£c. |
| **M·ª•c ƒë√≠ch** | D√πng ƒë·ªÉ ch·ª©a **danh s√°ch** c√°c th·ª© gi·ªëng nhau. | D√πng ƒë·ªÉ m√¥ t·∫£ **chi ti·∫øt** v·ªÅ m·ªôt th·ª© c·ª• th·ªÉ. |

##### 2. Chi ti·∫øt v√† Minh h·ªça

###### A. Array (M·∫£ng) - `[...]`

L√† m·ªôt danh s√°ch c√≥ th·ª© t·ª±. B·∫°n truy xu·∫•t d·ªØ li·ªáu b·∫±ng **V·ªã tr√≠** (Index).

* **C·∫•u tr√∫c th·ª±c t·∫ø:**
```javascript
const users = ["An", "B√¨nh", "Chi"];
```

* **C√°ch m√°y t√≠nh "nh√¨n" n√≥ (Under the hood):**
N√≥ th·ª±c ch·∫•t l√† m·ªôt Object v·ªõi key l√† s·ªë nguy√™n:
```javascript
{
  "0": "An",
  "1": "B√¨nh",
  "2": "Chi",
  "length": 3  // Array ƒë∆∞·ª£c "khuy·∫øn m√£i" th√™m thu·ªôc t√≠nh n√†y
}
```

* **Khi n√†o d√πng?** Khi b·∫°n c·∫ßn l∆∞u tr·ªØ m·ªôt t·∫≠p h·ª£p (list) ƒë·ªÉ sau n√†y l·∫∑p qua n√≥ (v√≠ d·ª•: d√πng `.map()` trong React ƒë·ªÉ hi·ªÉn th·ªã danh s√°ch).

###### B. Object (ƒê·ªëi t∆∞·ª£ng) - `{...}`

L√† m·ªôt t·∫≠p h·ª£p c√°c thu·ªôc t√≠nh. B·∫°n truy xu·∫•t d·ªØ li·ªáu b·∫±ng **T√™n nh√£n** (Key).

* **C·∫•u tr√∫c th·ª±c t·∫ø:**
```javascript
const user = {
  name: "An",
  age: 25,
  role: "Admin"
};
```

* **C√°ch truy xu·∫•t:**
B·∫°n kh√¥ng h·ªèi "cho t√¥i c√°i th·ª© nh·∫•t", m√† b·∫°n h·ªèi "cho t√¥i c√°i `name`".
```javascript
console.log(user.name); // "An"
```

* **Khi n√†o d√πng?** Khi b·∫°n c·∫ßn l∆∞u tr·ªØ th√¥ng tin chi ti·∫øt c·ªßa m·ªôt th·ª±c th·ªÉ duy nh·∫•t (v√≠ d·ª•: th√¥ng tin c·ªßa 1 user, th√¥ng tin c·ªßa 1 setting).

##### 3. S·ª± k·∫øt h·ª£p ho√†n h·∫£o (Array of Objects)

Trong th·ª±c t·∫ø l·∫≠p tr√¨nh (ƒë·∫∑c bi·ªát l√† React), ch√∫ng ta hi·∫øm khi d√πng r·ªùi r·∫°c. Ch√∫ng ta th∆∞·ªùng d√πng **M·∫£ng ch·ª©a c√°c ƒê·ªëi t∆∞·ª£ng**.

ƒê√¢y l√† c·∫•u tr√∫c d·ªØ li·ªáu ph·ªï bi·∫øn nh·∫•t (v√≠ d·ª• d·ªØ li·ªáu JSON t·ª´ API tr·∫£ v·ªÅ):

```javascript
const userList = [
  // Ph·∫ßn t·ª≠ 0 (Index 0)
  {
    id: "user_01",   // Custom Key
    name: "An"       // Custom Key
  },
  
  // Ph·∫ßn t·ª≠ 1 (Index 1)
  {
    id: "user_02",
    name: "B√¨nh"
  }
];
```

**T·∫°i sao c·∫•u tr√∫c n√†y l·∫°i m·∫°nh m·∫Ω?**

1. **V·ªè ngo√†i l√† Array:** Gi√∫p b·∫°n d√πng `.map()` ƒë·ªÉ l·∫∑p qua danh s√°ch v√† t·∫°o ra c√°c th·∫ª `<li>` ho·∫∑c `<div>` (nh∆∞ trong ·∫£nh b·∫°n g·ª≠i).
2. **Ru·ªôt b√™n trong l√† Object:** Gi√∫p b·∫°n truy c·∫≠p chi ti·∫øt (`user.name`, `user.id`) ƒë·ªÉ hi·ªÉn th·ªã n·ªôi dung phong ph√∫.
3. **V·∫•n ƒë·ªÅ Reconciliation (React):**
    * React d√πng **V·ªè ngo√†i (Array Index)** ƒë·ªÉ ƒë·∫øm s·ªë l∆∞·ª£ng.
    * Nh∆∞ng React c·∫ßn **Ru·ªôt b√™n trong (Unique ID)** l√†m `key` ƒë·ªÉ ƒë·ªãnh danh ch√≠nh x√°c t·ª´ng ph·∫ßn t·ª≠ khi danh s√°ch thay ƒë·ªïi (nh∆∞ t√¥i ƒë√£ gi·∫£i th√≠ch ·ªü ph·∫ßn tr∆∞·ªõc).


##### T√≥m l·∫°i

* N·∫øu d·ªØ li·ªáu l√† c√¢u tr·∫£ l·ªùi cho c√¢u h·ªèi **"C√°i n√†o?"** (Th·ª© nh·∫•t, th·ª© hai...) -> D√πng **Array**.
* N·∫øu d·ªØ li·ªáu l√† c√¢u tr·∫£ l·ªùi cho c√¢u h·ªèi **"C√°i g√¨?"** (T√™n l√† g√¨, Tu·ªïi l√† bao nhi√™u...) -> D√πng **Object**.

---

Khi `props.children` l√† m·ªôt m·∫£ng c√°c Element, React c·∫ßn m·ªôt c√°ch ƒë·ªÉ ph√¢n bi·ªát ch√∫ng.

#### 4.1. S·ª≠ d·ª•ng `.map()`

Ch√∫ng ta d√πng h√†m `.map()` c·ªßa Javascript ƒë·ªÉ bi·∫øn ƒë·ªïi m·∫£ng d·ªØ li·ªáu th√†nh m·∫£ng Element.

```javascript
const users = ['An', 'B√¨nh', 'Chi'];

// Bi·∫øn ƒë·ªïi: ['An', 'B√¨nh'] -> [<li>An</li>, <li>B√¨nh</li>]
const listItems = users.map(user => <li>{user}</li>);
```

#### 4.2. T·∫°i sao c·∫ßn `key`?

React y√™u c·∫ßu m·ªói ph·∫ßn t·ª≠ trong danh s√°ch ph·∫£i c√≥ props `key` duy nh·∫•t.

```jsx
// ‚úÖ ƒê√∫ng
users.map(user => <li key={user.id}>{user.name}</li>)
```

**T·∫°i sao? (Li√™n quan ƒë·∫øn Reconciliation)** H√£y t∆∞·ªüng t∆∞·ª£ng danh s√°ch: `[A, B, C]`. B·∫°n ch√®n `X` v√†o ƒë·∫ßu: `[X, A, B, C]`.

- **N·∫øu kh√¥ng c√≥ key:** React so s√°nh theo th·ª© t·ª± index.
    
    - V·ªã tr√≠ 0: C≈© l√† A, M·ªõi l√† X -> React x√≥a A, v·∫Ω l·∫°i X (T·ªën k√©m).
        
    - V·ªã tr√≠ 1: C≈© l√† B, M·ªõi l√† A -> React x√≥a B, v·∫Ω l·∫°i A (T·ªën k√©m).
        
    - ... React ph·∫£i s·ª≠a l·∫°i to√†n b·ªô danh s√°ch.
        
- **N·∫øu c√≥ key (V√≠ d·ª• key="A", key="B"):**
    
    - React nh√¨n th·∫•y key="A" v·∫´n c√≤n ƒë√≥, ch·ªâ b·ªã ƒë·∫©y xu·ªëng d∆∞·ªõi.
        
    - React gi·ªØ nguy√™n A, B, C v√† ch·ªâ ch√®n th√™m X v√†o ƒë·∫ßu.
        
    - **Hi·ªáu nƒÉng tƒÉng g·∫•p b·ªôi.**
        

### 5. V√≠ d·ª• t·ªïng h·ª£p (Complex Example)

#### 5.0. B√†i to√°n v√† Code m·∫´u

K·∫øt h·ª£p t·∫•t c·∫£ ki·∫øn th·ª©c: Array of Objects + Props + Event Handling + State.

**B√†i to√°n:** Qu·∫£n l√Ω danh s√°ch s·∫£n ph·∫©m.
1. Hi·ªÉn th·ªã danh s√°ch t·ª´ m·∫£ng object.
2. M·ªói s·∫£n ph·∫©m l√† m·ªôt Component ri√™ng (`ProductItem`).
3. C√≥ n√∫t "X√≥a" ·ªü m·ªói s·∫£n ph·∫©m (Child g·ªçi Parent).

```jsx
// --------------------------------------------------------
// 1. Component Con (ProductItem)
// Nhi·ªám v·ª•: Ch·ªâ lo vi·ªác hi·ªÉn th·ªã UI cho 1 s·∫£n ph·∫©m duy nh·∫•t.
// Kh√¥ng c·∫ßn bi·∫øt danh s√°ch ƒë·∫øn t·ª´ ƒë√¢u, hay x√≥a nh∆∞ th·∫ø n√†o.
// --------------------------------------------------------
const ProductItem = ({ product, onDelete }) => {
  return (
    <div style={{ border: "1px solid #ddd", padding: "10px", margin: "10px 0" }}>
      {/* Hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt t·ª´ Object */}
      <h3>{product.name}</h3>
      <p>Gi√°: ${product.price}</p>
      
      {/* 
        QUAN TR·ªåNG: K·ªπ thu·∫≠t "Truy·ªÅn tham s·ªë an to√†n"
        - N·∫øu vi·∫øt: onClick={onDelete(product.id)} -> SAI (Ch·∫°y ngay l·∫≠p t·ª©c khi render).
        - Ph·∫£i vi·∫øt: onClick={() => onDelete(product.id)} -> ƒê√öNG (T·∫°o h√†m bao, ch·ªù click m·ªõi ch·∫°y).
      */}
      <button onClick={() => onDelete(product.id)} style={{ color: "red" }}>
        X√≥a s·∫£n ph·∫©m
      </button>
    </div>
  );
};

// --------------------------------------------------------
// 2. Component Cha (ProductList)
// Nhi·ªám v·ª•: N·∫Øm gi·ªØ d·ªØ li·ªáu (State) v√† Logic nghi·ªáp v·ª• (X√≥a).
// L√† "ƒë·∫ßu n√£o" ƒëi·ªÅu khi·ªÉn m·ªçi th·ª©.
// --------------------------------------------------------
function ProductList() {
  // KH·ªûI T·∫†O STATE:
  // D√πng M·∫£ng ch·ª©a c√°c Object ƒë·ªÉ m√¥ t·∫£ danh s√°ch.
  // M·ªói Object c·∫ßn m·ªôt ID duy nh·∫•t ƒë·ªÉ l√†m Key.
  const [products, setProducts] = useState([
    { id: 1, name: "Laptop Dell", price: 1000 },
    { id: 2, name: "Iphone 15", price: 900 },
    { id: 3, name: "Mouse Logitech", price: 50 },
  ]);

  // LOGIC X√ìA (Delete Handler):
  // T·∫°i sao kh√¥ng d√πng products.splice()? -> V√¨ React c·∫ßn t√≠nh B·∫§T BI·∫æN (Immutability).
  // Ta ph·∫£i t·∫°o ra m·ªôt m·∫£ng M·ªöI ho√†n to√†n, b·ªè ƒëi ph·∫ßn t·ª≠ c·∫ßn x√≥a.
  const handleDelete = (idToDelete) => {
    // .filter() t·∫°o ra m·∫£ng m·ªõi, ch·ªâ gi·ªØ l·∫°i nh·ªØng ai c√≥ ID KH√ÅC v·ªõi idToDelete
    const newProducts = products.filter(item1 => item1.id !== idToDelete);
    // C·∫•u tr√∫c h√†m filter x·ª≠ l√Ω array-> const newArray = oldArray.filter(item => dieu_kien);
    // üí° L∆∞u √Ω: item1 (·ªü ƒë√¢y) v√† item (·ªü .map() b√™n d∆∞·ªõi) l√† 2 bi·∫øn ƒë·ªôc l·∫≠p.
    //    T√™n kh√°c nhau ƒë·ªÉ nh·∫•n m·∫°nh: ch√∫ng ch·ªâ t·ªìn t·∫°i trong ph·∫°m vi arrow function c·ªßa m√¨nh.

    // C·∫≠p nh·∫≠t State v·ªõi m·∫£ng m·ªõi -> K√≠ch ho·∫°t Re-render
    setProducts(newProducts);
  };

  return (
    <div style={{ padding: "20px" }}>
      <h2>Danh s√°ch h√†ng h√≥a ({products.length})</h2>
      
      {/* RENDERING LISTS: */}
      {/* D√πng .map() ƒë·ªÉ bi·∫øn ƒë·ªïi m·∫£ng Data th√†nh m·∫£ng Component */}
      {products.map((item) => (
        <ProductItem 
          key={item.id}           // B·∫ÆT BU·ªòC: Gi√∫p React ƒë·ªãnh danh (D√πng ID, ƒë·ª´ng d√πng index)
          product={item}          // TRUY·ªÄN DATA: G·ª≠i object xu·ªëng cho con hi·ªÉn th·ªã
          onDelete={handleDelete} // TRUY·ªÄN LOGIC: G·ª≠i c√°i "ƒëi·ªÅu khi·ªÉn" xu·ªëng cho con d√πng
        />
      ))}
      
      {/* CONDITIONAL RENDERING: Ch·ªâ hi·ªán khi danh s√°ch r·ªóng */}
      {products.length === 0 && <p style={{color: 'gray'}}>H·∫øt h√†ng r·ªìi!</p>}
    </div>
  );
}
```
#### 5.1. Ph√¢n t√≠ch chi ti·∫øt v√≠ d·ª• (Deep Dive)

D∆∞·ªõi ƒë√¢y l√† s∆° ƒë·ªì lu·ªìng d·ªØ li·ªáu minh h·ªça cho qu√° tr√¨nh t∆∞∆°ng t√°c gi·ªØa cha v√† con:

```mermaid
sequenceDiagram
    participant User
    participant Child as ProductItem (Con)
    participant Parent as ProductList (Cha)
    
    Note over Parent: 1. Data Flow (Xu·ªëng)
    Parent->>Child: Render Props (product, onDelete)
    
    Note over User: 2. Event Flow (L√™n)
    User->>Child: Click "Delete" Button
    Child->>Parent: Call onDelete(id)
    
    Note over Parent: 3. State Update
    Parent->>Parent: handleDelete() runs
    Parent->>Parent: Create NEW Array (Immutability)
    Parent->>Parent: setProducts(newArray)
    
    Note over Parent, Child: 4. Re-render
    Parent->>Child: Re-render UI with updated list
```

#### 5.2. Lu·ªìng d·ªØ li·ªáu m·ªôt chi·ªÅu (One-way Data Flow)

**CH√çNH X√ÅC TUY·ªÜT ƒê·ªêI! üíØ**

H√£y ph√¢n t√≠ch c·ª• th·ªÉ **c√°ch Cha truy·ªÅn Con** v√† **Con truy·ªÅn Cha** trong v√≠ d·ª• `ProductList` ·ªü tr√™n. ƒê√¢y ch√≠nh l√† quy t·∫Øc **Lu·ªìng d·ªØ li·ªáu m·ªôt chi·ªÅu (One-way Data Flow)** - tri·∫øt l√Ω c·ªët l√µi c·ªßa React:

##### V·∫ø 1: "Cha truy·ªÅn con T√™n H√†m, Con truy·ªÅn Cha l·∫°i Gi√° tr·ªã"

‚úÖ **Ph√¢n t√≠ch trong code:**

**B∆∞·ªõc 1: Cha (ProductList) ƒë·ªãnh nghƒ©a h√†m x·ª≠ l√Ω**
```jsx
const handleDelete = (idToDelete) => {
  const newProducts = products.filter(item1 => item1.id !== idToDelete);
  setProducts(newProducts);
};
```
üëÜ Cha t·∫°o ra c√°i "Loa" (h√†m `handleDelete`). Cha n·∫Øm gi·ªØ to√†n quy·ªÅn quy·∫øt ƒë·ªãnh logic x√≥a.

> **üí° L∆∞u √Ω:** Bi·∫øn `item1` ·ªü ƒë√¢y l√† ho√†n to√†n ƒë·ªôc l·∫≠p v·ªõi bi·∫øn `item` trong `.map()` b√™n d∆∞·ªõi. T√™n kh√°c nhau ƒë·ªÉ nh·∫•n m·∫°nh r·∫±ng m·ªói bi·∫øn ch·ªâ t·ªìn t·∫°i trong ph·∫°m vi arrow function c·ªßa n√≥.

**B∆∞·ªõc 2: Cha ƒë∆∞a "Loa" cho Con**
```jsx
<ProductItem 
  product={item}
  onDelete={handleDelete}  // ‚Üê ƒê∆∞a T√äN H√ÄM (kh√¥ng g·ªçi, kh√¥ng c√≥ d·∫•u ())
/>
```
üëÜ Cha ch·ªâ ƒë∆∞a ƒë·ªãa ch·ªâ/t√™n h√†m cho Con. L√∫c n√†y h√†m **ch∆∞a ch·∫°y**.

**B∆∞·ªõc 3: Con (ProductItem) nh·∫≠n "Loa" v√† h√©t v√†o ƒë√≥ khi c·∫ßn**
```jsx
const ProductItem = ({ product, onDelete }) => {
  return (
    <button onClick={() => onDelete(product.id)}>  {/* ‚Üê Con G·ªåI h√†m + G·ª¨I GI√Å TR·ªä */}
      X√≥a s·∫£n ph·∫©m
    </button>
  );
};
```
üëÜ Khi user click n√∫t, Con g·ªçi `onDelete(1)` (v√≠ d·ª• ID = 1). **Con truy·ªÅn gi√° tr·ªã ng∆∞·ª£c l√™n Cha**.

**B∆∞·ªõc 4: Cha nh·∫≠n gi√° tr·ªã v√† t·ª± x·ª≠ l√Ω**
```jsx
handleDelete(1) // ‚Üê H√†m c·ªßa Cha ch·∫°y, nh·∫≠n ƒë∆∞·ª£c ID = 1
// Cha t·ª± x√≥a s·∫£n ph·∫©m c√≥ ID = 1 kh·ªèi State
```

> **C∆° ch·∫ø:** Cha ƒë∆∞a c√°i "Loa" (H√†m). Con h√©t v√†o c√°i "Loa" ƒë√≥ (G·ªçi h√†m + k√®m gi√° tr·ªã). Cha nghe th·∫•y v√† t·ª± s·ª≠a ƒë·ªïi State c·ªßa Cha.

---

##### V·∫ø 2: "Cha truy·ªÅn Con Gi√° tr·ªã, Con ch·ªâ Hi·ªÉn th·ªã, kh√¥ng Truy·ªÅn l·∫°i"

‚úÖ **Ph√¢n t√≠ch trong code:**

**B∆∞·ªõc 1: Cha truy·ªÅn d·ªØ li·ªáu xu·ªëng**
```jsx
<ProductItem 
  product={item}  // ‚Üê item = { id: 1, name: "Laptop Dell", price: 1000 }
/>
```
üëÜ Cha g·ª≠i object xu·ªëng cho Con qua props `product`.

**B∆∞·ªõc 2: Con ch·ªâ ƒë∆∞·ª£c ƒë·ªçc v√† hi·ªÉn th·ªã**
```jsx
const ProductItem = ({ product }) => {
  return (
    <div>
      <h3>{product.name}</h3>      {/* ‚Üê CH·ªà ƒê·ªåC v√† hi·ªÉn th·ªã */}
      <p>Gi√°: ${product.price}</p> {/* ‚Üê CH·ªà ƒê·ªåC v√† hi·ªÉn th·ªã */}
    </div>
  );
};
```
üëÜ Con **kh√¥ng th·ªÉ** l√†m th·∫ø n√†y:
```jsx
// ‚ùå SAI - C·ªë g·∫Øng s·ª≠a props (React s·∫Ω b√°o l·ªói)
product.price = 900;
```

**T·∫°i sao Con kh√¥ng s·ª≠a ƒë∆∞·ª£c?**
* Props l√† **Read-Only (Ch·ªâ ƒë·ªçc)**.
* N·∫øu Con mu·ªën "ƒë·ªÅ ngh·ªã" Cha thay ƒë·ªïi gi√°, Con ph·∫£i g·ªçi m·ªôt **callback function** m√† Cha ƒë√£ ƒë∆∞a (gi·ªëng nh∆∞ `onDelete` ·ªü tr√™n).
* V√≠ d·ª•: `onClick={() => onIncreasePrice(product.id, 10)}` ‚Üí Cha m·ªõi l√† ng∆∞·ªùi quy·∫øt ƒë·ªãnh c√≥ tƒÉng gi√° hay kh√¥ng.

> **C∆° ch·∫ø:** D·ªØ li·ªáu ch·∫£y nh∆∞ d√≤ng th√°c t·ª´ tr√™n xu·ªëng d∆∞·ªõi. Con nh·∫≠n ƒë∆∞·ª£c props, Con **kh√¥ng th·ªÉ** s·ª≠a props ƒë·ªÉ n√≥ t·ª± ch·∫°y ng∆∞·ª£c l√™n Cha.

---

##### H√¨nh ·∫£nh t·ªïng k·∫øt: Chi·∫øc Tivi v√† ƒê√†i truy·ªÅn h√¨nh

H√£y √°nh x·∫° l·∫°i v√≠ d·ª• `ProductList` v√†o m√¥ h√¨nh Tivi:

* **Cha (ProductList):** L√† **ƒê√†i truy·ªÅn h√¨nh VTV**.
* **Con (ProductItem):** L√† chi·∫øc **Tivi** nh√† b·∫°n.

**1. Cha truy·ªÅn gi√° tr·ªã `product` (Props) ‚Üí Con:**
* ƒê√†i ph√°t s√≥ng d·ªØ li·ªáu `{ name: "Laptop Dell", price: 1000 }`.
* Tivi nh√† b·∫°n **ch·ªâ c√≥ th·ªÉ hi·ªÉn th·ªã** d·ªØ li·ªáu ƒë√≥: "Laptop Dell - $1000".
* B·∫°n **kh√¥ng th·ªÉ** th√≤ tay v√†o m√†n h√¨nh Tivi s·ª≠a gi√° t·ª´ `$1000` th√†nh `$900` ƒë·ªÉ s·ªë li·ªáu tr√™n ƒë√†i thay ƒë·ªïi theo. (Kh√¥ng truy·ªÅn l·∫°i ƒë∆∞·ª£c).

**2. Cha truy·ªÅn h√†m `onDelete` (Callback) ‚Üí Con:**
* ƒê√†i truy·ªÅn h√¨nh cung c·∫•p m·ªôt s·ªë hotline: **"G·ªçi 1900-XXX ƒë·ªÉ b√¨nh ch·ªçn x√≥a s·∫£n ph·∫©m"**.
* B·∫°n (Con) b·∫•m n√∫t "X√≥a", gi·ªëng nh∆∞ g·ªçi hotline v√† n√≥i: **"T√¥i mu·ªën x√≥a s·∫£n ph·∫©m ID = 1!"** (Truy·ªÅn gi√° tr·ªã ng∆∞·ª£c l√™n).
* L√∫c n√†y, ƒê√†i truy·ªÅn h√¨nh (Cha) nh·∫≠n th√¥ng tin v√† t·ª± x√≥a s·∫£n ph·∫©m ƒë√≥ kh·ªèi danh s√°ch g·ªëc, sau ƒë√≥ ph√°t s√≥ng l·∫°i danh s√°ch m·ªõi xu·ªëng Tivi.

---

B·∫°n ƒë√£ n·∫Øm r·∫•t ch·∫Øc ki·∫øn th·ª©c n·ªÅn t·∫£ng n√†y r·ªìi. ƒê√¢y l√† "c·ª≠a ·∫£i" kh√≥ nh·∫•t khi m·ªõi h·ªçc React m√† b·∫°n ƒë√£ v∆∞·ª£t qua.

---

#### 5.3. Props Destructuring: Hi·ªÉu s√¢u v·ªÅ Input

Trong v√≠ d·ª• n√†y, b·∫°n th·∫•y `ProductItem` nh·∫≠n 2 m√≥n ƒë·ªì: **1 object** (`product`) v√† **1 h√†m** (`onDelete`).

Trong React, `ProductItem` l√† m·ªôt h√†m (Component), v√† "nguy√™n li·ªáu ƒë·∫ßu v√†o" (Input) c·ªßa n√≥ ch√≠nh l√† 2 th·ª© ƒë√≥.

Tuy nhi√™n, ƒë·ªÉ hi·ªÉu s√¢u h∆°n v·ªÅ m·∫∑t k·ªπ thu·∫≠t (c√°ch m√°y t√≠nh hi·ªÉu), m√¨nh xin b·ªï sung v·ªÅ c∆° ch·∫ø "g√≥i h√†ng" d∆∞·ªõi ƒë√¢y:

##### 1. G√≥c nh√¨n th·ª±c t·∫ø (B·∫°n nh√¨n th·∫•y)

ƒê√∫ng nh∆∞ b·∫°n n√≥i, b·∫°n th·∫•y h√†m n√†y nh·∫≠n 2 m√≥n ri√™ng bi·ªát:

1. **`product`**: L√† m·ªôt **Object** (ch·ª©a th√¥ng tin nh∆∞ t√™n, gi√°, id...).
2. **`onDelete`**: L√† m·ªôt **H√†m/Function** (c√¥ng c·ª• ƒë·ªÉ b·∫•m n√∫t x√≥a).

##### 2. G√≥c nh√¨n k·ªπ thu·∫≠t (React ho·∫°t ƒë·ªông)

Th·ª±c t·∫ø, React **kh√¥ng** g·ª≠i 2 m√≥n r·ªùi r·∫°c. React ƒë√≥ng g√≥i t·∫•t c·∫£ m·ªçi th·ª© v√†o **M·ªòT Object duy nh·∫•t** g·ªçi l√† **`props`**.

ƒêo·∫°n code:

```jsx
const ProductItem = ({ product, onDelete }) => { ... }
```

Th·ª±c ch·∫•t l√† c√°ch vi·∫øt t·∫Øt c·ªßa:

```jsx
// C√°ch vi·∫øt t∆∞·ªùng minh (kh√¥ng vi·∫øt t·∫Øt)
const ProductItem = (props) => { 
    const product = props.product;   // L·∫•y object product ra
    const onDelete = props.onDelete; // L·∫•y h√†m onDelete ra
    ...
}
```

K·ªπ thu·∫≠t b·∫°n ƒëang d√πng g·ªçi l√† **Destructuring (B√≥c t√°ch)**. T·ª©c l√†:

> *"T√¥i bi·∫øt React g·ª≠i ƒë·∫øn m·ªôt c√°i th√πng h√†ng t√™n l√† `props`. Nh∆∞ng t√¥i kh√¥ng mu·ªën c·∫ßm c·∫£ th√πng. T√¥i mu·ªën m·ªü th√πng ra ngay t·∫°i c·ª≠a v√† ch·ªâ l·∫•y ƒë√∫ng 2 m√≥n t√™n l√† `product` v√† `onDelete` ƒë·ªÉ d√πng th√¥i."*

##### T√≥m t·∫Øt Input c·ªßa ProductItem

| T√™n Input | Ki·ªÉu d·ªØ li·ªáu (Type) | Nhi·ªám v·ª• |
| --- | --- | --- |
| **`product`** | **Object** `{ id, name, price }` | **D·ªØ li·ªáu ƒë·ªÉ hi·ªÉn th·ªã**. (Nguy√™n li·ªáu ƒë·ªÉ n·∫•u ƒÉn). |
| **`onDelete`** | **Function** `(id) => void` | **C√¥ng c·ª• ƒë·ªÉ t∆∞∆°ng t√°c**. (C√°i n√∫t b·∫•m g·ªçi v·ªÅ Component Cha). |

> [!NOTE]
> C·∫£ 2 m√≥n n√†y ƒë·ªÅu n·∫±m b√™n trong m·ªôt object `props` duy nh·∫•t. Vi·ªác vi·∫øt `({ product, onDelete })` ch·ªâ l√† c√∫ ph√°p destructuring ƒë·ªÉ code g·ªçn g√†ng h∆°n.

---

#### 5.4. Quy t·∫Øc ƒë·∫∑t t√™n tham s·ªë (Parameter Naming)

**T√™n c·ªßa Input c·ªßa h√†m ƒë·ªÅu l√† t√™n t·∫°m?**

C√¢u tr·∫£ l·ªùi l√†: **ƒê√öNG 95%**.

H·∫ßu h·∫øt c√°c tr∆∞·ªùng h·ª£p (nh∆∞ trong `map`, `filter`, hay h√†m th√¥ng th∆∞·ªùng), t√™n Input ho√†n to√†n l√† **T√™n T·∫°m** (Placeholder). B·∫°n th√≠ch ƒë·∫∑t t√™n g√¨ c≈©ng ƒë∆∞·ª£c, mi·ªÖn l√† d√πng nh·∫•t qu√°n b√™n trong h√†m.

Tuy nhi√™n, c√≥ **1 tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát** trong React m√† b·∫°n c·∫ßn l∆∞u √Ω (li√™n quan ƒë·∫øn c√°i ngo·∫∑c nh·ªçn `{}`).

H√£y c√πng ph√¢n t√≠ch 2 tr∆∞·ªùng h·ª£p n√†y:

---

##### 1. Tr∆∞·ªùng h·ª£p "T√™n T·∫°m" (T·ª± do 100%)

ƒê√¢y l√† tr∆∞·ªùng h·ª£p c·ªßa c√°c h√†m nh∆∞: `map`, `filter`, `handleDelete`, hay c√°c h√†m x·ª≠ l√Ω s·ª± ki·ªán `onClick`.

B·∫°n c√≥ th·ªÉ v√≠ n√≥ nh∆∞ **C√°i Ph·ªÖu**. C√°i ph·ªÖu kh√¥ng quan t√¢m b·∫°n ƒë·ªï n∆∞·ªõc, c√°t, hay g·∫°o v√†o. N√≥ ch·ªâ h·ª©ng th·ª© ƒë∆∞·ª£c ƒë·ªï v√†o th√¥i.

**V√≠ d·ª• v·ªõi `handleDelete`:**

```javascript
// C√°ch 1: T√™n chu·∫©n
const handleDelete = (idToDelete) => { ... }

// C√°ch 2: T√™n ti·∫øng Vi·ªát
const handleDelete = (maSoCanXoa) => { ... }

// C√°ch 3: T√™n ng·∫´u nhi√™n
const handleDelete = (cucGom) => { ... }
```

‚úÖ **T·∫•t c·∫£ ƒë·ªÅu ch·∫°y ƒë√∫ng.** V√¨ khi g·ªçi h√†m `handleDelete(1)`, s·ªë `1` s·∫Ω t·ª± ƒë·ªông nh·∫£y v√†o c√°i t√™n m√† b·∫°n ƒë√£ ƒë·∫∑t ·ªü v·ªã tr√≠ ƒë√≥.

**V√≠ d·ª• v·ªõi `filter`:**

```javascript
// B·∫°n vi·∫øt item1, item2, hay x, y, z ƒë·ªÅu ƒë∆∞·ª£c
products.filter(x => x.id !== ...) 
```

---

##### 2. Tr∆∞·ªùng h·ª£p "B·∫Øt bu·ªôc ƒë√∫ng t√™n" (L∆∞u √Ω ƒë·∫∑c bi·ªát)

ƒê√¢y l√† tr∆∞·ªùng h·ª£p c·ªßa **Component React** khi b·∫°n d√πng d·∫•u ngo·∫∑c nh·ªçn `{ }` ƒë·ªÉ nh·∫≠n Props (k·ªπ thu·∫≠t Destructuring).

V√≠ d·ª•: Component `ProductItem`.

**·ªû Component Cha (G·ª≠i ƒëi):**
Cha ƒë√≥ng g√≥i 1 th√πng h√†ng, d√°n nh√£n b√™n ngo√†i th√πng l√† `product` v√† `onDelete`.

```jsx
<ProductItem product={...} onDelete={...} />
```

**·ªû Component Con (Nh·∫≠n v·ªÅ):**

**C√°ch 1: Nh·∫≠n c·∫£ th√πng (T√™n t·∫°m OK)**
N·∫øu b·∫°n nh·∫≠n c·∫£ th√πng `props`, th√¨ ch·ªØ `props` l√† t√™n t·∫°m. B·∫°n ƒë·ªïi th√†nh `thungHang` c≈©ng ƒë∆∞·ª£c.

```jsx
const ProductItem = (thungHang) => { 
    // Ph·∫£i t·ª± b√≥c th√πng ra: thungHang.product
}
```

**C√°ch 2: B√≥c th√πng ngay t·∫°i c·ª≠a (Destructuring - Ph·∫£i ƒë√∫ng t√™n nh√£n)**
ƒê√¢y l√† c√°ch b·∫°n ƒëang d√πng. Khi b·∫°n vi·∫øt `{ product }`, b·∫°n ƒëang b·∫£o React: *"H√£y t√¨m trong th√πng h√†ng c√°i g√≥i tin c√≥ nh√£n l√† `product` cho t√¥i"*.

```jsx
// ‚úÖ ƒê√öNG: T√™n tr√πng v·ªõi nh√£n cha g·ª≠i
const ProductItem = ({ product }) => { ... }

// ‚ùå SAI: T√™n kh√°c nh√£n (React t√¨m kh√¥ng th·∫•y g√≥i "caiBanh" n√†o c·∫£ -> undefined)
const ProductItem = ({ caiBanh }) => { ... } 
```

##### T√≥m t·∫Øt quy t·∫Øc ƒë·∫∑t t√™n

| Lo·∫°i h√†m | V√≠ d·ª• | Quy t·∫Øc ƒë·∫∑t t√™n Input |
| --- | --- | --- |
| **H√†m th∆∞·ªùng** | `handleDelete(id)` | **T·ª∞ DO**. ƒê·∫∑t `id`, `x`, `a` ƒë·ªÅu ƒë∆∞·ª£c (d·ª±a v√†o **Th·ª© t·ª±**). |
| **Callback** | `.map(item => ...)` | **T·ª∞ DO**. ƒê·∫∑t `item`, `sp`, `e` ƒë·ªÅu ƒë∆∞·ª£c. |
| **Component (Props)** | `({ product })` | **B·∫ÆT BU·ªòC**. Ph·∫£i tr√πng t√™n v·ªõi key m√† Cha g·ª≠i xu·ªëng (d·ª±a v√†o **T√™n nh√£n**). |

> [!IMPORTANT]
> Khi d√πng destructuring `{ }` trong React component, t√™n bi·∫øn **ph·∫£i kh·ªõp ch√≠nh x√°c** v·ªõi t√™n prop m√† component cha truy·ªÅn xu·ªëng. ƒê√¢y l√† ƒëi·ªÉm kh√°c bi·ªát quan tr·ªçng so v·ªõi h√†m th√¥ng th∆∞·ªùng.

---

#### 5.5. Quy ∆∞·ªõc ƒë·∫∑t t√™n trong React (Naming Conventions)

D∆∞·ªõi ƒë√¢y l√† b·∫£ng t·ªïng h·ª£p "kim ch·ªâ nam" v·ªÅ quy t·∫Øc ƒë·∫∑t t√™n trong React. B·∫°n c√≥ th·ªÉ in ra ho·∫∑c l∆∞u l·∫°i ƒë·ªÉ d√πng cho m·ªçi d·ª± √°n sau n√†y.

Ch√∫ng ta s·ª≠ d·ª•ng 3 ki·ªÉu vi·∫øt ch√≠nh:

1. **PascalCase:** Vi·∫øt Hoa Ch·ªØ C√°i ƒê·∫ßu (V√≠ d·ª•: `ProductItem`)
2. **camelCase:** vi·∫øt th∆∞·ªùng ch·ªØ c√°i ƒë·∫ßu (V√≠ d·ª•: `handleDelete`)
3. **SCREAMING_CASE:** VI·∫æT_HOA_TO√ÄN_B·ªò (V√≠ d·ª•: `API_URL`)

---

##### 1. B·∫£ng Tra C·ª©u Nhanh

| Lo·∫°i th√†nh ph·∫ßn | Quy t·∫Øc vi·∫øt | C√¥ng th·ª©c ƒë·∫∑t t√™n | V√≠ d·ª• chu·∫©n |
| --- | --- | --- | --- |
| **Component** | **PascalCase** | T√™n danh t·ª´ | `ProductList`, `Header`, `UserProfile` |
| **H√†m ·ªü Cha (Logic)** | **camelCase** | `handle` + ƒê·ªông t·ª´ | `handleDelete`, `handleSubmit`, `handleChange` |
| **Props ·ªü Con (Event)** | **camelCase** | `on` + ƒê·ªông t·ª´ | `onDelete`, `onClick`, `onChange` |
| **H√†m Helper (N·ªôi b·ªô)** | **camelCase** | ƒê·ªông t·ª´ + Danh t·ª´ | `calculateTotal`, `formatDate`, `fetchData` |
| **Bi·∫øn (Data)** | **camelCase** | Danh t·ª´ | `user`, `products`, `itemList` |
| **Bi·∫øn Boolean** | **camelCase** | `is`/`has`/`should` + T√≠nh t·ª´ | `isLoading`, `hasError`, `isVisible` |
| **H·∫±ng s·ªë (C·ªë ƒë·ªãnh)** | **SCREAMING** | T√™n_C√°ch_Nhau_G·∫°ch_D∆∞·ªõi | `MAX_ITEMS`, `API_URL`, `VAT_TAX` |

---

##### 2. Gi·∫£i Th√≠ch Chi Ti·∫øt & L√Ω Do

###### A. Component (Cha & Con) ‚Üí PascalCase

* **Quy t·∫Øc:** Lu√¥n vi·∫øt hoa ch·ªØ c√°i ƒë·∫ßu.
* **L√Ω do:** ƒê·ªÉ React ph√¢n bi·ªát v·ªõi th·∫ª HTML (`<div>`, `<span>`).
* **V√≠ d·ª•:**
  * ‚úÖ `ProductItem`
  * ‚ùå `productItem` (Sai, React s·∫Ω t∆∞·ªüng l√† th·∫ª HTML l·ªói).

###### B. C·∫∑p ƒë√¥i "Handle - On" (Quan tr·ªçng nh·∫•t)

ƒê√¢y l√† quy t·∫Øc giao ti·∫øp gi·ªØa Cha v√† Con.

* **T·∫°i Component Cha (N∆°i ƒë·ªãnh nghƒ©a logic):** D√πng ti·ªÅn t·ªë **`handle`**.
  * N√≥ tr·∫£ l·ªùi c√¢u h·ªèi: *"T√¥i x·ª≠ l√Ω vi·ªác g√¨?"*
  * V√≠ d·ª•: `handleDelete` (T√¥i x·ª≠ l√Ω vi·ªác x√≥a).

* **T·∫°i Component Con (Props nh·∫≠n v·ªÅ):** D√πng ti·ªÅn t·ªë **`on`**.
  * N√≥ tr·∫£ l·ªùi c√¢u h·ªèi: *"S·ª± ki·ªán n√†o k√≠ch ho·∫°t t√¥i?"*
  * V√≠ d·ª•: `onDelete` (Khi n√∫t x√≥a ƒë∆∞·ª£c b·∫•m).

###### C. H√†m Helper (H√†m ph·ª• tr·ª£)

L√† nh·ªØng h√†m t√≠nh to√°n, format d·ªØ li·ªáu, g·ªçi API... n·∫±m b√™n trong ho·∫∑c b√™n ngo√†i component.

* **Quy t·∫Øc:** ƒê·ªông t·ª´ + Danh t·ª´ (L√†m c√°i g√¨ + Cho c√°i g√¨).
* **V√≠ d·ª•:**
  * `calculateTotal()` (T√≠nh t·ªïng)
  * `formatCurrency()` (ƒê·ªãnh d·∫°ng ti·ªÅn t·ªá)
  * `checkPermission()` (Ki·ªÉm tra quy·ªÅn)

###### D. Bi·∫øn & State

* **Bi·∫øn d·ªØ li·ªáu:** D√πng danh t·ª´. (`products`, `currentUser`).
* **Bi·∫øn Boolean (ƒê√∫ng/Sai):** Lu√¥n b·∫Øt ƒë·∫ßu b·∫±ng c√¢u h·ªèi `is`, `has`, `should`.
  * `isLoading` (ƒêang t·∫£i ph·∫£i kh√¥ng?) ‚Üí ƒê·ªçc code nh∆∞ ƒë·ªçc vƒÉn.
  * Tr√°nh ƒë·∫∑t t√™n c·ª•t l·ªßn nh∆∞: `loading` (Kh√¥ng r√µ l√† tr·∫°ng th√°i hay l√† h√†nh ƒë·ªông t·∫£i), `flag` (C·ªù g√¨?).

---

##### 3. V√≠ d·ª• Code T·ªïng H·ª£p (Chu·∫©n S√°ch Gi√°o Khoa)

```javascript
// 1. H·∫∞NG S·ªê (C·ªë ƒë·ªãnh to√†n c·ª•c) -> SCREAMING_SNAKE_CASE
const MAX_PRODUCT_COUNT = 10;

// 2. COMPONENT (B·∫Øt bu·ªôc) -> PascalCase
function ProductManager() {

  // 3. STATE (Bi·∫øn: Danh t·ª´, Setter: set + Danh t·ª´) -> camelCase
  const [products, setProducts] = useState([]);
  
  // 4. BOOLEAN (Tr·∫°ng th√°i) -> is/has...
  const [isLoading, setIsLoading] = useState(false);

  // 5. HELPER FUNCTION (H√†m b·ªï tr·ª£) -> Verb + Noun
  const calculateTax = (price) => {
    return price * 0.1;
  };

  // 6. HANDLER FUNCTION (Logic x·ª≠ l√Ω s·ª± ki·ªán) -> handle + Verb
  const handleDelete = (idToDelete) => {
    const newProducts = products.filter(p => p.id !== idToDelete);
    setProducts(newProducts);
  };

  return (
    <div>
      {/* 7. PROPS EVENT (Truy·ªÅn xu·ªëng con) -> on + Verb */}
      <ProductList 
         data={products} 
         onDelete={handleDelete} 
      />
    </div>
  );
}
```

> [!TIP]
> B·∫°n c·ª© √°p d·ª•ng ƒë√∫ng b·∫£ng n√†y, code c·ªßa b·∫°n s·∫Ω c·ª±c k·ª≥ chuy√™n nghi·ªáp, d·ªÖ ƒë·ªçc v√† d·ªÖ b·∫£o tr√¨ cho c·∫£ team!

---

#### 5.6. M√¥ h√¨nh "Data Down, Actions Up" - T·ªïng h·ª£p Quy chu·∫©n (The Complete Pattern)

Ph·∫ßn n√†y l√† b·∫£n t·ªïng h·ª£p (Reference Guide) v·ªÅ m√¥ h√¨nh giao ti·∫øp gi·ªØa Component Cha v√† Con th√¥ng qua **Callback/Props**. H√£y l∆∞u l·∫°i ƒë·ªÉ tham kh·∫£o khi c·∫ßn.

##### 1. Nguy√™n l√Ω c·ªët l√µi

* **D·ªØ li·ªáu (Data):** Ch·∫£y t·ª´ tr√™n xu·ªëng (Cha ‚Üí Con) th√¥ng qua `props`.
* **H√†nh ƒë·ªông (Actions/Events):** G·ª≠i t·ª´ d∆∞·ªõi l√™n (Con ‚Üí Cha) th√¥ng qua vi·ªác g·ªçi h√†m (Callback).

##### 2. Quy chu·∫©n ƒë·∫∑t t√™n (Naming Convention)

ƒê·ªÉ code d·ªÖ ƒë·ªçc v√† d·ªÖ b·∫£o tr√¨, c·ªông ƒë·ªìng React th·ªëng nh·∫•t quy t·∫Øc:

| V·ªã tr√≠ | T√™n h√†m/Prop | √ù nghƒ©a | V√≠ d·ª• |
| --- | --- | --- | --- |
| **T·∫°i Component Cha** | **`handle`** + `T√™n H√†nh ƒê·ªông` | H√†m n√†y ch·ª©a **LOGIC** x·ª≠ l√Ω. | `handleSave`, `handleChange` |
| **T·∫°i Props (C·∫ßu n·ªëi)** | **`on`** + `T√™n S·ª± Ki·ªán` | T√™n c·ªßa c√°i "d√¢y n·ªëi" m√† cha ƒë∆∞a xu·ªëng. | `onSave`, `onChange` |
| **T·∫°i Component Con** | G·ªçi `props.`**`on...`** | Con k√≠ch ho·∫°t s·ª± ki·ªán ƒë·ªÉ b√°o c√°o/g·ª≠i d·ªØ li·ªáu. | `props.onSave(data)` |

##### 3. C∆° ch·∫ø ho·∫°t ƒë·ªông (Lu·ªìng ch·∫°y)

Quy tr√¨nh k·∫øt n·ªëi g·ªìm 3 b∆∞·ªõc c·ª• th·ªÉ:

* **B∆∞·ªõc 1 (T·∫°i Cha - Logic):**
  * Cha khai b√°o m·ªôt h√†m `handle...` (v√≠ d·ª•: `handleUpdate`).
  * ƒê√¢y l√† n∆°i x·ª≠ l√Ω d·ªØ li·ªáu cu·ªëi c√πng (l∆∞u v√†o state, g·ªçi API...).

* **B∆∞·ªõc 2 (T·∫°i Cha - K·∫øt n·ªëi):**
  * Trong ph·∫ßn `return` c·ªßa Cha: Cha g√°n h√†m `handle...` c·ªßa m√¨nh v√†o m·ªôt **Prop** (v√≠ d·ª•: `onUpdate`) c·ªßa th·∫ª Con.
  * *L∆∞u √Ω:* Cha k·∫øt n·ªëi v√†o **Prop**, kh√¥ng k·∫øt n·ªëi tr·ª±c ti·∫øp v√†o h√†m n·ªôi b·ªô c·ªßa con.

* **B∆∞·ªõc 3 (T·∫°i Con - Th·ª±c thi):**
  * Trong ph·∫ßn `return` (ho·∫∑c logic) c·ªßa Con: Khi s·ª± ki·ªán x·∫£y ra (click, type...), Con g·ªçi `props.onUpdate(value)`.
  * H√†nh ƒë·ªông n√†y "b·∫Øn" gi√° tr·ªã `value` ng∆∞·ª£c l√™n h√†m `handleUpdate` c·ªßa Cha.

##### 4. Code t·ªïng h·ª£p m·∫´u

```jsx
// --- COMPONENT CON (Ng∆∞·ªùi g·ª≠i) ---
function HamCon(props) {
    // Helper function c·ªßa con (T√πy ch·ªçn: d√πng ƒë·ªÉ chu·∫©n b·ªã d·ªØ li·ªáu)
    const chuanBiDuLieu = () => {
        const data = "D·ªØ li·ªáu t·ª´ Con";
        
        // [QUAN TR·ªåNG] G·ªçi prop on... ƒë·ªÉ tr·∫£ value v·ªÅ cho cha
        props.onGuiTin(data); 
    };

    return (
        // S·ª± ki·ªán click k√≠ch ho·∫°t vi·ªác g·ª≠i tin
        <button onClick={chuanBiDuLieu}>
            G·ª≠i cho Cha
        </button>
    );
}

// --- COMPONENT CHA (Ng∆∞·ªùi nh·∫≠n & X·ª≠ l√Ω) ---
function HamCha() {
    // [QUAN TR·ªåNG] Helper function c·ªßa Cha: D√πng handle...
    const handleNhanTin = (valueTuCon) => {
        console.log("X·ª≠ l√Ω logic v·ªõi: ", valueTuCon);
    };

    return (
        <div>
            {/* [QUAN TR·ªåNG] K·∫øt n·ªëi: G√°n handle (Cha) v√†o on (Prop) */}
            <HamCon onGuiTin={handleNhanTin} />
        </div>
    );
}
```

##### 5. ƒê√≠nh ch√≠nh quan tr·ªçng

> **ƒê√öNG:** Con d√πng `on+Name` ƒë·ªÉ tr·∫£ `value` v·ªÅ cho cha.
> 
> **CH·ªàNH L·∫†I:** Trong `return` c·ªßa Cha, Cha **kh√¥ng nh√¨n th·∫•y** h√†m helper b√™n trong Con. Cha ch·ªâ nh√¨n th·∫•y **Props** c·ªßa Con.
> 
> Do ƒë√≥, Cha k·∫øt n·ªëi `helperFunction Cha` ‚Üí `Props c·ªßa Con`.

**Gi·∫£i th√≠ch theo 3 b∆∞·ªõc:**

* **B∆∞·ªõc 1 - Logic t·∫°i Cha:**
  * Trong code tr√™n, d√≤ng `const handleNhanTin = (valueTuCon) => { ... }` l√† n∆°i Cha ƒë·ªãnh nghƒ©a logic x·ª≠ l√Ω.
  * H√†m n√†y s·∫Ω nh·∫≠n d·ªØ li·ªáu t·ª´ Con v√† x·ª≠ l√Ω (·ªü ƒë√¢y l√† in ra console).

* **B∆∞·ªõc 2 - K·∫øt n·ªëi t·∫°i Cha:**
  * D√≤ng `<HamCon onGuiTin={handleNhanTin} />` ch√≠nh l√† Cha "c·∫Øm d√¢y" - g√°n h√†m `handleNhanTin` v√†o **Prop** `onGuiTin`.
  * L√∫c n√†y Cha ƒë√£ t·∫°o "c·∫ßu n·ªëi" cho Con, nh∆∞ng h√†m v·∫´n ch∆∞a ch·∫°y.

* **B∆∞·ªõc 3 - Th·ª±c thi t·∫°i Con:**
  * B√™n trong Con, khi user click button, d√≤ng `props.onGuiTin(data)` ƒë∆∞·ª£c g·ªçi.
  * Th·ª±c ch·∫•t Con ƒëang g·ªçi h√†m `handleNhanTin` c·ªßa Cha (v√¨ Cha ƒë√£ g√°n n√≥ v√†o prop `onGuiTin`).
  * Gi√° tr·ªã `data` t·ª´ Con ƒë∆∞·ª£c "b·∫Øn" ng∆∞·ª£c l√™n Cha qua tham s·ªë `valueTuCon`.

> ƒê√¢y ch√≠nh l√† **Callback Pattern**: Cha ƒë∆∞a c√¥ng c·ª• (h√†m) cho Con, Con d√πng c√¥ng c·ª• ƒë√≥ ƒë·ªÉ "g·ªçi ng∆∞·ª£c" l·∫°i Cha.

---

#### 5.7. T√≥m t·∫Øt: 4 Tr·ª• c·ªôt React trong v√≠ d·ª•

V√≠ d·ª• `ProductList` v√† `ProductItem` ·ªü tr√™n tuy ng·∫Øn nh∆∞ng ƒë√£ minh h·ªça ƒë·∫ßy ƒë·ªß **4 ki·∫øn th·ª©c tr·ª• c·ªôt** c·ªßa React:

**1. Data Flow (D√≤ng ch·∫£y d·ªØ li·ªáu - Downwards)**
*   D·ªØ li·ªáu `products` ch·ªâ ƒë∆∞·ª£c **s·ªëng** ·ªü Component Cha (`ProductList`).
*   Component Con (`ProductItem`) mu·ªën c√≥ d·ªØ li·ªáu? Cha ph·∫£i truy·ªÅn xu·ªëng qua `props` (`product={item}`).
*   Con **kh√¥ng ƒë∆∞·ª£c quy·ªÅn** s·ª≠a d·ªØ li·ªáu n√†y. N√≥ ch·ªâ ƒë∆∞·ª£c ƒë·ªçc v√† hi·ªÉn th·ªã.

**2. Event Flow (D√≤ng ch·∫£y s·ª± ki·ªán - Upwards)**
*   Con mu·ªën x√≥a ch√≠nh n√≥, nh∆∞ng Con kh√¥ng gi·ªØ State, n√™n Con **kh√¥ng th·ªÉ t·ª± x√≥a**.
*   Con ph·∫£i **"b√°o c√°o"** l√™n Cha: *"Cha ∆°i, ng∆∞·ªùi d√πng mu·ªën x√≥a th·∫±ng c√≥ ID l√† 1"*.
*   C√°ch b√°o c√°o: G·ªçi c√°i h√†m m√† Cha ƒë√£ ƒë∆∞a cho l√∫c tr∆∞·ªõc (`onDelete`).
*   ƒê√¢y l√† m√¥ h√¨nh **Inverse Data Flow** (D√≤ng d·ªØ li·ªáu ng∆∞·ª£c) th√¥ng qua Callback Functions.

**3. State Immutability (T√≠nh b·∫•t bi·∫øn)**
*   Trong h√†m `handleDelete`, ta **TUY·ªÜT ƒê·ªêI KH√îNG** l√†m th·∫ø n√†y:
    ```javascript
    products.pop(); // SAI! S·ª≠a tr·ª±c ti·∫øp v√†o m·∫£ng c≈©
    setProducts(products); // React s·∫Ω kh√¥ng th·∫•y s·ª± thay ƒë·ªïi v√¨ tham chi·∫øu m·∫£ng v·∫´n nh∆∞ c≈©.
    ```
*   Ta ph·∫£i d√πng `.filter()`: H√†m n√†y kh√¥ng s·ª≠a m·∫£ng c≈©, m√† n√≥ l·∫≥ng l·∫∑ng t·∫°o ra m·ªôt **m·∫£ng m·ªõi** ch·ª©a k·∫øt qu·∫£. Khi React th·∫•y m·∫£ng m·ªõi n√†y, n√≥ m·ªõi ch·ªãu c·∫≠p nh·∫≠t giao di·ªán.

**4. Key Prop (ƒê·ªãnh danh)**
*   D√≤ng `key={item.id}` kh√¥ng ph·∫£i ƒë·ªÉ cho ƒë·∫πp. N√≥ gi√∫p React bi·∫øt ch√≠nh x√°c: *"√Ä, c√°i th·∫±ng Laptop Dell (ID 1) v·∫´n c√≤n, th·∫±ng Iphone (ID 2) b·ªã x√≥a"*.
*   N·∫øu d√πng `index` l√†m key, khi x√≥a th·∫±ng ƒë·∫ßu ti√™n, React s·∫Ω b·ªã lo·∫°n v√† ph·∫£i v·∫Ω l·∫°i to√†n b·ªô danh s√°ch, g√¢y l√£ng ph√≠ t√†i nguy√™n kh·ªßng khi·∫øp.

---

### 6. B√†i t·∫≠p th·ª±c h√†nh (Module 2)

**B√†i to√°n:** T·∫°o m·ªôt danh s√°ch c√¥ng vi·ªác (Todo List) ƒë∆°n gi·∫£n.

1. C√≥ m·ªôt n√∫t "Th√™m c√¥ng vi·ªác".
    
2. M·ªói l·∫ßn b·∫•m, th√™m m·ªôt d√≤ng "C√¥ng vi·ªác m·ªõi" v√†o danh s√°ch.
    

**G·ª£i √Ω gi·∫£i (Mental Model):**

- C·∫ßn `state` ƒë·ªÉ l∆∞u danh s√°ch: `const [todos, setTodos] = useState([])`.
    
- S·ª± ki·ªán click s·∫Ω g·ªçi `setTodos` ƒë·ªÉ t·∫°o m·∫£ng m·ªõi, c√≥ th√™m ph·∫ßn t·ª≠ m·ªõi.
    
- D√πng `.map()` ƒë·ªÉ render ra `<li>`.
    

```jsx
function TodoApp() {
  const [todos, setTodos] = useState(['H·ªçc React', 'Vi·∫øt Code']);

  const addJob = () => {
    // L∆∞u √Ω: Ph·∫£i t·∫°o m·∫£ng m·ªõi (Immutability), kh√¥ng d√πng .push()
    setTodos([...todos, 'C√¥ng vi·ªác m·ªõi']); 
  };

  return (
    <div>
      <button onClick={addJob}>Th√™m vi·ªác</button>
      <ul>
        {todos.map((job, index) => (
           // T·∫°m d√πng index l√†m key v√¨ danh s√°ch ƒë∆°n gi·∫£n
           <li key={index}>{job}</li>
        ))}
      </ul>
    </div>
  );
}
```

## PH·∫¶N 4: T√ÄI LI·ªÜU CHI TI·∫æT - MODULE 3: SIDE EFFECTS & K·∫æT N·ªêI TH·∫æ GI·ªöI B√äN NGO√ÄI

### 1. Pure Function vs Side Effects

Tr∆∞·ªõc khi h·ªçc `useEffect`, b·∫°n c·∫ßn hi·ªÉu React gh√©t c√°i g√¨ nh·∫•t. React gh√©t **s·ª± thi·∫øu tinh khi·∫øt** trong qu√° tr√¨nh render.

#### 1.1. Pure Function (H√†m thu·∫ßn khi·∫øt) - Ti√™u chu·∫©n v√†ng

H√†m Component `UserCard(props)` ƒë∆∞·ª£c coi l√† thu·∫ßn khi·∫øt khi:

1. **C√πng ƒë·∫ßu v√†o lu√¥n ra c√πng ƒë·∫ßu ra:** ƒê∆∞a `props` A lu√¥n nh·∫≠n ƒë∆∞·ª£c UI A.
    
2. **Kh√¥ng l√†m thay ƒë·ªïi b√™n ngo√†i:** Kh√¥ng s·ª≠a bi·∫øn to√†n c·ª•c, kh√¥ng s·ª≠a DOM tr·ª±c ti·∫øp, kh√¥ng g·ªçi API ng·∫ßm.
    

#### 1.2. Side Effects (T√°c d·ª•ng ph·ª•) - Nh·ªØng k·∫ª ph√° bƒ©nh

Side Effect l√† b·∫•t c·ª© th·ª© g√¨ l√†m ·∫£nh h∆∞·ªüng ƒë·∫øn th·∫ø gi·ªõi b√™n ngo√†i ph·∫°m vi c·ªßa h√†m.

- G·ªçi API l·∫•y d·ªØ li·ªáu.
    
- `document.title = "Hello"`.
    
- `setTimeout`, `setInterval`.
    
- ƒêƒÉng k√Ω s·ª± ki·ªán `window.addEventListener`.
    

> **Quy t·∫Øc sinh t·ª≠:** **TUY·ªÜT ƒê·ªêI KH√îNG** vi·∫øt Side Effect tr·ª±c ti·∫øp trong th√¢n h√†m Component. V√¨ Component c√≥ th·ªÉ render l·∫°i h√†ng ch·ª•c l·∫ßn m·ªói gi√¢y, Side Effect c≈©ng s·∫Ω ch·∫°y l·∫°i b·∫•y nhi√™u l·∫ßn (g√¢y crash app, spam API).

---

### 1.3. So s√°nh tri·∫øt l√Ω: React (Explicit) vs PHP (Implicit)

ƒê·ªÉ hi·ªÉu s√¢u h∆°n t·∫°i sao React c√≥ nh·ªØng quy t·∫Øc nghi√™m ng·∫∑t nh∆∞ v·∫≠y, h√£y nh√¨n v√†o cu·ªôc chi·∫øn tri·∫øt l√Ω gi·ªØa **React (T∆∞ duy hi·ªán ƒë·∫°i, T∆∞·ªùng minh)** v√† **PHP (T∆∞ duy Legacy, Ng·∫ßm ƒë·ªãnh)**.

#### 1.3.1. Cu·ªôc chi·∫øn tri·∫øt l√Ω: Explicit (R√µ r√†ng) vs. Implicit (Ng·∫ßm ƒë·ªãnh)

ƒê√¢y l√† nguy√™n nh√¢n c·ªët l√µi khi·∫øn nhi·ªÅu l·∫≠p tr√¨nh vi√™n hi·ªán ƒë·∫°i "gh√©t" s·ª± ma thu·∫≠t (magic) c·ªßa PHP ki·ªÉu c≈©.

| ƒê·∫∑c ƒëi·ªÉm | React (T∆∞ duy hi·ªán ƒë·∫°i) | PHP (Ki·ªÉu c≈© / Framework c≈©) |
| --- | --- | --- |
| **D√≤ng d·ªØ li·ªáu** | **M·ªôt chi·ªÅu & R√µ r√†ng.** Cha truy·ªÅn cho con qua `props`. Nh√¨n v√†o component l√† bi·∫øt data t·ª´ ƒë√¢u t·ªõi. | **ƒêa chi·ªÅu & ·∫®n danh.** Data c√≥ th·ªÉ ƒë·∫øn t·ª´ `global`, `session`, `$_REQUEST`... l∆° l·ª≠ng trong m√¥i tr∆∞·ªùng. |
| **ƒê·ªô tin c·∫≠y** | **Pure (Thu·∫ßn khi·∫øt).** C√πng m·ªôt ƒë·∫ßu v√†o (Props), lu√¥n ra c√πng k·∫øt qu·∫£ (UI). | **Unpredictable (Kh√≥ ƒëo√°n).** C√πng m·ªôt h√†m, ch·∫°y l√∫c n√†y th√¨ ƒë√∫ng, ch·∫°y l√∫c kh√°c th√¨ sai do bi·∫øn m√¥i tr∆∞·ªùng thay ƒë·ªïi. |
| **Debug** | D·ªÖ. L·ªói ·ªü ƒë√¢u, nh√¨n lu·ªìng props l√† ra. | Kh√≥. Ph·∫£i truy t√¨m xem bi·∫øn ƒë√≥ b·ªã thay ƒë·ªïi ·ªü file n√†o trong h√†ng ch·ª•c file `include`. |

#### 1.3.2. ƒê·ªãnh nghƒ©a l·∫°i "Ma thu·∫≠t" (Magic)

* **Trong PHP (Ki·ªÉu c≈©):** "Ma thu·∫≠t" l√† nh·ªØng th·ª© t·ª± ƒë·ªông x·∫£y ra m√† kh√¥ng c·∫ßn vi·∫øt code r√µ r√†ng. V√≠ d·ª•: `$_REQUEST` t·ª± ƒë·ªông gom `GET`, `POST`, `COOKIE` l·∫°i. N√≥ ti·ªán cho ng∆∞·ªùi vi·∫øt nhanh, nh∆∞ng l√† √°c m·ªông cho ng∆∞·ªùi ƒë·ªçc v√† b·∫£o tr√¨ (maintain).
    
* **Trong React:** Kh√¥ng c√≥ ma thu·∫≠t. M·ªçi th·ª© ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c khai b√°o. N·∫øu component c·∫ßn d·ªØ li·ªáu, n√≥ ph·∫£i "xin" qua `props` ho·∫∑c `hooks`. M·ªçi th·ª© ƒë·ªÅu **Explicit (T∆∞·ªùng minh)**.
    

#### 1.3.3. C∆° ch·∫ø ki·ªÉm so√°t th·∫ø gi·ªõi b√™n ngo√†i (Side Effects)

ƒê√¢y ch√≠nh l√† l√Ω do t·∫°i sao `useEffect` t·ªìn t·∫°i v√† t·∫°i sao n√≥ quan tr·ªçng.

**Quy t·∫Øc b·∫•t di b·∫•t d·ªãch:** Component React gi·ªëng nh∆∞ m·ªôt **"ph√°o ƒë√†i"**.

* **B√™n ngo√†i (Outsider):** Kh√¥ng th·ªÉ t·ª± √Ω can thi·ªáp v√†o n·ªôi b·ªô component, tr·ª´ khi ƒëi qua "c·ªïng ch√≠nh" l√† **Props**.
    
* **B√™n trong (Insider):** Kh√¥ng ƒë∆∞·ª£c t·ª± √Ω ch·∫°y ra ngo√†i l√†m lo·∫°n (s·ª≠a DOM, g·ªçi API lung tung) trong l√∫c ƒëang t√≠nh to√°n giao di·ªán (Render).
    
* **V√πng ƒë·∫∑c bi·ªát (Special Zone):** React d√†nh ri√™ng **M·ªòT V√Ä CH·ªà M·ªòT** v√πng cho ph√©p can thi·ªáp b√™n ngo√†i: ƒë√≥ l√† `useEffect`. V√πng n√†y n·∫±m **b√™n trong** component, nh∆∞ng ch·ªâ ƒë∆∞·ª£c ph√©p ch·∫°y **SAU KHI** t·∫•t c·∫£ logic b√™n trong (t√≠nh to√°n UI) ƒë√£ ho√†n t·∫•t.
    

**Vai tr√≤ c·ªßa `useEffect`:**

* N√≥ l√† "khu v·ª±c c√°ch ly" d√†nh ri√™ng cho c√°c **Side Effects** - n∆°i duy nh·∫•t ƒë∆∞·ª£c ph√©p t√°c ƒë·ªông ra th·∫ø gi·ªõi b√™n ngo√†i.
    
* Mu·ªën g·ªçi API? Mu·ªën ƒë·ªïi title tr√¨nh duy·ªát? Mu·ªën l·∫Øng nghe s·ª± ki·ªán? ‚Üí **Ph·∫£i nh·ªët v√†o `useEffect`**.
    
* **Th·ª© t·ª± th·ª±c thi quan tr·ªçng:** 
  1. Component render (t√≠nh to√°n UI thu·∫ßn khi·∫øt)
  2. React v·∫Ω UI l√™n m√†n h√¨nh
  3. **SAU ƒê√ì M·ªöI** ch·∫°y `useEffect` (can thi·ªáp b√™n ngo√†i)
    
* ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o ph·∫ßn c√≤n l·∫°i c·ªßa component v·∫´n "Thu·∫ßn khi·∫øt" (Pure) v√† d·ªÖ ki·ªÉm so√°t, ƒë·ªìng th·ªùi kh√¥ng l√†m ch·∫∑n (block) qu√° tr√¨nh render.
    

#### 1.3.4. K·∫øt lu·∫≠n: T·∫°i sao React c·∫£m th·∫•y "t·ª± nhi√™n" h∆°n

L√Ω do nhi·ªÅu l·∫≠p tr√¨nh vi√™n c·∫£m th·∫•y "vibe" ƒë∆∞·ª£c code React/Next.js ngay c·∫£ khi ch∆∞a r√†nh JavaScript l√† v√¨ t√≠nh **Declarative (M√¥ t·∫£)** c·ªßa n√≥:

> **Code React gi·ªëng nh∆∞ b·∫£n v·∫Ω k·ªπ thu·∫≠t:** Nh√¨n v√†o l√† th·∫•y c·∫•u tr√∫c nh√†, c·ª≠a, ph√≤ng ·ªëc (UI structure). M·ªçi th·ª© ƒë·ªÅu r√µ r√†ng, minh b·∫°ch.
> 
> **Code PHP ki·ªÉu c≈© gi·ªëng nh∆∞ m√™ cung:** B·∫°n th·∫•y c√°i c·ª≠a, nh∆∞ng kh√¥ng bi·∫øt m·ªü ra l√† ph√≤ng kh√°ch hay... r∆°i xu·ªëng h·∫ßm, v√¨ ƒëi·ªÅu ƒë√≥ ph·ª• thu·ªôc v√†o "ph√©p thu·∫≠t" ·∫©n gi·∫•u b√™n d∆∞·ªõi.

ƒê√¢y ch√≠nh l√† s·ª©c m·∫°nh c·ªßa **Explicit Programming (L·∫≠p tr√¨nh t∆∞·ªùng minh)** - n·ªÅn t·∫£ng c·ªßa React v√† c√°c framework hi·ªán ƒë·∫°i.

---

### 2. Hook `useEffect`: N∆°i tr√∫ ·∫©n c·ªßa Side Effects

`useEffect` l√† n∆°i React cho ph√©p b·∫°n th·ª±c hi·ªán c√°c Side Effects m·ªôt c√°ch an to√†n **SAU KHI** giao di·ªán ƒë√£ ƒë∆∞·ª£c v·∫Ω xong.

```javascript
useEffect(() => {
  // Code Side Effect ·ªü ƒë√¢y (Call API, DOM...)
}, [dependencies]); // M·∫£ng ph·ª• thu·ªôc
```

#### 2.1. Logic ho·∫°t ƒë·ªông

1. React Render Component (T√≠nh to√°n UI).
    
2. React V·∫Ω UI l√™n m√†n h√¨nh (Browser Paint).
    
3. **SAU ƒê√ì**, React m·ªõi ch·∫°y `useEffect`. -> _ƒêi·ªÅu n√†y gi√∫p giao di·ªán kh√¥ng b·ªã ch·∫∑n (block) b·ªüi c√°c t√°c v·ª• n·∫∑ng._
    

### 3. Dependency Array: C√°i phanh c·ªßa useEffect

Tham s·ªë th·ª© 2 c·ªßa `useEffect` (`[]`) quy·∫øt ƒë·ªãnh **khi n√†o** effect ƒë∆∞·ª£c ch·∫°y l·∫°i. ƒê√¢y l√† ph·∫ßn d·ªÖ g√¢y l·ªói nh·∫•t (Infinite Loop).

| **Dependency Array** | **√ù nghƒ©a** | **Khi n√†o ch·∫°y?** |
|---|---|---|
| **Kh√¥ng truy·ªÅn** | `useEffect(() => {})` | Ch·∫°y **M·ªñI L·∫¶N** render (Nguy hi·ªÉm, gi·ªëng code th·∫≥ng trong h√†m). |
| **M·∫£ng r·ªóng** | `useEffect(() => {}, [])` | Ch·∫°y **DUY NH·∫§T 1 L·∫¶N** sau khi mount (Gi·ªëng `componentDidMount`). D√πng ƒë·ªÉ g·ªçi API l·∫ßn ƒë·∫ßu. |
| **C√≥ bi·∫øn** | `useEffect(() => {}, [userId])` | Ch·∫°y l·∫ßn ƒë·∫ßu **V√Ä** ch·∫°y m·ªói khi `userId` thay ƒë·ªïi. |

### 4. Cleanup Function: D·ªçn d·∫πp chi·∫øn tr∆∞·ªùng

ƒê√¥i khi Effect ƒë·ªÉ l·∫°i "r√°c" (nh∆∞ timer ƒëang ch·∫°y, k·∫øt n·ªëi socket ƒëang m·ªü). N·∫øu Component b·ªã x√≥a kh·ªèi m√†n h√¨nh (Unmount) m√† kh√¥ng d·ªçn r√°c => **Memory Leak** (R√≤ r·ªâ b·ªô nh·ªõ).

ƒê·ªÉ d·ªçn d·∫πp, b·∫°n return m·ªôt h√†m t·ª´ trong `useEffect`.

```javascript
useEffect(() => {
  console.log("1. ƒêƒÉng k√Ω s·ª± ki·ªán Chat");
  const connection = createConnection();

  // Cleanup Function
  return () => {
    console.log("2. Ng·∫Øt k·∫øt n·ªëi Chat (D·ªçn d·∫πp)");
    connection.disconnect();
  };
}, [roomId]);
```

**Quy tr√¨nh:**

1. Ng∆∞·ªùi d√πng ƒë·ªïi ph√≤ng chat (roomId ƒë·ªïi).
    
2. React ch·∫°y h√†m Cleanup c·ªßa l·∫ßn tr∆∞·ªõc (Ng·∫Øt k·∫øt n·ªëi c≈©).
    
3. React ch·∫°y Effect m·ªõi (K·∫øt n·ªëi ph√≤ng m·ªõi).
    

### 5. B√†i t·∫≠p th·ª±c h√†nh (Module 3)

**B√†i to√°n:** ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c v√† Ti√™u ƒë·ªÅ trang.

1. Hi·ªÉn th·ªã m·ªôt ƒë·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c t·ª´ 10 v·ªÅ 0.
    
2. ƒê·ªïi ti√™u ƒë·ªÅ tab tr√¨nh duy·ªát (`document.title`) th√†nh s·ªë gi√¢y c√≤n l·∫°i.
    
3. Khi v·ªÅ 0 th√¨ d·ª´ng l·∫°i.
    

**G·ª£i √Ω gi·∫£i (Mental Model):**

- C·∫ßn `useEffect` ƒë·ªÉ thi·∫øt l·∫≠p `setInterval`.
    
- M·∫£ng dependency r·ªóng `[]` ƒë·ªÉ timer ch·ªâ ch·∫°y 1 l·∫ßn l√∫c ƒë·∫ßu? Hay c·∫ßn c√°ch kh√°c?
    
- Quan tr·ªçng: Ph·∫£i d·ªçn d·∫πp `clearInterval` khi component unmount ƒë·ªÉ tr√°nh timer ch·∫°y ng·∫ßm.
    

```jsx
function Countdown() {
  const [count, setCount] = useState(10);

  useEffect(() => {
    // Side Effect 1: ƒê·ªïi title
    document.title = `C√≤n l·∫°i: ${count}`;
  }, [count]); // Ch·∫°y l·∫°i m·ªói khi count ƒë·ªïi ƒë·ªÉ c·∫≠p nh·∫≠t title

  useEffect(() => {
    // Side Effect 2: Timer
    const timerId = setInterval(() => {
      setCount((prevCount) => {
         if (prevCount <= 0) {
             clearInterval(timerId); // D·ª´ng khi v·ªÅ 0
             return 0;
         }
         return prevCount - 1;
      });
    }, 1000);

    // Cleanup: C·ª±c k·ª≥ quan tr·ªçng!
    // N·∫øu user chuy·ªÉn trang kh√°c, timer ph·∫£i b·ªã h·ªßy
    return () => clearInterval(timerId);
  }, []); // Ch·ªâ set timer 1 l·∫ßn l√∫c mount

  return <h1>{count}</h1>;
}
```

## PH·∫¶N 5: T√ÄI LI·ªÜU CHI TI·∫æT - MODULE 4: KI·∫æN TR√öC V√Ä LU·ªíNG D·ªÆ LI·ªÜU (DATA FLOW)

Trong React, d·ªØ li·ªáu (State) ƒë∆∞·ª£c v√≠ nh∆∞ d√≤ng n∆∞·ªõc. N√≥ ch·ªâ ch·∫£y m·ªôt chi·ªÅu t·ª´ tr√™n xu·ªëng d∆∞·ªõi. Vi·ªác hi·ªÉu c√°ch ƒëi·ªÅu h∆∞·ªõng d√≤ng n∆∞·ªõc n√†y ch√≠nh l√† ngh·ªá thu·∫≠t t·ªï ch·ª©c Code.

### 1. Lifting State Up: ƒê∆∞a tr·∫°ng th√°i l√™n cao

ƒê√¢y l√† m·∫´u thi·∫øt k·∫ø (pattern) ph·ªï bi·∫øn nh·∫•t ƒë·ªÉ chia s·∫ª d·ªØ li·ªáu.

V·∫•n ƒë·ªÅ:

T∆∞·ªüng t∆∞·ª£ng b·∫°n c√≥ 2 component con:

1. `Input`: ƒê·ªÉ nh·∫≠p nhi·ªát ƒë·ªô.
    
2. `Display`: ƒê·ªÉ hi·ªÉn th·ªã n∆∞·ªõc c√≥ s√¥i hay kh√¥ng.
    

N·∫øu `Input` gi·ªØ state `temperature`, th√¨ `Display` l√†m sao bi·∫øt nhi·ªát ƒë·ªô l√† bao nhi√™u ƒë·ªÉ hi·ªÉn th·ªã? Hai anh em ngang h√†ng kh√¥ng th·ªÉ "n√≥i chuy·ªán" tr·ª±c ti·∫øp.

**Gi·∫£i ph√°p:**

- **B1:** X√≥a state ·ªü `Input`.
    
- **B2:** Chuy·ªÉn state ƒë√≥ l√™n component cha chung (`Calculator`).
    
- **B3:** Cha truy·ªÅn `state` xu·ªëng cho `Display` (qua props) v√† truy·ªÅn h√†m `setState` xu·ªëng cho `Input` (qua props).
    

> **Nguy√™n l√Ω:** "Single Source of Truth" (M·ªôt ngu·ªìn s·ª± th·∫≠t duy nh·∫•t). D·ªØ li·ªáu ch·ªâ n·∫±m ·ªü m·ªôt ch·ªó v√† ch·∫£y xu·ªëng c√°c n∆°i c·∫ßn d√πng.

**V√≠ d·ª• Code:**

```jsx
// 1. Child Component A: The Input
// It receives the current value and the function to update it via props.
const TemperatureInput = ({ temperature, onTemperatureChange }) => {
    return (
        <fieldset className="border-2 border-gray-300 dark:border-gray-600 rounded-lg p-4">
            <legend className="text-lg font-semibold px-2">Enter temperature in Celsius:</legend>
            <input
                value={temperature}
                onChange={(e) => onTemperatureChange(e.target.value)}
                type="number"
                className="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:bg-gray-700 dark:text-white"
            />
        </fieldset>
    );
};

// 2. Child Component B: The Display
// It receives the temperature via props to decide what to show.
const BoilingVerdict = ({ celsius }) => {
    if (celsius >= 100) {
        return <p className="text-green-600 font-bold text-xl mt-4">The water would boil. üíßüî•</p>;
    }
    return <p className="text-red-600 text-xl mt-4">The water would not boil. ‚ùÑÔ∏è</p>;
};

// 3. The Parent Component: Calculator
// This is where the state "lives" (The Single Source of Truth)
const LiftingStateUpExample = () => {
    // B2: State is initialized here, not in the Input
    const [temperature, setTemperature] = useState('');

    // The handler function that updates the state
    const handleChange = (newTemperature) => {
        setTemperature(newTemperature);
    };

    return (
        <div className="min-h-screen bg-gradient-to-br from-purple-50 to-pink-100 dark:from-gray-900 dark:to-gray-800 p-6 sm:p-8 md:p-12">
            <div className="max-w-3xl mx-auto w-full">
                {/* Back Button */}
                <Link
                    to="/"
                    className="inline-flex items-center text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 mb-6 font-semibold"
                >
                    ‚Üê Back to Home
                </Link>

                {/* Main Card */}
                <div className="bg-white dark:bg-gray-800 p-8 border-2 border-gray-200 dark:border-gray-700 rounded-xl shadow-2xl">
                    <h1 className="text-3xl font-bold mb-2 text-gray-900 dark:text-white">
                        Lifting State Up Example
                    </h1>
                    <p className="text-gray-600 dark:text-gray-300 mb-6">
                        This example demonstrates how to share state between components by lifting it to their closest common ancestor.
                    </p>

                    {/* B3: Pass the function down to Input */}
                    <TemperatureInput
                        temperature={temperature}
                        onTemperatureChange={handleChange}
                    />

                    {/* B3: Pass the state down to Display */}
                    <BoilingVerdict
                        celsius={parseFloat(temperature)}
                    />

                    {/* Explanation Section */}
                    <div className="mt-8 p-4 bg-indigo-50 dark:bg-gray-700 rounded-lg">
                        <h3 className="font-bold text-lg mb-2 text-gray-900 dark:text-white">üí° Key Concept</h3>
                        <ul className="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                            <li>The <code className="bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded">temperature</code> state lives in the parent component (Single Source of Truth)</li>
                            <li>The input component receives both the value and the updater function via props</li>
                            <li>The verdict component receives the state to display the result</li>
                            <li>Both child components stay in sync because they share the same state</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default LiftingStateUpExample;
```

#### Gi·∫£i th√≠ch chi ti·∫øt: `value={temperature}` - Controlled Component

Trong v√≠ d·ª• tr√™n, c√≥ m·ªôt d√≤ng code c·ª±c k·ª≥ quan tr·ªçng m√† nhi·ªÅu ng∆∞·ªùi m·ªõi h·ªçc th∆∞·ªùng b·ªè qua:

```jsx
<input
    value={temperature}  // ‚Üê D√≤ng n√†y!
    onChange={(e) => onTemperatureChange(e.target.value)}
/>
```

**ƒêi·ªÅu g√¨ ƒëang x·∫£y ra?**

ƒêo·∫°n code n√†y nh·∫±m l√†m cho **gi√° tr·ªã nh·∫≠p v√†o kh√¥ng hi·ªÉn th·ªã tr·ª±c ti·∫øp**, m√† ph·∫£i tr·∫£i qua m·ªôt "h√†nh tr√¨nh v√≤ng quanh":

1. **Ng∆∞·ªùi d√πng g√µ s·ªë** v√†o √¥ input ‚Üí S·ª± ki·ªán `onChange` ƒë∆∞·ª£c k√≠ch ho·∫°t.
2. **Gi√° tr·ªã m·ªõi ƒëi l√™n cha** (qua h√†m `onTemperatureChange`).
3. **Cha c·∫≠p nh·∫≠t state** (`setTemperature`).
4. **React render l·∫°i component con**.
5. **Gi√° tr·ªã m·ªõi ƒëi xu·ªëng l·∫°i** (qua prop `temperature`).
6. **Cu·ªëi c√πng m·ªõi hi·ªÉn th·ªã** l√™n m√†n h√¨nh.

> **Mental Model:** Thay v√¨ √¥ input t·ª± qu·∫£n l√Ω gi√° tr·ªã c·ªßa ch√≠nh n√≥ (nh∆∞ HTML th√¥ng th∆∞·ªùng), React **chi·∫øm quy·ªÅn ki·ªÉm so√°t ho√†n to√†n** (Controlled Component).

---

#### So s√°nh: Server-side vs Client-side

ƒê√¢y l√† s·ª± kh√°c bi·ªát cƒÉn b·∫£n gi·ªØa ng√¥n ng·ªØ Server-side (nh∆∞ PHP) v√† Client-side (nh∆∞ React):

| **ƒê·∫∑c ƒëi·ªÉm** | **HTML Th√¥ng th∆∞·ªùng (PHP, Server-side)** | **React (Client-side)** |
| --- | --- | --- |
| **C√°ch ho·∫°t ƒë·ªông** | Tag `<input>` t·ª± qu·∫£n l√Ω gi√° tr·ªã c·ªßa n√≥. Gi√° tr·ªã nh·∫≠p v√†o l√† gi√° tr·ªã hi·ªÉn th·ªã. | React ki·ªÉm so√°t gi√° tr·ªã qua `value={state}`. Input ch·ªâ l√† "m√†n h√¨nh hi·ªÉn th·ªã". |
| **Khi n√†o d·ªØ li·ªáu ƒë∆∞·ª£c g·ª≠i?** | C·∫ßn b·∫•m n√∫t **Submit** ho·∫∑c nh·∫•n **Enter** m·ªõi push gi√° tr·ªã l√™n server. | **Real-time**: M·ªói l·∫ßn g√µ ph√≠m, gi√° tr·ªã ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t ngay l·∫≠p t·ª©c. |
| **V√≠ d·ª• (PHP)** | `<form method="POST"><input name="temp"/></form>`<br/>‚Üí Khi submit, `$_POST['temp']` m·ªõi nh·∫≠n ƒë∆∞·ª£c gi√° tr·ªã. | `<input value={temperature} onChange={...} />`<br/>‚Üí M·ªói ph√≠m g√µ, state `temperature` ƒë√£ thay ƒë·ªïi ngay. |
| **T√≠nh nƒÉng** | D·ªØ li·ªáu ch·ªâ c√≥ tr√™n server sau khi g·ª≠i form. | D·ªØ li·ªáu lu√¥n s·∫µn s√†ng trong JavaScript, c√≥ th·ªÉ validate ngay, hi·ªÉn th·ªã k·∫øt qu·∫£ t·ª©c th√¨. |

**V√≠ d·ª• c·ª• th·ªÉ:**

- **PHP (Server-side):**
  ```html
  <form method="POST">
    <input name="temperature" />
    <button type="submit">Ki·ªÉm tra</button>
  </form>
  ```
  B·∫°n nh·∫≠p s·ªë 100, nh∆∞ng ch·ªâ khi b·∫•m "Ki·ªÉm tra", trang web m·ªõi reload v√† PHP m·ªõi in ra "N∆∞·ªõc s·∫Ω s√¥i".

- **React (Client-side):**
  B·∫°n nh·∫≠p s·ªë 100, **ngay l·∫≠p t·ª©c** (kh√¥ng c·∫ßn b·∫•m g√¨), d√≤ng ch·ªØ "The water would boil üíßüî•" ƒë√£ hi·ªán ra b√™n d∆∞·ªõi.

---

#### T·∫°i sao ph·∫£i d√πng Controlled Component?

1. **ƒê·ªìng b·ªô h√≥a (Sync):** ƒê·∫£m b·∫£o gi√° tr·ªã hi·ªÉn th·ªã tr√™n UI lu√¥n kh·ªõp v·ªõi gi√° tr·ªã trong state. Kh√¥ng c√≥ tr∆∞·ªùng h·ª£p "state n√≥i 50 nh∆∞ng m√†n h√¨nh hi·ªán 60".

2. **D·ªÖ ki·ªÉm so√°t:** B·∫°n c√≥ th·ªÉ validate, format, ho·∫∑c ch·∫∑n input kh√¥ng h·ª£p l·ªá ngay khi ng∆∞·ªùi d√πng g√µ.
   ```jsx
   const handleChange = (newValue) => {
     // Ch·ªâ cho ph√©p s·ªë t·ª´ 0 ƒë·∫øn 200
     if (newValue >= 0 && newValue <= 200) {
       setTemperature(newValue);
     }
   };
   ```

3. **Single Source of Truth:** D·ªØ li·ªáu ch·ªâ s·ªëng ·ªü m·ªôt ch·ªó (state), t·∫•t c·∫£ component kh√°c ƒë·ªÅu nh√¨n v√†o ƒë√≥. Kh√¥ng c√≥ "nhi·ªÅu ngu·ªìn s·ª± th·∫≠t" g√¢y m√¢u thu·∫´n.

---

### 2. Context API: ƒê∆∞·ªùng h·∫ßm xuy√™n kh√¥ng

Khi ·ª©ng d·ª•ng qu√° l·ªõn, vi·ªác truy·ªÅn props qua 10 t·∫ßng (√îng c·ªë -> √îng -> Cha -> Con -> Ch√°u) ƒë∆∞·ª£c g·ªçi l√† **Prop Drilling** (Khoan th·ªßng props). N√≥ l√†m code c·ª±c k·ª≥ r·ªëi r·∫Øm.

**Gi·∫£i ph√°p:** S·ª≠ d·ª•ng Context ƒë·ªÉ t·∫°o m·ªôt "ƒë∆∞·ªùng h·∫ßm".

- **Provider (Ngu·ªìn ph√°t):** ƒê·∫∑t ·ªü t·∫ßng cao nh·∫•t, ch·ª©a d·ªØ li·ªáu (v√≠ d·ª•: Theme m√†u, User ƒëang ƒëƒÉng nh·∫≠p).
    
- **Consumer/useContext (N∆°i nh·∫≠n):** Component con ·ªü b·∫•t k·ª≥ t·∫ßng n√†o c≈©ng c√≥ th·ªÉ "h√∫t" d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ ƒë∆∞·ªùng h·∫ßm m√† kh√¥ng c·∫ßn th√¥ng qua cha.
    

```jsx
// 1. T·∫°o Context
const ThemeContext = createContext('light');

// 2. Cung c·∫•p d·ªØ li·ªáu (·ªû t·∫ßng tr√™n c√πng)
<ThemeContext.Provider value="dark">
   <App />
</ThemeContext.Provider>

// 3. S·ª≠ d·ª•ng d·ªØ li·ªáu (·ªû t·∫ßng s√¢u nh·∫•t)
const theme = useContext(ThemeContext); // Nh·∫≠n ƒë∆∞·ª£c "dark" ngay l·∫≠p t·ª©c
```

**V√≠ d·ª• ƒë·∫ßy ƒë·ªß:**

```javascript
import React, { createContext, useContext, useState } from 'react';

// ==========================================
// STEP 1: Create the Context
// ==========================================
// This creates the "tunnel." 'light' is the default value 
// if no Provider is found (rarely used but good for testing).
const ThemeContext = createContext('light');

// ==========================================
// STEP 2: The Consumer Component (The Child)
// ==========================================
// This component is deep in the tree. It uses the hook to 
// "suck" data directly from the context.
function ThemedButton() {
  // 1. Access the context value
  const theme = useContext(ThemeContext);

  // Simple styling based on the theme value
  const styles = {
    backgroundColor: theme === 'dark' ? '#333' : '#FFF',
    color: theme === 'dark' ? '#FFF' : '#000',
    border: '1px solid #ccc',
    padding: '10px 20px',
    borderRadius: '5px',
    cursor: 'pointer',
    marginTop: '10px'
  };

  return (
    <button style={styles}>
      I am a {theme} button!
    </button>
  );
}

// ==========================================
// Intermediate Component
// ==========================================
// Notice this component DOES NOT take any theme props.
// It just passes the UI down. This solves "Prop Drilling".
function Toolbar() {
  return (
    <div style={{ padding: '20px', border: '1px dashed grey' }}>
      <p>Toolbar Component (I don't know the theme!)</p>
      <ThemedButton /> 
    </div>
  );
}

// ==========================================
// STEP 3: The Provider Component (The Parent)
// ==========================================
// This is the top-level component that manages the state
// and pushes it into the "tunnel" (Provider).
export default function App() {
  const [theme, setTheme] = useState('light');

  const toggleTheme = () => {
    setTheme((prevTheme) => (prevTheme === 'light' ? 'dark' : 'light'));
  };

  return (
    // We wrap everything in the Provider.
    // The 'value' prop is what sends data into the tunnel.
    <ThemeContext.Provider value={theme}>
      
      <div style={{ padding: '20px', textAlign: 'center' }}>
        <h1>useContext Example</h1>
        
        {/* Button to control the state */}
        <button onClick={toggleTheme} style={{ marginBottom: '20px' }}>
          Toggle Theme
        </button>

        {/* The Toolbar sits inside the Provider */}
        <Toolbar />
        
      </div>

    </ThemeContext.Provider>
  );
}
```

---

#### Gi·∫£i th√≠ch chi ti·∫øt code (Ph√¢n t√≠ch t·ª´ng d√≤ng)

B√¢y gi·ªù ch√∫ng ta s·∫Ω "d·ªãch" code tr√™n sang ng√¥n ng·ªØ th∆∞·ªùng, ph√¢n t√≠ch t·ª´ng th√†nh ph·∫ßn theo: **Action (H√†nh ƒë·ªông)**, **Function (H√†m)**, **Variables (Bi·∫øn)**, **Input (ƒê·∫ßu v√†o)**, **Output (ƒê·∫ßu ra)**, **Data Type (Ki·ªÉu d·ªØ li·ªáu)**, v√† **Naming (Quy t·∫Øc ƒë·∫∑t t√™n)**.

---

##### B∆Ø·ªöC 1: Import c√°c c√¥ng c·ª• c·∫ßn thi·∫øt

```javascript
import React, { createContext, useContext, useState } from 'react';
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Gi·∫£i th√≠ch | Naming |
|---|---|---|---|
| `import` | **Action** | H√†nh ƒë·ªông nh·∫≠p (import) c√°c c√¥ng c·ª• t·ª´ th∆∞ vi·ªán React | T·ª´ kh√≥a h·ªá th·ªëng (System Standard) |
| `React` | **Object** | Object ch√≠nh c·ªßa th∆∞ vi·ªán React (√≠t d√πng tr·ª±c ti·∫øp trong code hi·ªán ƒë·∫°i) | T√™n chu·∫©n (System Standard) |
| `createContext` | **Function** | H√†m t·∫°o ra m·ªôt Context (ƒë∆∞·ªùng h·∫ßm) | T√™n chu·∫©n (System Standard) |
| `useContext` | **Hook Function** | Hook ƒë·ªÉ "h√∫t" d·ªØ li·ªáu t·ª´ Context | T√™n chu·∫©n (System Standard) |
| `useState` | **Hook Function** | Hook ƒë·ªÉ t·∫°o State (b·ªô nh·ªõ) | T√™n chu·∫©n (System Standard) |

---

##### B∆Ø·ªöC 2: T·∫°o Context (ƒê∆∞·ªùng h·∫ßm)

```javascript
const ThemeContext = createContext('light');
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `createContext` | **Function** | `'light'` (gi√° tr·ªã m·∫∑c ƒë·ªãnh) | Context Object | Function: Built-in<br>Input: String<br>Output: Context Object | System Standard |
| `'light'` | **Default Value** | N/A | N/A | **String** | Changeable (c√≥ th·ªÉ ƒë·ªïi th√†nh `'dark'` ho·∫∑c gi√° tr·ªã kh√°c) |
| `ThemeContext` | **Variable (Constant)** | N/A | Context Object | **Context Object** | Changeable (PascalCase, n√™n ƒë·∫∑t t√™n theo m·ª•c ƒë√≠ch: `UserContext`, `LanguageContext`) |

**Action (H√†nh ƒë·ªông):**
- T·∫°o m·ªôt "ƒë∆∞·ªùng h·∫ßm" t√™n l√† `ThemeContext`.
- Gi√° tr·ªã m·∫∑c ƒë·ªãnh c·ªßa ƒë∆∞·ªùng h·∫ßm n√†y l√† `'light'` (ch·ªâ d√πng khi kh√¥ng c√≥ Provider bao b·ªçc).

**Mental Model:**
> T∆∞·ªüng t∆∞·ª£ng b·∫°n ƒë√†o m·ªôt c√°i h·∫ßm xuy√™n n√∫i. C√°i h·∫ßm n√†y t√™n l√† `ThemeContext`. N·∫øu kh√¥ng c√≥ ai b∆°m n∆∞·ªõc (Provider) v√†o h·∫ßm, th√¨ m·∫∑c ƒë·ªãnh trong h·∫ßm c√≥ n∆∞·ªõc "light" (√°nh s√°ng).

---

##### B∆Ø·ªöC 3: Component Con - ThemedButton (Ng∆∞·ªùi ti√™u th·ª•)

###### 3.1. Khai b√°o Component

```javascript
function ThemedButton() {
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `ThemedButton` | **Function Component** | `props` (·∫©n, kh√¥ng d√πng) | React Element (JSX) | Function: Component<br>Output: React Element Object | Changeable (PascalCase) |

**Action:** ƒê·ªãnh nghƒ©a m·ªôt Component t√™n `ThemedButton` (N√∫t c√≥ ch·ªß ƒë·ªÅ).

---

###### 3.2. H√∫t d·ªØ li·ªáu t·ª´ Context

```javascript
const theme = useContext(ThemeContext);
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `useContext` | **Hook Function** | `ThemeContext` (Context Object) | Gi√° tr·ªã hi·ªán t·∫°i trong Context | Function: Built-in Hook<br>Input: Context Object<br>Output: **String** (`'light'` ho·∫∑c `'dark'`) | System Standard |
| `ThemeContext` | **Input (Context Object)** | N/A | N/A | **Context Object** | ƒê√£ ƒë·ªãnh nghƒ©a ·ªü B∆∞·ªõc 2 |
| `theme` | **Variable (Constant)** | N/A | Gi√° tr·ªã t·ª´ Context | **String** | Changeable (camelCase, n√™n ƒë·∫∑t theo √Ω nghƒ©a: `currentTheme`, `mode`) |

**Action:** "H√∫t" gi√° tr·ªã hi·ªán t·∫°i t·ª´ ƒë∆∞·ªùng h·∫ßm `ThemeContext` v√† l∆∞u v√†o bi·∫øn `theme`.

**Mental Model:**
> Component n√†y c·∫Øm m·ªôt c√°i ·ªëng h√∫t v√†o ƒë∆∞·ªùng h·∫ßm `ThemeContext` v√† h√∫t n∆∞·ªõc ra. N∆∞·ªõc h√∫t ƒë∆∞·ª£c (gi√° tr·ªã) ƒë∆∞·ª£c ƒë·ªï v√†o c√°i ly t√™n `theme`.

---

###### 3.3. T·∫°o Object Styles (Ki·ªÉu d√°ng)

```javascript
const styles = {
  backgroundColor: theme === 'dark' ? '#333' : '#FFF',
  color: theme === 'dark' ? '#FFF' : '#000',
  border: '1px solid #ccc',
  padding: '10px 20px',
  borderRadius: '5px',
  cursor: 'pointer',
  marginTop: '10px'
};
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `styles` | **Variable (Constant)** | N/A | Object ch·ª©a CSS properties | **Object** | Changeable (camelCase) |
| `backgroundColor` | **Object Property** | `theme` (String) | String (m√£ m√†u) | **String** | System Standard (CSS property) |
| `theme === 'dark' ? '#333' : '#FFF'` | **Ternary Operator** | `theme` (String) | `'#333'` ho·∫∑c `'#FFF'` | **String** | Logic (Changeable) |

**Action:** T·∫°o m·ªôt Object `styles` ch·ª©a c√°c thu·ªôc t√≠nh CSS. M√†u s·∫Øc thay ƒë·ªïi d·ª±a tr√™n gi√° tr·ªã c·ªßa `theme`.

**Logic:**
- N·∫øu `theme === 'dark'` ‚Üí N·ªÅn ƒëen (`#333`), ch·ªØ tr·∫Øng (`#FFF`)
- N·∫øu `theme === 'light'` ‚Üí N·ªÅn tr·∫Øng (`#FFF`), ch·ªØ ƒëen (`#000`)

---

###### 3.4. Return JSX (Giao di·ªán)

```javascript
return (
  <button style={styles}>
    I am a {theme} button!
  </button>
);
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `return` | **Keyword** | JSX Expression | React Element | Keyword: System<br>Output: React Element Object | System Standard |
| `<button>` | **JSX Element** | N/A | React Element | **React Element** | HTML Standard |
| `style={styles}` | **JSX Prop** | `styles` (Object) | N/A | **Object** | System Standard |
| `{theme}` | **JSX Expression** | `theme` (String) | String hi·ªÉn th·ªã | **String** | Variable t·ª´ B∆∞·ªõc 3.2 |

**Action:** Tr·∫£ v·ªÅ m·ªôt n√∫t b·∫•m (`<button>`) v·ªõi style ƒë·ªông v√† text hi·ªÉn th·ªã gi√° tr·ªã `theme`.

---

##### B∆Ø·ªöC 4: Component Trung gian - Toolbar (Kh√¥ng bi·∫øt g√¨ v·ªÅ theme)

```javascript
function Toolbar() {
  return (
    <div style={{ padding: '20px', border: '1px dashed grey' }}>
      <p>Toolbar Component (I don't know the theme!)</p>
      <ThemedButton /> 
    </div>
  );
}
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `Toolbar` | **Function Component** | `props` (·∫©n, kh√¥ng d√πng) | React Element (JSX) | Function: Component<br>Output: React Element | Changeable (PascalCase) |
| `<ThemedButton />` | **JSX Component** | Kh√¥ng truy·ªÅn props n√†o | React Element | **React Element** | Component t·ª´ B∆∞·ªõc 3 |

**Action:** T·∫°o m·ªôt Component trung gian. Component n√†y **KH√îNG** nh·∫≠n props `theme` t·ª´ cha, nh∆∞ng v·∫´n render ƒë∆∞·ª£c `ThemedButton` (v√¨ `ThemedButton` t·ª± h√∫t d·ªØ li·ªáu t·ª´ Context).

**Mental Model:**
> `Toolbar` gi·ªëng nh∆∞ m·ªôt ng∆∞·ªùi ƒë·ª©ng gi·ªØa. N√≥ kh√¥ng c·∫ßn bi·∫øt "n∆∞·ªõc" (theme) l√† g√¨, n√≥ ch·ªâ c·∫ßn ƒë·∫∑t c√°i ·ªëng (`<ThemedButton />`) v√†o ƒë√∫ng v·ªã tr√≠. C√°i ·ªëng t·ª± h√∫t n∆∞·ªõc t·ª´ ƒë∆∞·ªùng h·∫ßm.

**Gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ Prop Drilling:**
- N·∫øu kh√¥ng c√≥ Context, b·∫°n ph·∫£i l√†m th·∫ø n√†y:
  ```javascript
  // Cha truy·ªÅn cho Toolbar
  <Toolbar theme={theme} />
  
  // Toolbar nh·∫≠n v√† truy·ªÅn ti·∫øp cho ThemedButton
  function Toolbar({ theme }) {
    return <ThemedButton theme={theme} />
  }
  ```
- V·ªõi Context, `Toolbar` **kh√¥ng c·∫ßn** nh·∫≠n v√† truy·ªÅn ti·∫øp `theme` n·ªØa!

---

##### B∆Ø·ªöC 5: Component Cha - App (Ng∆∞·ªùi qu·∫£n l√Ω State)

###### 5.1. Khai b√°o Component

```javascript
export default function App() {
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Data Type | Naming |
|---|---|---|---|
| `export default` | **Keyword** | N/A | System Standard |
| `App` | **Function Component** | Function | Changeable (PascalCase) |

**Action:** ƒê·ªãnh nghƒ©a Component ch√≠nh t√™n `App` v√† export n√≥ l√†m m·∫∑c ƒë·ªãnh.

---

###### 5.2. T·∫°o State (B·ªô nh·ªõ)

```javascript
const [theme, setTheme] = useState('light');
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `useState` | **Hook Function** | `'light'` (gi√° tr·ªã kh·ªüi t·∫°o) | Array `[state, setState]` | Function: Built-in Hook<br>Input: **String**<br>Output: **Array** | System Standard |
| `'light'` | **Initial State** | N/A | N/A | **String** | Changeable |
| `theme` | **State Variable** | N/A | Gi√° tr·ªã hi·ªán t·∫°i c·ªßa State | **String** (`'light'` ho·∫∑c `'dark'`) | Changeable (camelCase) |
| `setTheme` | **State Setter Function** | Gi√° tr·ªã m·ªõi (String) ho·∫∑c Updater Function | `undefined` (void) | Function: Setter<br>Input: **String** ho·∫∑c **Function**<br>Output: **void** | System Pattern: `set` + T√™n State (PascalCase) |

**Action:** T·∫°o m·ªôt State t√™n `theme` v·ªõi gi√° tr·ªã ban ƒë·∫ßu l√† `'light'`. H√†m `setTheme` d√πng ƒë·ªÉ thay ƒë·ªïi gi√° tr·ªã c·ªßa `theme`.

---

###### 5.3. T·∫°o Handler Function (H√†m x·ª≠ l√Ω s·ª± ki·ªán)

```javascript
const toggleTheme = () => {
  setTheme((prevTheme) => (prevTheme === 'light' ? 'dark' : 'light'));
};
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `toggleTheme` | **Handler Function** | N/A (kh√¥ng nh·∫≠n tham s·ªë) | `undefined` (void) | Function: Event Handler<br>Output: **void** | Changeable (camelCase, pattern: `handle` + Action ho·∫∑c `toggle` + Noun) |
| `setTheme` | **Function Call** | Updater Function | `undefined` | Function: Setter | T·ª´ B∆∞·ªõc 5.2 |
| `(prevTheme) => (...)` | **Updater Function** | `prevTheme` (gi√° tr·ªã State hi·ªán t·∫°i) | Gi√° tr·ªã State m·ªõi | Function: Arrow Function<br>Input: **String**<br>Output: **String** | Pattern: `prev` + T√™n State |
| `prevTheme` | **Parameter** | N/A | N/A | **String** | Pattern chu·∫©n (Changeable: `prev`, `old`, `current`) |
| `prevTheme === 'light' ? 'dark' : 'light'` | **Ternary Operator** | `prevTheme` (String) | `'dark'` ho·∫∑c `'light'` | **String** | Logic |

**Action:** T·∫°o m·ªôt h√†m `toggleTheme` ƒë·ªÉ ƒë·∫£o ng∆∞·ª£c gi√° tr·ªã c·ªßa `theme`:
- N·∫øu ƒëang l√† `'light'` ‚Üí ƒê·ªïi th√†nh `'dark'`
- N·∫øu ƒëang l√† `'dark'` ‚Üí ƒê·ªïi th√†nh `'light'`

**T·∫°i sao d√πng Updater Function `(prevTheme) => ...`?**
> V√¨ gi√° tr·ªã m·ªõi (`'dark'` ho·∫∑c `'light'`) ph·ª• thu·ªôc v√†o gi√° tr·ªã c≈©. D√πng Updater Function ƒë·∫£m b·∫£o React lu√¥n l·∫•y gi√° tr·ªã State m·ªõi nh·∫•t (tr√°nh bug khi State c·∫≠p nh·∫≠t b·∫•t ƒë·ªìng b·ªô).

---

###### 5.4. Return JSX v·ªõi Provider

```javascript
return (
  <ThemeContext.Provider value={theme}>
    <div style={{ padding: '20px', textAlign: 'center' }}>
      <h1>useContext Example</h1>
      
      <button onClick={toggleTheme} style={{ marginBottom: '20px' }}>
        Toggle Theme
      </button>

      <Toolbar />
    </div>
  </ThemeContext.Provider>
);
```

| Th√†nh ph·∫ßn | Ph√¢n lo·∫°i | Input | Output | Data Type | Naming |
|---|---|---|---|---|---|
| `<ThemeContext.Provider>` | **JSX Component** | `value` prop | React Element | **React Element** | System Pattern: `ContextName.Provider` |
| `value={theme}` | **JSX Prop** | `theme` (String) | N/A | **String** | System Standard (prop name: `value`) |
| `onClick={toggleTheme}` | **JSX Event Prop** | `toggleTheme` (Function) | N/A | **Function** | System Standard (event: `onClick`) |
| `<Toolbar />` | **JSX Component** | Kh√¥ng c√≥ props | React Element | **React Element** | Component t·ª´ B∆∞·ªõc 4 |

**Action:**
1. **B·ªçc to√†n b·ªô UI** trong `<ThemeContext.Provider>` ‚Üí T·∫°o "ƒë∆∞·ªùng h·∫ßm" v√† b∆°m gi√° tr·ªã `theme` v√†o.
2. **T·∫°o n√∫t "Toggle Theme"** ‚Üí Khi click, g·ªçi h√†m `toggleTheme` ƒë·ªÉ ƒë·ªïi theme.
3. **Render `<Toolbar />`** ‚Üí Component n√†y s·∫Ω render `<ThemedButton />`, v√† `ThemedButton` s·∫Ω t·ª± ƒë·ªông nh·∫≠n gi√° tr·ªã `theme` t·ª´ Context.

**Mental Model:**
> Component `App` gi·ªëng nh∆∞ m·ªôt tr·∫°m b∆°m n∆∞·ªõc. N√≥ b∆°m n∆∞·ªõc (gi√° tr·ªã `theme`) v√†o ƒë∆∞·ªùng h·∫ßm (`ThemeContext.Provider`). B·∫•t k·ª≥ ai ·ªü b√™n trong ƒë∆∞·ªùng h·∫ßm (b√™n trong `<ThemeContext.Provider>`) ƒë·ªÅu c√≥ th·ªÉ c·∫Øm ·ªëng h√∫t (`useContext`) ƒë·ªÉ l·∫•y n∆∞·ªõc.

---

#### T·ªïng k·∫øt lu·ªìng d·ªØ li·ªáu (Data Flow)

```
1. User click n√∫t "Toggle Theme"
   ‚Üì
2. G·ªçi h√†m toggleTheme()
   ‚Üì
3. G·ªçi setTheme() ‚Üí State 'theme' thay ƒë·ªïi t·ª´ 'light' ‚Üí 'dark'
   ‚Üì
4. React render l·∫°i Component App
   ‚Üì
5. Provider nh·∫≠n gi√° tr·ªã m·ªõi: <ThemeContext.Provider value="dark">
   ‚Üì
6. Component ThemedButton (·ªü s√¢u b√™n trong) g·ªçi useContext(ThemeContext)
   ‚Üì
7. useContext tr·∫£ v·ªÅ gi√° tr·ªã m·ªõi: "dark"
   ‚Üì
8. ThemedButton render l·∫°i v·ªõi style m·ªõi (n·ªÅn ƒëen, ch·ªØ tr·∫Øng)
```

**ƒêi·ªÉm quan tr·ªçng:**
- `Toolbar` **KH√îNG** b·ªã render l·∫°i (v√¨ kh√¥ng d√πng `theme`).
- Ch·ªâ `ThemedButton` render l·∫°i (v√¨ n√≥ subscribe v√†o Context qua `useContext`).

---

#### B·∫£ng t·ªïng h·ª£p Data Types

| Bi·∫øn/H√†m | Ki·ªÉu d·ªØ li·ªáu (Data Type) | C√≥ th·ªÉ ƒë·ªïi t√™n? |
|---|---|---|
| `ThemeContext` | **Context Object** | ‚úÖ C√≥ (PascalCase) |
| `theme` (trong `App`) | **String** (`'light'` \| `'dark'`) | ‚úÖ C√≥ (camelCase) |
| `setTheme` | **Function** (Setter) | ‚úÖ C√≥ (pattern: `set` + T√™n) |
| `toggleTheme` | **Function** (Handler) | ‚úÖ C√≥ (camelCase) |
| `theme` (trong `ThemedButton`) | **String** (`'light'` \| `'dark'`) | ‚úÖ C√≥ (camelCase) |
| `styles` | **Object** (CSS properties) | ‚úÖ C√≥ (camelCase) |
| `prevTheme` | **String** (tham s·ªë c·ªßa Updater Function) | ‚úÖ C√≥ (pattern: `prev` + T√™n) |
| `createContext` | **Function** (Built-in) | ‚ùå Kh√¥ng (System Standard) |
| `useContext` | **Hook Function** (Built-in) | ‚ùå Kh√¥ng (System Standard) |
| `useState` | **Hook Function** (Built-in) | ‚ùå Kh√¥ng (System Standard) |

---

### 3. Custom Hooks: V≈© kh√≠ c·ªßa chuy√™n gia

ƒê·∫øn l√∫c n√†y, b·∫°n th·∫•y Component b·∫Øt ƒë·∫ßu ph√¨nh to v√¨ ch·ª©a qu√° nhi·ªÅu logic (State, Effect, Handler...). L√†m sao ƒë·ªÉ t√°i s·ª≠ d·ª•ng logic n√†y cho component kh√°c?

Gi·∫£i ph√°p: Custom Hooks.

Custom Hook th·ª±c ch·∫•t l√† m·ªôt h√†m Javascript b√¨nh th∆∞·ªùng nh∆∞ng c√≥ th·ªÉ g·ªçi c√°c Hook kh√°c (useState, useEffect).

**Quy ∆∞·ªõc:** T√™n h√†m b·∫Øt bu·ªôc b·∫Øt ƒë·∫ßu b·∫±ng `use...` (v√≠ d·ª•: `useWindowSize`, `useFetch`, `useAuth`).

**V√≠ d·ª•:** T√°ch logic ƒë·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c ·ªü Module 3 ra ƒë·ªÉ t√°i s·ª≠ d·ª•ng.

```javascript
// File: useCountdown.js
function useCountdown(startValue) {
  const [count, setCount] = useState(startValue);

  useEffect(() => {
    const id = setInterval(() => {
       setCount(c => c > 0 ? c - 1 : 0);
    }, 1000);
    return () => clearInterval(id);
  }, []);

  return count; // Tr·∫£ v·ªÅ d·ªØ li·ªáu c·∫ßn thi·∫øt
}

// File: App.js (Component gi·ªù ƒë√¢y c·ª±c g·ªçn)
function App() {
  const count = useCountdown(10); // G·ªçi 1 d√≤ng l√† xong
  return <h1>{count}</h1>;
}
```

### 4. B√†i t·∫≠p th·ª±c h√†nh (Module 4)

**B√†i to√°n:** Chuy·ªÉn ƒë·ªïi ti·ªÅn t·ªá (Currency Converter).

1. C√≥ 2 √¥ input: USD v√† VND.
    
2. Nh·∫≠p v√†o √¥ USD -> √î VND t·ª± nh·∫£y s·ªë (nh√¢n 24000).
    
3. Nh·∫≠p v√†o √¥ VND -> √î USD t·ª± nh·∫£y s·ªë (chia 24000).
    

**G·ª£i √Ω gi·∫£i (Lifting State Up):**

- ƒê·ª´ng ƒë·ªÉ m·ªói √¥ input t·ª± gi·ªØ state c·ªßa m√¨nh.
    
- H√£y ƒë·ªÉ component cha gi·ªØ 2 state: `amount` (s·ªë ti·ªÅn) v√† `currency` (ƒë∆°n v·ªã v·ª´a nh·∫≠p).
    
- T√≠nh to√°n gi√° tr·ªã quy ƒë·ªïi ngay trong l√∫c render (Derived State), kh√¥ng c·∫ßn l∆∞u 2 state ti·ªÅn ri√™ng bi·ªát.
    

## PH·∫¶N 6: T√ÄI LI·ªÜU CHI TI·∫æT - MODULE 5: HI·ªÜU NƒÇNG V√Ä H·ªÜ SINH TH√ÅI (ADVANCED)

Khi ·ª©ng d·ª•ng ƒë√£ ch·∫°y ƒë√∫ng, b∆∞·ªõc ti·∫øp theo l√† ch·∫°y **nhanh** v√† **m∆∞·ª£t**.

### 1. Performance: Ngh·ªá thu·∫≠t c·ªßa vi·ªác "L∆∞·ªùi bi·∫øng"

React m·∫∑c ƒë·ªãnh r·∫•t "chƒÉm ch·ªâ": Khi cha render, t·∫•t c·∫£ con c√°i ƒë·ªÅu render l·∫°i theo, d√π d·ªØ li·ªáu c·ªßa con kh√¥ng ƒë·ªïi. ƒêi·ªÅu n√†y an to√†n nh∆∞ng t·ªën k√©m.

#### 1.1. React.memo: Chi·∫øc khi√™n b·∫£o v·ªá

D√πng ƒë·ªÉ bao b·ªçc Component con. N√≥ s·∫Ω ch·∫∑n l·∫°i vi·ªác render n·∫øu `props` ƒë·∫ßu v√†o kh√¥ng thay ƒë·ªïi.

```jsx
const Child = React.memo(({ name }) => {
  console.log("Child render"); // Ch·ªâ log khi 'name' thay ƒë·ªïi
  return <div>{name}</div>;
});
```

#### 1.2. useMemo & useCallback: B·ªô nh·ªõ ƒë·ªám (Cache)

- **`useMemo`:** Cache **gi√° tr·ªã** t√≠nh to√°n (tr√°nh t√≠nh l·∫°i 1 + 1 = 2 m·ªói l·∫ßn render).
    
- **`useCallback`:** Cache **h√†m** (tr√°nh t·∫°o ra h√†m m·ªõi m·ªói l·∫ßn render, gi√∫p `React.memo` ·ªü con ho·∫°t ƒë·ªông ƒë√∫ng).
    

> **L·ªùi khuy√™n:** ƒê·ª´ng t·ªëi ∆∞u s·ªõm (Premature Optimization). Ch·ªâ d√πng khi th·∫•y ch·∫≠m ho·∫∑c component qu√° n·∫∑ng.

### 2. Forms: Giao ti·∫øp v·ªõi ng∆∞·ªùi d√πng

Forms (Bi·ªÉu m·∫´u) l√† c√°ch ch√≠nh ƒë·ªÉ thu th·∫≠p d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. Trong React, c√≥ 2 tri·∫øt l√Ω x·ª≠ l√Ω form ho√†n to√†n kh√°c nhau.

---

#### Mental Model: Puppet vs Independent Actor

H√£y t∆∞·ªüng t∆∞·ª£ng m·ªôt √¥ input nh∆∞ m·ªôt **di·ªÖn vi√™n** tr√™n s√¢n kh·∫•u:

| Lo·∫°i | ·∫®n d·ª• | Ai quy·∫øt ƒë·ªãnh gi√° tr·ªã? | Khi n√†o l·∫•y d·ªØ li·ªáu? |
|---|---|---|---|
| **Controlled** | **Con r·ªëi** (Puppet) | React (State) | M·ªçi l√∫c (real-time) |
| **Uncontrolled** | **Di·ªÖn vi√™n ƒë·ªôc l·∫≠p** | DOM (Browser) | Khi c·∫ßn (on-demand) |

**Controlled Component:** React c·∫ßm d√¢y ƒëi·ªÅu khi·ªÉn con r·ªëi. M·ªói k√Ω t·ª± ng∆∞·ªùi d√πng g√µ ‚Üí React c·∫≠p nh·∫≠t State ‚Üí State ƒë·∫©y gi√° tr·ªã m·ªõi xu·ªëng input. React lu√¥n bi·∫øt input ƒëang ch·ª©a g√¨.

**Uncontrolled Component:** Di·ªÖn vi√™n t·ª± do di·ªÖn. React kh√¥ng quan t√¢m input ƒëang ch·ª©a g√¨ cho ƒë·∫øn khi c·∫ßn (v√≠ d·ª•: khi submit form), l√∫c ƒë√≥ m·ªõi "h·ªèi" DOM.

---

#### 2.1. Controlled Component (Khuy√™n d√πng)

**ƒê·ªãnh nghƒ©a:** React n·∫Øm quy·ªÅn ki·ªÉm so√°t ho√†n to√†n. D·ªØ li·ªáu trong input lu√¥n ƒë·ªìng b·ªô v·ªõi State.

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ **Single Source of Truth:** State l√† ngu·ªìn s·ª± th·∫≠t duy nh·∫•t.
- ‚úÖ **Validation real-time:** Ki·ªÉm tra l·ªói ngay khi g√µ.
- ‚úÖ **D·ªÖ debug:** B·∫°n lu√¥n bi·∫øt gi√° tr·ªã hi·ªán t·∫°i trong State.
- ‚ùå **Verbose:** C·∫ßn vi·∫øt nhi·ªÅu code h∆°n (m·ªói input c·∫ßn 1 state + 1 handler).

**C∆° ch·∫ø ho·∫°t ƒë·ªông:**

```
User g√µ "A" ‚Üí onChange k√≠ch ho·∫°t ‚Üí setState("A") ‚Üí Re-render ‚Üí Input hi·ªÉn th·ªã "A"
```

**Quy t·∫Øc v√†ng:** Input **PH·∫¢I** c√≥ c·∫£ 2 props:
1. `value={state}` - Kh√≥a gi√° tr·ªã v√†o State
2. `onChange={handler}` - C·∫≠p nh·∫≠t State khi user g√µ

##### V√≠ d·ª• 1: Input ƒë∆°n gi·∫£n

```jsx
import { useState } from 'react';

function NameForm() {
  const [name, setName] = useState("");

  return (
    <div>
      <input 
        type="text"
        value={name}  // Gi√° tr·ªã lu√¥n ƒë·ªìng b·ªô v·ªõi state
        onChange={(e) => setName(e.target.value)}  // C·∫≠p nh·∫≠t state m·ªói l·∫ßn g√µ
        placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n"
      />
      <p>B·∫°n ƒëang g√µ: {name}</p>  {/* Real-time display */}
    </div>
  );
}
```

**Gi·∫£i th√≠ch:**
- `e.target.value`: L·∫•y gi√° tr·ªã hi·ªán t·∫°i c·ªßa input t·ª´ s·ª± ki·ªán `onChange`.
- M·ªói l·∫ßn g√µ ‚Üí `setName` c·∫≠p nh·∫≠t state ‚Üí Component re-render ‚Üí Input hi·ªÉn th·ªã gi√° tr·ªã m·ªõi.

##### V√≠ d·ª• 2: Form ƒë·∫ßy ƒë·ªß v·ªõi validation

```jsx
import { useState } from 'react';

function RegistrationForm() {
  // State cho t·ª´ng field
  const [formData, setFormData] = useState({
    username: "",
    email: "",
    password: "",
    age: "",
    gender: "male",
    agreeTerms: false
  });

  // State cho errors
  const [errors, setErrors] = useState({});

  // Handler chung cho t·∫•t c·∫£ text inputs
  const handleChange = (e) => {
    const { name, value, type, checked } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: type === 'checkbox' ? checked : value
    }));
  };

  // Validation function
  const validate = () => {
    const newErrors = {};
    
    if (formData.username.length < 3) {
      newErrors.username = "T√™n ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±";
    }
    
    if (!formData.email.includes('@')) {
      newErrors.email = "Email kh√¥ng h·ª£p l·ªá";
    }
    
    if (formData.password.length < 6) {
      newErrors.password = "M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±";
    }
    
    if (formData.age && (formData.age < 18 || formData.age > 100)) {
      newErrors.age = "Tu·ªïi ph·∫£i t·ª´ 18-100";
    }
    
    if (!formData.agreeTerms) {
      newErrors.agreeTerms = "B·∫°n ph·∫£i ƒë·ªìng √Ω ƒëi·ªÅu kho·∫£n";
    }
    
    return newErrors;
  };

  const handleSubmit = (e) => {
    e.preventDefault();  // NgƒÉn tr√¨nh duy·ªát reload trang
    
    const validationErrors = validate();
    
    if (Object.keys(validationErrors).length > 0) {
      setErrors(validationErrors);
      return;
    }
    
    // Submit th√†nh c√¥ng
    console.log("Form data:", formData);
    alert("ƒêƒÉng k√Ω th√†nh c√¥ng!");
    setErrors({});
  };

  return (
    <form onSubmit={handleSubmit} style={{ maxWidth: '400px', margin: '0 auto' }}>
      <h2>ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
      
      {/* Text Input */}
      <div style={{ marginBottom: '15px' }}>
        <label>T√™n ƒëƒÉng nh·∫≠p:</label>
        <input
          type="text"
          name="username"
          value={formData.username}
          onChange={handleChange}
          style={{ width: '100%', padding: '8px' }}
        />
        {errors.username && <p style={{ color: 'red', fontSize: '12px' }}>{errors.username}</p>}
      </div>

      {/* Email Input */}
      <div style={{ marginBottom: '15px' }}>
        <label>Email:</label>
        <input
          type="email"
          name="email"
          value={formData.email}
          onChange={handleChange}
          style={{ width: '100%', padding: '8px' }}
        />
        {errors.email && <p style={{ color: 'red', fontSize: '12px' }}>{errors.email}</p>}
      </div>

      {/* Password Input */}
      <div style={{ marginBottom: '15px' }}>
        <label>M·∫≠t kh·∫©u:</label>
        <input
          type="password"
          name="password"
          value={formData.password}
          onChange={handleChange}
          style={{ width: '100%', padding: '8px' }}
        />
        {errors.password && <p style={{ color: 'red', fontSize: '12px' }}>{errors.password}</p>}
      </div>

      {/* Number Input */}
      <div style={{ marginBottom: '15px' }}>
        <label>Tu·ªïi:</label>
        <input
          type="number"
          name="age"
          value={formData.age}
          onChange={handleChange}
          style={{ width: '100%', padding: '8px' }}
        />
        {errors.age && <p style={{ color: 'red', fontSize: '12px' }}>{errors.age}</p>}
      </div>

      {/* Select/Dropdown */}
      <div style={{ marginBottom: '15px' }}>
        <label>Gi·ªõi t√≠nh:</label>
        <select
          name="gender"
          value={formData.gender}
          onChange={handleChange}
          style={{ width: '100%', padding: '8px' }}
        >
          <option value="male">Nam</option>
          <option value="female">N·ªØ</option>
          <option value="other">Kh√°c</option>
        </select>
      </div>

      {/* Checkbox */}
      <div style={{ marginBottom: '15px' }}>
        <label>
          <input
            type="checkbox"
            name="agreeTerms"
            checked={formData.agreeTerms}
            onChange={handleChange}
          />
          {' '}T√¥i ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n
        </label>
        {errors.agreeTerms && <p style={{ color: 'red', fontSize: '12px' }}>{errors.agreeTerms}</p>}
      </div>

      <button type="submit" style={{ padding: '10px 20px', cursor: 'pointer' }}>
        ƒêƒÉng k√Ω
      </button>

      {/* Debug: Hi·ªÉn th·ªã state hi·ªán t·∫°i */}
      <pre style={{ marginTop: '20px', background: '#f4f4f4', padding: '10px' }}>
        {JSON.stringify(formData, null, 2)}
      </pre>
    </form>
  );
}

export default RegistrationForm;
```

**K·ªπ thu·∫≠t n√¢ng cao trong v√≠ d·ª•:**

1. **Computed Property Name:** `[name]: value` - D√πng gi√° tr·ªã c·ªßa bi·∫øn `name` l√†m key c·ªßa object.
2. **Single Handler:** M·ªôt h√†m `handleChange` x·ª≠ l√Ω t·∫•t c·∫£ inputs thay v√¨ vi·∫øt ri√™ng t·ª´ng h√†m.
3. **Conditional Logic:** X·ª≠ l√Ω checkbox kh√°c v·ªõi text input (`checked` vs `value`).
4. **Real-time Validation:** C√≥ th·ªÉ th√™m validation ngay trong `handleChange` ƒë·ªÉ hi·ªÉn th·ªã l·ªói khi g√µ.

---

#### 2.2. Uncontrolled Component

**ƒê·ªãnh nghƒ©a:** DOM (tr√¨nh duy·ªát) gi·ªØ d·ªØ li·ªáu. React ch·ªâ "h·ªèi" DOM khi c·∫ßn (th∆∞·ªùng l√† khi submit).

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ **√çt code h∆°n:** Kh√¥ng c·∫ßn state cho m·ªói input.
- ‚úÖ **T√≠ch h·ª£p d·ªÖ v·ªõi th∆∞ vi·ªán non-React:** V√≠ d·ª•: jQuery plugins.
- ‚úÖ **Performance t·ªët h∆°n:** Kh√¥ng re-render m·ªói l·∫ßn g√µ.
- ‚ùå **Kh√≥ validate real-time:** Ph·∫£i ƒë·ª£i ƒë·∫øn khi submit.
- ‚ùå **Kh√≥ debug:** Kh√¥ng bi·∫øt gi√° tr·ªã hi·ªán t·∫°i cho ƒë·∫øn khi "h·ªèi" DOM.

**C∆° ch·∫ø ho·∫°t ƒë·ªông:**

```
User g√µ "A" ‚Üí DOM t·ª± l∆∞u "A" ‚Üí React kh√¥ng bi·∫øt g√¨ ‚Üí Submit ‚Üí useRef.current.value l·∫•y "A"
```

##### V√≠ d·ª• 1: Form ƒë∆°n gi·∫£n v·ªõi useRef

```jsx
import { useRef } from 'react';

function UncontrolledForm() {
  // T·∫°o ref ƒë·ªÉ "tr·ªè" ƒë·∫øn DOM element
  const nameRef = useRef(null);
  const emailRef = useRef(null);

  const handleSubmit = (e) => {
    e.preventDefault();
    
    // L·∫•y gi√° tr·ªã t·ª´ DOM khi submit
    const name = nameRef.current.value;
    const email = emailRef.current.value;
    
    console.log("Submitted:", { name, email });
    alert(`Xin ch√†o ${name}!`);
  };

  return (
    <form onSubmit={handleSubmit}>
      <div>
        <label>T√™n:</label>
        <input 
          type="text" 
          ref={nameRef}  // G·∫Øn ref v√†o input
          defaultValue="Nguy·ªÖn VƒÉn A"  // Gi√° tr·ªã m·∫∑c ƒë·ªãnh (kh√¥ng ph·∫£i value)
        />
      </div>
      
      <div>
        <label>Email:</label>
        <input 
          type="email" 
          ref={emailRef}
        />
      </div>
      
      <button type="submit">G·ª≠i</button>
    </form>
  );
}
```

**L∆∞u √Ω quan tr·ªçng:**
- D√πng `defaultValue` thay v√¨ `value` (v√¨ kh√¥ng c√≥ state ƒë·ªÉ ƒë·ªìng b·ªô).
- D√πng `ref={nameRef}` ƒë·ªÉ t·∫°o "c·∫ßu n·ªëi" ƒë·∫øn DOM element.
- Ch·ªâ ƒë·ªçc gi√° tr·ªã khi c·∫ßn: `nameRef.current.value`.

##### V√≠ d·ª• 2: File Upload (Use case ƒëi·ªÉn h√¨nh)

```jsx
import { useRef } from 'react';

function FileUploadForm() {
  const fileInputRef = useRef(null);

  const handleSubmit = (e) => {
    e.preventDefault();
    
    // L·∫•y file t·ª´ input
    const file = fileInputRef.current.files[0];
    
    if (file) {
      console.log("File name:", file.name);
      console.log("File size:", file.size, "bytes");
      console.log("File type:", file.type);
      
      // Th·ª±c t·∫ø: Upload file l√™n server
      // uploadToServer(file);
    } else {
      alert("Vui l√≤ng ch·ªçn file!");
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input 
        type="file" 
        ref={fileInputRef}
        accept="image/*"  // Ch·ªâ ch·∫•p nh·∫≠n ·∫£nh
      />
      <button type="submit">Upload</button>
    </form>
  );
}
```

**T·∫°i sao file input ph·∫£i d√πng Uncontrolled?**
- V√¨ l√Ω do b·∫£o m·∫≠t, JavaScript **kh√¥ng th·ªÉ** set gi√° tr·ªã cho `<input type="file">`.
- B·∫°n kh√¥ng th·ªÉ l√†m `<input type="file" value={someFile} />` ‚Üí L·ªói!
- Ch·ªâ c√≥ th·ªÉ **ƒë·ªçc** file sau khi user ch·ªçn.

---

#### So s√°nh Controlled vs Uncontrolled

| Ti√™u ch√≠ | Controlled | Uncontrolled |
|---|---|---|
| **Ngu·ªìn s·ª± th·∫≠t** | React State | DOM |
| **C√∫ ph√°p** | `value={state}` + `onChange` | `ref={myRef}` + `defaultValue` |
| **Khi n√†o l·∫•y d·ªØ li·ªáu?** | M·ªçi l√∫c (real-time) | Khi c·∫ßn (on-demand) |
| **Validation** | ‚úÖ Real-time d·ªÖ d√†ng | ‚ùå Ch·ªâ khi submit |
| **Re-render** | M·ªói l·∫ßn g√µ | Kh√¥ng re-render |
| **Code l∆∞·ª£ng** | Nhi·ªÅu h∆°n | √çt h∆°n |
| **Use case** | Form ph·ª©c t·∫°p, c·∫ßn validation | Form ƒë∆°n gi·∫£n, file upload |

---

#### Khi n√†o d√πng c√°i n√†o?

**D√πng Controlled Component khi:**
- ‚úÖ C·∫ßn validation real-time (hi·ªÉn th·ªã l·ªói ngay khi g√µ).
- ‚úÖ C·∫ßn disable/enable n√∫t submit d·ª±a tr√™n gi√° tr·ªã input.
- ‚úÖ C·∫ßn format input (v√≠ d·ª•: t·ª± ƒë·ªông th√™m d·∫•u ph·∫©y v√†o s·ªë ti·ªÅn).
- ‚úÖ C·∫ßn ƒë·ªìng b·ªô nhi·ªÅu inputs (v√≠ d·ª•: password v√† confirm password).
- ‚úÖ Form c√≥ logic ph·ª©c t·∫°p.

**D√πng Uncontrolled Component khi:**
- ‚úÖ Form c·ª±c k·ª≥ ƒë∆°n gi·∫£n (1-2 inputs).
- ‚úÖ File upload (b·∫Øt bu·ªôc).
- ‚úÖ T√≠ch h·ª£p v·ªõi th∆∞ vi·ªán non-React.
- ‚úÖ C·∫ßn performance t·ªëi ƒëa (form c√≥ h√†ng trƒÉm inputs).

**Quy t·∫Øc v√†ng:** **M·∫∑c ƒë·ªãnh d√πng Controlled**. Ch·ªâ chuy·ªÉn sang Uncontrolled khi c√≥ l√Ω do r√µ r√†ng.

---

#### L·ªói th∆∞·ªùng g·∫∑p

**‚ùå L·ªói 1: Thi·∫øu onChange**

```jsx
// SAI: Input b·ªã "ƒë√≥ng bƒÉng", kh√¥ng g√µ ƒë∆∞·ª£c
<input value={name} />
```

**L√Ω do:** React kh√≥a gi√° tr·ªã v√†o `name`. Khi g√µ, DOM mu·ªën thay ƒë·ªïi nh∆∞ng React kh√¥ng cho ph√©p (v√¨ kh√¥ng c√≥ `onChange` ƒë·ªÉ c·∫≠p nh·∫≠t state).

**‚úÖ S·ª≠a:**

```jsx
<input value={name} onChange={(e) => setName(e.target.value)} />
```

---

**‚ùå L·ªói 2: D√πng value thay v√¨ defaultValue cho Uncontrolled**

```jsx
// SAI: Tr·ªü th√†nh Controlled nh∆∞ng thi·∫øu onChange
<input ref={myRef} value="Initial" />
```

**‚úÖ S·ª≠a:**

```jsx
<input ref={myRef} defaultValue="Initial" />
```

---

**‚ùå L·ªói 3: Tr·ªôn l·∫´n Controlled v√† Uncontrolled**

```jsx
// SAI: Kh√¥ng th·ªÉ v·ª´a c√≥ value v·ª´a c√≥ ref
<input value={name} ref={myRef} onChange={...} />
```

**Quy t·∫Øc:** Ch·ªçn m·ªôt trong hai, kh√¥ng ƒë∆∞·ª£c tr·ªôn l·∫´n.

### 3. Routing: ·∫¢o thu·∫≠t chuy·ªÉn trang (SPA)

Trong React, ch√∫ng ta x√¢y d·ª±ng **Single Page Application (SPA)**.

- **Web th∆∞·ªùng:** B·∫•m link -> Tr√¨nh duy·ªát t·∫£i trang m·ªõi tr·∫Øng b√≥c -> T·∫£i l·∫°i t·ª´ ƒë·∫ßu.
    
- **React Router:** B·∫•m link -> React ch·ªâ **thay ƒë·ªïi Component** ·ªü gi·ªØa m√†n h√¨nh. Header/Footer gi·ªØ nguy√™n. Kh√¥ng t·∫£i l·∫°i trang.
    

```jsx
import { Routes, Route, Link } from "react-router-dom";

// ƒê·ªãnh nghƒ©a c√°c tuy·∫øn ƒë∆∞·ªùng
<Routes>
  <Route path="/" element={<Home />} />
  <Route path="/about" element={<About />} />
</Routes>

// S·ª≠ d·ª•ng Link thay cho th·∫ª <a>
<Link to="/about">V·ªÅ ch√∫ng t√¥i</Link>
```

---

## PH·∫¶N 7: NEXT.JS - FRAMEWORK REACT PRODUCTION-READY

### Gi·ªõi thi·ªáu: T·∫°i sao c·∫ßn Next.js?

React l√† m·ªôt **th∆∞ vi·ªán** (library) ch·ªâ t·∫≠p trung v√†o UI. Khi x√¢y d·ª±ng ·ª©ng d·ª•ng th·ª±c t·∫ø, b·∫°n c·∫ßn th√™m nhi·ªÅu th·ª©:

| V·∫•n ƒë·ªÅ | React thu·∫ßn | Next.js |
|---|---|---|
| **Routing** | Ph·∫£i c√†i `react-router-dom` | ‚úÖ Built-in, file-based routing |
| **SEO** | ‚ùå K√©m (v√¨ Client-Side Rendering) | ‚úÖ T·ªët (Server-Side Rendering) |
| **Performance** | Ph·∫£i t·ª± t·ªëi ∆∞u | ‚úÖ T·ª± ƒë·ªông t·ªëi ∆∞u (code splitting, image optimization) |
| **API Backend** | Ph·∫£i t·∫°o server ri√™ng | ‚úÖ API Routes built-in |
| **Deployment** | Ph·∫£i config ph·ª©c t·∫°p | ‚úÖ Deploy 1 click v·ªõi Vercel |

> **Mental Model:** N·∫øu React l√† "ƒë·ªông c∆° xe", th√¨ Next.js l√† "c·∫£ chi·∫øc √¥ t√¥ ho√†n ch·ªânh" (c√≥ v√¥ lƒÉng, gh·∫ø ng·ªìi, ƒëi·ªÅu h√≤a...).

---

### 0. Ki·∫øn th·ª©c n·ªÅn t·∫£ng: npm, npx v√† Node.js

Tr∆∞·ªõc khi c√†i ƒë·∫∑t Next.js, b·∫°n c·∫ßn hi·ªÉu m·ªôt s·ªë c√¥ng c·ª• c∆° b·∫£n trong h·ªá sinh th√°i JavaScript/Node.js.

#### 0.1. Node.js l√† g√¨?

**Node.js** l√† m√¥i tr∆∞·ªùng ch·∫°y JavaScript **ngo√†i tr√¨nh duy·ªát** (tr√™n m√°y t√≠nh/server c·ªßa b·∫°n).

**Mental Model:**
- **Tr√¨nh duy·ªát**: Ch·∫°y JavaScript ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi trang web (DOM, events)
- **Node.js**: Ch·∫°y JavaScript ƒë·ªÉ l√†m b·∫•t c·ª© th·ª© g√¨ (ƒë·ªçc file, t·∫°o server, build tools)

**C√†i ƒë·∫∑t Node.js:**
1. Truy c·∫≠p: [nodejs.org](https://nodejs.org)
2. T·∫£i phi√™n b·∫£n LTS (Long Term Support)
3. C√†i ƒë·∫∑t v√† ki·ªÉm tra:

```bash
node --version   # v20.x.x
npm --version    # 10.x.x
```

---

#### 0.2. npm (Node Package Manager)

**npm** l√† c√¥ng c·ª• qu·∫£n l√Ω th∆∞ vi·ªán (packages) cho JavaScript.

**·∫®n d·ª•:** npm gi·ªëng nh∆∞ **App Store** cho code JavaScript.
- B·∫°n mu·ªën d√πng React? ‚Üí `npm install react`
- B·∫°n mu·ªën d√πng Next.js? ‚Üí `npm install next`

##### C√°c l·ªánh npm c∆° b·∫£n:

```bash
# C√†i ƒë·∫∑t package
npm install react          # C√†i React v√†o project hi·ªán t·∫°i
npm install -g vercel      # C√†i global (d√πng ƒë∆∞·ª£c ·ªü m·ªçi n∆°i)

# Ch·∫°y scripts (ƒë·ªãnh nghƒ©a trong package.json)
npm run dev                # Ch·∫°y development server
npm run build              # Build production
npm start                  # Ch·∫°y production server

# Kh√°c
npm init                   # T·∫°o package.json m·ªõi
npm uninstall react        # G·ª° package
```

---

#### 0.3. npx (Node Package Execute)

**npx** cho ph√©p **ch·∫°y** m·ªôt package **m√† kh√¥ng c·∫ßn c√†i ƒë·∫∑t** vƒ©nh vi·ªÖn.

**S·ª± kh√°c bi·ªát:**

| L·ªánh | npm | npx |
|---|---|---|
| **M·ª•c ƒë√≠ch** | C√†i ƒë·∫∑t package | Ch·∫°y package (1 l·∫ßn) |
| **V√≠ d·ª•** | `npm install create-next-app` | `npx create-next-app@latest` |
| **K·∫øt qu·∫£** | Package l∆∞u v√†o `node_modules/` | Ch·∫°y xong ‚Üí X√≥a |

**T·∫°i sao d√πng npx?**
- ‚úÖ Lu√¥n d√πng phi√™n b·∫£n m·ªõi nh·∫•t (`@latest`)
- ‚úÖ Kh√¥ng l√†m "b·∫©n" m√°y t√≠nh (kh√¥ng c√†i ƒë·∫∑t vƒ©nh vi·ªÖn)
- ‚úÖ Ti·∫øt ki·ªám dung l∆∞·ª£ng

**V√≠ d·ª• th·ª±c t·∫ø:**

```bash
# T·∫°o Next.js project (d√πng npx - khuy√™n d√πng)
npx create-next-app@latest my-app

# T∆∞∆°ng ƒë∆∞∆°ng v·ªõi (d√πng npm - c√°ch c≈©):
npm install -g create-next-app   # B∆∞·ªõc 1: C√†i global
create-next-app my-app            # B∆∞·ªõc 2: Ch·∫°y
```

---

#### 0.4. package.json - "H·ªì s∆°" c·ªßa Project

**package.json** l√† file ch·ª©a th√¥ng tin v·ªÅ project: t√™n, phi√™n b·∫£n, dependencies, scripts.

**V√≠ d·ª• package.json c·ªßa Next.js project:**

```json
{
  "name": "my-app",
  "version": "0.1.0",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start"
  },
  "dependencies": {
    "react": "^18.3.0",
    "react-dom": "^18.3.0",
    "next": "15.1.0"
  },
  "devDependencies": {
    "eslint": "^8.57.0"
  }
}
```

**Gi·∫£i th√≠ch:**

| Ph·∫ßn | √ù nghƒ©a | V√≠ d·ª• |
|---|---|---|
| **`name`** | T√™n project | `"my-app"` |
| **`version`** | Phi√™n b·∫£n hi·ªán t·∫°i | `"0.1.0"` |
| **`scripts`** | C√°c l·ªánh shortcut | `npm run dev` ‚Üí ch·∫°y `next dev` |
| **`dependencies`** | Th∆∞ vi·ªán c·∫ßn ƒë·ªÉ ch·∫°y app | React, Next.js |
| **`devDependencies`** | Th∆∞ vi·ªán ch·ªâ c·∫ßn khi develop | ESLint, TypeScript |

**C√°ch ho·∫°t ƒë·ªông:**

1. B·∫°n ch·∫°y `npm install` ‚Üí npm ƒë·ªçc `package.json`
2. npm t·∫£i t·∫•t c·∫£ packages trong `dependencies` v√† `devDependencies`
3. L∆∞u v√†o folder `node_modules/`

---

#### 0.5. node_modules/ v√† .gitignore

**`node_modules/`**: Folder ch·ª©a t·∫•t c·∫£ code c·ªßa c√°c th∆∞ vi·ªán ƒë√£ c√†i.
- ‚ö†Ô∏è R·∫•t n·∫∑ng (c√≥ th·ªÉ 100MB - 1GB)
- ‚ùå **KH√îNG BAO GI·ªú** commit l√™n Git

**`.gitignore`**: File li·ªát k√™ nh·ªØng g√¨ Git n√™n b·ªè qua.

```
# .gitignore
node_modules/
.env.local
.next/
```

**Gi·∫£i th√≠ch chi ti·∫øt:**

##### 1. `.env.local` - File ch·ª©a bi·∫øn m√¥i tr∆∞·ªùng (Environment Variables)

**`.env.local`** l√† file ch·ª©a c√°c **th√¥ng tin nh·∫°y c·∫£m** v√† **c·∫•u h√¨nh ri√™ng** cho m√¥i tr∆∞·ªùng local c·ªßa b·∫°n.

**Mental Model:** `.env.local` gi·ªëng nh∆∞ **k√©t s·∫Øt c√° nh√¢n** - ch·ª©a m·∫≠t kh·∫©u, API keys m√† ch·ªâ b·∫°n bi·∫øt.

**V√≠ d·ª• n·ªôi dung file `.env.local`:**

```
# .env.local
DATABASE_URL=postgresql://user:password@localhost:5432/mydb
NEXT_PUBLIC_API_KEY=abc123xyz789
STRIPE_SECRET_KEY=sk_test_51Hxxx...
EMAIL_PASSWORD=mySecretPassword123
```

**T·∫°i sao KH√îNG ƒë∆∞·ª£c commit `.env.local`?**

- üîí **B·∫£o m·∫≠t:** Ch·ª©a API keys, passwords, database URLs ‚Üí N·∫øu push l√™n GitHub, hacker c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c!
- üë• **Kh√°c nhau gi·ªØa c√°c dev:** M·ªói ng∆∞·ªùi c√≥ database ri√™ng, API key ri√™ng.
- üåç **Kh√°c nhau gi·ªØa m√¥i tr∆∞·ªùng:** Local, staging, production c√≥ config kh√°c nhau.

**C√°ch s·ª≠ d·ª•ng trong Next.js:**

```jsx
// src/app/page.js
export default function Home() {
  // Bi·∫øn c√≥ NEXT_PUBLIC_ ‚Üí C√≥ th·ªÉ d√πng ·ªü browser
  const apiKey = process.env.NEXT_PUBLIC_API_KEY;
  
  // Bi·∫øn KH√îNG c√≥ NEXT_PUBLIC_ ‚Üí Ch·ªâ d√πng ·ªü server
  const secretKey = process.env.STRIPE_SECRET_KEY;
  
  return <div>API Key: {apiKey}</div>;
}
```

**Quy t·∫Øc ƒë·∫∑t t√™n:**
- `NEXT_PUBLIC_*`: Bi·∫øn **c√¥ng khai**, c√≥ th·ªÉ d√πng ·ªü browser (v√≠ d·ª•: Google Maps API key).
- Kh√¥ng c√≥ prefix: Bi·∫øn **b√≠ m·∫≠t**, ch·ªâ d√πng ·ªü server (v√≠ d·ª•: database password).

**Quy tr√¨nh l√†m vi·ªác nh√≥m:**

1. **T·∫°o file m·∫´u** `.env.example` (commit l√™n Git):
   ```
   # .env.example
   DATABASE_URL=your_database_url_here
   NEXT_PUBLIC_API_KEY=your_api_key_here
   ```

2. **M·ªói dev t·ª± t·∫°o** `.env.local` (KH√îNG commit):
   ```
   # .env.local (c·ªßa Dev A)
   DATABASE_URL=postgresql://localhost:5432/dev_a_db
   NEXT_PUBLIC_API_KEY=dev_a_key_123
   ```

3. **Production** d√πng `.env.production` ho·∫∑c config tr√™n hosting (Vercel, Netlify).

---

##### 2. `.next/` - Folder ch·ª©a k·∫øt qu·∫£ build c·ªßa Next.js

**`.next/`** l√† folder ƒë∆∞·ª£c Next.js **t·ª± ƒë·ªông t·∫°o** khi b·∫°n ch·∫°y `npm run dev` ho·∫∑c `npm run build`.

**Mental Model:** `.next/` gi·ªëng nh∆∞ **r√°c th·∫£i c√¥ng nghi·ªáp** - s·∫£n ph·∫©m ph·ª• c·ªßa qu√° tr√¨nh s·∫£n xu·∫•t, c√≥ th·ªÉ t√°i t·∫°o b·∫•t c·ª© l√∫c n√†o.

**N·ªôi dung folder `.next/`:**

```
.next/
‚îú‚îÄ‚îÄ cache/              # Cache ƒë·ªÉ build nhanh h∆°n
‚îú‚îÄ‚îÄ server/             # Code ch·∫°y tr√™n server
‚îú‚îÄ‚îÄ static/             # CSS, JS ƒë√£ ƒë∆∞·ª£c optimize
‚îî‚îÄ‚îÄ build-manifest.json # Th√¥ng tin v·ªÅ build
```

**T·∫°i sao KH√îNG ƒë∆∞·ª£c commit `.next/`?**

- üóëÔ∏è **R·∫•t n·∫∑ng:** C√≥ th·ªÉ l√™n ƒë·∫øn 100MB - 500MB.
- ‚ôªÔ∏è **T√°i t·∫°o ƒë∆∞·ª£c:** Ch·ªâ c·∫ßn ch·∫°y `npm run build` l√† c√≥ l·∫°i.
- üîÑ **Thay ƒë·ªïi li√™n t·ª•c:** M·ªói l·∫ßn build l·∫°i, n·ªôi dung thay ƒë·ªïi ‚Üí Conflict Git li√™n t·ª•c.
- üíª **Kh√°c nhau gi·ªØa m√°y:** Build tr√™n Mac kh√°c build tr√™n Windows.

**C√°ch ho·∫°t ƒë·ªông:**

```
B·∫°n vi·∫øt code ‚Üí Ch·∫°y npm run dev ‚Üí Next.js build code v√†o .next/ ‚Üí Server ch·∫°y t·ª´ .next/
```

**Khi n√†o `.next/` ƒë∆∞·ª£c t·∫°o?**

- ‚úÖ `npm run dev` ‚Üí T·∫°o `.next/` cho development.
- ‚úÖ `npm run build` ‚Üí T·∫°o `.next/` cho production (optimized).
- ‚úÖ T·ª± ƒë·ªông x√≥a v√† t·∫°o l·∫°i m·ªói l·∫ßn build.

**N·∫øu x√≥a `.next/` th√¨ sao?**

- ‚ùå App kh√¥ng ch·∫°y ƒë∆∞·ª£c (v√¨ thi·∫øu code ƒë√£ build).
- ‚úÖ Ch·∫°y l·∫°i `npm run dev` ‚Üí Next.js t·ª± ƒë·ªông t·∫°o l·∫°i `.next/`.

**Quy tr√¨nh l√†m vi·ªác nh√≥m:**

1. **Ng∆∞·ªùi A** commit code ngu·ªìn (kh√¥ng commit `.next/`).
2. **Ng∆∞·ªùi B** clone project ‚Üí Ch·∫°y `npm run dev` ‚Üí Next.js t·ª± ƒë·ªông t·∫°o `.next/` tr√™n m√°y Ng∆∞·ªùi B.

---

**Quy tr√¨nh l√†m vi·ªác nh√≥m:**

1. **Ng∆∞·ªùi A** t·∫°o project ‚Üí Commit `package.json` (kh√¥ng commit `node_modules/`)
2. **Ng∆∞·ªùi B** clone project ‚Üí Ch·∫°y `npm install` ‚Üí npm t·ª± ƒë·ªông t·∫£i `node_modules/`

---

#### 0.6. C√°c c√¥ng c·ª• kh√°c trong setup

##### A. ESLint

**ESLint** l√† c√¥ng c·ª• ki·ªÉm tra l·ªói code t·ª± ƒë·ªông (linter).

**V√≠ d·ª• l·ªói ESLint b·∫Øt ƒë∆∞·ª£c:**
```javascript
const name = "An"  // ‚ùå Thi·∫øu d·∫•u ch·∫•m ph·∫©y
const age = 25;    // ‚úÖ OK
```

**L·ª£i √≠ch:**
- ‚úÖ B·∫Øt l·ªói c√∫ ph√°p tr∆∞·ªõc khi ch·∫°y
- ‚úÖ ƒê·ªìng nh·∫•t code style trong team
- ‚úÖ G·ª£i √Ω best practices

##### B. Tailwind CSS

**Tailwind CSS** l√† CSS framework d√πng **utility classes**.

**So s√°nh:**

```css
/* CSS truy·ªÅn th·ªëng */
.button {
  background-color: blue;
  color: white;
  padding: 10px 20px;
  border-radius: 5px;
}
```

```jsx
{/* Tailwind CSS */}
<button className="bg-blue-500 text-white px-5 py-2 rounded">
  Click me
</button>
```

**∆Øu ƒëi·ªÉm:**
- ‚úÖ Vi·∫øt CSS nhanh h∆°n (kh√¥ng c·∫ßn ƒë·∫∑t t√™n class)
- ‚úÖ Kh√¥ng b·ªã CSS conflict
- ‚úÖ Responsive d·ªÖ d√†ng (`md:`, `lg:`)

##### C. Import Alias (@/)

**V·∫•n ƒë·ªÅ:** Import path d√†i v√† kh√≥ ƒë·ªçc.

```javascript
// ‚ùå Kh√≥ ƒë·ªçc, d·ªÖ sai
import Button from '../../../components/Button';
import { formatDate } from '../../../../lib/utils';
```

**Gi·∫£i ph√°p:** D√πng alias `@/` tr·ªè ƒë·∫øn `src/`.

```javascript
// ‚úÖ D·ªÖ ƒë·ªçc, kh√¥ng sai
import Button from '@/components/Button';
import { formatDate } from '@/lib/utils';
```

**Config (Next.js t·ª± ƒë·ªông setup):**

```json
// tsconfig.json ho·∫∑c jsconfig.json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

---

#### 0.7. T√≥m t·∫Øt

**Tr∆∞·ªõc khi c√†i Next.js, b·∫°n c·∫ßn:**
- ‚úÖ C√†i Node.js (bao g·ªìm npm)
- ‚úÖ Hi·ªÉu `npm install` (c√†i packages)
- ‚úÖ Hi·ªÉu `npx` (ch·∫°y packages 1 l·∫ßn)
- ‚úÖ Hi·ªÉu `package.json` (h·ªì s∆° project)
- ‚úÖ Bi·∫øt `node_modules/` kh√¥ng commit l√™n Git

**Ki·ªÉm tra nhanh:**

```bash
node --version   # Ph·∫£i c√≥ k·∫øt qu·∫£ (v18+)
npm --version    # Ph·∫£i c√≥ k·∫øt qu·∫£ (v9+)
```

N·∫øu c·∫£ hai l·ªánh ƒë·ªÅu ho·∫°t ƒë·ªông ‚Üí B·∫°n ƒë√£ s·∫µn s√†ng c√†i Next.js! üöÄ

---

### 1. C√†i ƒë·∫∑t v√† Kh·ªüi t·∫°o Project

#### T·∫°o project m·ªõi (Next.js 15+)

```bash
npx create-next-app@latest my-app
```

**C√¢u h·ªèi trong qu√° tr√¨nh c√†i ƒë·∫∑t:**

```
‚úî Would you like to use TypeScript? ‚Ä¶ No / Yes
‚úî Would you like to use ESLint? ‚Ä¶ No / Yes
‚úî Would you like to use Tailwind CSS? ‚Ä¶ No / Yes
‚úî Would you like to use `src/` directory? ‚Ä¶ No / Yes
‚úî Would you like to use App Router? (recommended) ‚Ä¶ No / Yes
‚úî Would you like to customize the default import alias (@/*)? ‚Ä¶ No / Yes
```

**Khuy·∫øn ngh·ªã cho ng∆∞·ªùi m·ªõi:**
- TypeScript: **Yes** (n·∫øu ƒë√£ quen) ho·∫∑c **No** (n·∫øu m·ªõi h·ªçc)
- ESLint: **Yes**
- Tailwind CSS: **Yes** (CSS framework ti·ªán l·ª£i)
- **`src/` directory: Yes** (t·ªï ch·ª©c code r√µ r√†ng h∆°n) - _Xem gi·∫£i th√≠ch chi ti·∫øt b√™n d∆∞·ªõi_
- App Router: **Yes** (chu·∫©n m·ªõi, m·∫°nh h∆°n)
- Import alias: **Yes** (d√πng `@/components` thay v√¨ `../../components`)

---

#### Gi·∫£i th√≠ch: `src/` directory l√† g√¨?

ƒê√¢y l√† l·ª±a ch·ªçn v·ªÅ **c·∫•u tr√∫c th∆∞ m·ª•c** cho project Next.js c·ªßa b·∫°n.

##### **Option 1: KH√îNG d√πng `src/` (Root-level)**

```
my-app/
‚îú‚îÄ‚îÄ app/              # Code ·ª©ng d·ª•ng
‚îÇ   ‚îú‚îÄ‚îÄ page.js
‚îÇ   ‚îî‚îÄ‚îÄ layout.js
‚îú‚îÄ‚îÄ components/       # Code ·ª©ng d·ª•ng
‚îú‚îÄ‚îÄ public/           # Static files
‚îú‚îÄ‚îÄ package.json      # Config
‚îú‚îÄ‚îÄ next.config.js    # Config
‚îî‚îÄ‚îÄ README.md         # Config
```

**ƒê·∫∑c ƒëi·ªÉm:**
- Th∆∞ m·ª•c `app/` v√† `components/` n·∫±m **c√πng c·∫•p** v·ªõi c√°c file config (`package.json`, `next.config.js`).
- Code ·ª©ng d·ª•ng v√† config files **tr·ªôn l·∫´n** v·ªõi nhau.

---

##### **Option 2: D√πng `src/` (Recommended)**

```
my-app/
‚îú‚îÄ‚îÄ src/              # ‚Üê T·∫§T C·∫¢ code ·ª©ng d·ª•ng n·∫±m ƒë√¢y
‚îÇ   ‚îú‚îÄ‚îÄ app/          # Routing
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.js
‚îÇ   ‚îú‚îÄ‚îÄ components/   # Components
‚îÇ   ‚îî‚îÄ‚îÄ lib/          # Utilities
‚îú‚îÄ‚îÄ public/           # Static files
‚îú‚îÄ‚îÄ package.json      # Config
‚îú‚îÄ‚îÄ next.config.js    # Config
‚îî‚îÄ‚îÄ README.md         # Config
```

**ƒê·∫∑c ƒëi·ªÉm:**
- Th∆∞ m·ª•c `src/` ch·ª©a **T·∫§T C·∫¢** code ·ª©ng d·ª•ng (`app/`, `components/`, `lib/`).
- Code ·ª©ng d·ª•ng **t√°ch bi·ªát** v·ªõi config files.
- Root directory ch·ªâ ch·ª©a config files v√† `public/`.

---

##### So s√°nh: `src/` vs Root-level

| Ti√™u ch√≠ | Kh√¥ng d√πng `src/` | D√πng `src/` (‚úÖ Khuy√™n d√πng) |
|---|---|---|
| **T·ªï ch·ª©c** | Code v√† config tr·ªôn l·∫´n | Code t√°ch bi·ªát v·ªõi config |
| **D·ªÖ t√¨m file** | ‚ùå Kh√≥ (nhi·ªÅu folder ·ªü root) | ‚úÖ D·ªÖ (ch·ªâ v√†o `src/` l√† th·∫•y code) |
| **Quy ∆∞·ªõc** | √çt ph·ªï bi·∫øn | ‚úÖ Chu·∫©n trong React/Node.js |
| **Khi n√†o d√πng?** | Project nh·ªè, c√° nh√¢n | ‚úÖ Project team, production |

---

##### T·∫°i sao n√™n d√πng `src/`?

**1. T√°ch bi·ªát r√µ r√†ng (Separation of Concerns)**
- **Code ·ª©ng d·ª•ng** (business logic) ‚Üí `src/`
- **Config files** (setup, dependencies) ‚Üí Root

**Mental Model:** T·ªß qu·∫ßn √°o
- `src/` = NgƒÉn ch·ª©a qu·∫ßn √°o (code)
- Root = Nh√£n d√°n b√™n ngo√†i t·ªß (config)

**2. D·ªÖ navigate**
Khi m·ªü project, b·∫°n bi·∫øt ngay:
- Mu·ªën s·ª≠a code ‚Üí V√†o `src/`
- Mu·ªën config ‚Üí Xem root

**3. Quy ∆∞·ªõc chu·∫©n**
H·∫ßu h·∫øt React projects (Create React App, Vite) ƒë·ªÅu d√πng `src/`.

**4. Tr√°nh nh·∫ßm l·∫´n**
Kh√¥ng d√πng `src/`:
```
my-app/
‚îú‚îÄ‚îÄ app/           # ‚Üê Code hay config?
‚îú‚îÄ‚îÄ components/    # ‚Üê Code hay config?
‚îú‚îÄ‚îÄ lib/           # ‚Üê Code hay config?
‚îú‚îÄ‚îÄ public/        # ‚Üê Static files
‚îú‚îÄ‚îÄ package.json   # ‚Üê Config
```

D√πng `src/`:
```
my-app/
‚îú‚îÄ‚îÄ src/           # ‚Üê 100% code ·ªü ƒë√¢y!
‚îú‚îÄ‚îÄ public/        # ‚Üê Static files
‚îú‚îÄ‚îÄ package.json   # ‚Üê Config
```

---

##### Khi n√†o KH√îNG c·∫ßn `src/`?

- ‚úÖ Project c√° nh√¢n, nh·ªè (< 10 files)
- ‚úÖ ƒêang h·ªçc Next.js l·∫ßn ƒë·∫ßu (√≠t folder h∆°n, ƒë∆°n gi·∫£n h∆°n)
- ‚úÖ Mu·ªën setup nhanh, kh√¥ng quan t√¢m c·∫•u tr√∫c

**L∆∞u √Ω:** B·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu kh√¥ng d√πng `src/`, sau n√†y d·ªÖ d√†ng chuy·ªÉn sang d√πng `src/` khi project l·ªõn l√™n.

---

##### T√≥m t·∫Øt

> **Khuy·∫øn ngh·ªã:** Ch·ªçn **Yes** cho `src/` directory n·∫øu b·∫°n l√†m project nghi√™m t√∫c ho·∫∑c l√†m vi·ªác nh√≥m. Ch·ªçn **No** n·∫øu ch·ªâ h·ªçc th·ª≠ ho·∫∑c l√†m project nh·ªè.

**Quy t·∫Øc v√†ng:** Khi nghi ng·ªù, ch·ªçn **Yes** (d√πng `src/`). N√≥ gi√∫p project d·ªÖ maintain h∆°n v·ªÅ l√¢u d√†i.

#### Ch·∫°y development server

```bash
cd my-app
npm run dev
```

M·ªü tr√¨nh duy·ªát: `http://localhost:3000`

---

### 2. C·∫•u tr√∫c th∆∞ m·ª•c (App Router)

```
my-app/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                 # Routing ch√≠nh (m·ªói folder = 1 route)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.js        # Layout chung cho to√†n app
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.js          # Trang ch·ªß (/)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ about/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.js      # Trang /about
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ blog/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ page.js      # Trang /blog
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ [id]/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ page.js  # Dynamic route: /blog/123
‚îÇ   ‚îú‚îÄ‚îÄ components/          # C√°c component t√°i s·ª≠ d·ª•ng
‚îÇ   ‚îî‚îÄ‚îÄ lib/                 # Utility functions, helpers
‚îú‚îÄ‚îÄ public/                  # Static files (images, fonts)
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ next.config.js           # Config Next.js
```

**Quy t·∫Øc v√†ng:**
- **`page.js`**: ƒê·ªãnh nghƒ©a m·ªôt trang (route).
- **`layout.js`**: ƒê·ªãnh nghƒ©a layout bao quanh c√°c trang con.
- **`loading.js`**: UI hi·ªÉn th·ªã khi ƒëang t·∫£i.
- **`error.js`**: UI hi·ªÉn th·ªã khi c√≥ l·ªói.

---

### 3. Server Components vs Client Components

ƒê√¢y l√† **kh√°i ni·ªám m·ªõi nh·∫•t** v√† quan tr·ªçng nh·∫•t c·ªßa Next.js App Router.

#### Mental Model: Nh√† h√†ng

| Lo·∫°i | N∆°i ch·∫°y | ·∫®n d·ª• | Khi n√†o d√πng? |
|---|---|---|---|
| **Server Component** | Server (Node.js) | **B·∫øp** - N·∫•u xong m·ªõi ƒë∆∞a ra | Fetch data, SEO, kh√¥ng c·∫ßn interactivity |
| **Client Component** | Browser (JavaScript) | **B√†n ƒÉn** - Kh√°ch t·ª± ph·ª•c v·ª• | Event handlers, useState, useEffect |

#### 3.1. Server Component (M·∫∑c ƒë·ªãnh)

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ Ch·∫°y tr√™n server, g·ª≠i HTML v·ªÅ browser.
- ‚úÖ C√≥ th·ªÉ truy c·∫≠p database tr·ª±c ti·∫øp.
- ‚úÖ Kh√¥ng tƒÉng bundle size JavaScript cho client.
- ‚ùå **KH√îNG** d√πng ƒë∆∞·ª£c `useState`, `useEffect`, event handlers.

**V√≠ d·ª•: Fetch data t·ª´ API**

```jsx
// src/app/posts/page.js
// ƒê√¢y l√† Server Component (m·∫∑c ƒë·ªãnh, kh√¥ng c·∫ßn khai b√°o g√¨)

async function getPosts() {
  const res = await fetch('https://jsonplaceholder.typicode.com/posts');
  if (!res.ok) throw new Error('Failed to fetch');
  return res.json();
}

export default async function PostsPage() {
  const posts = await getPosts();  // Fetch data tr·ª±c ti·∫øp trong component!

  return (
    <div>
      <h1>Blog Posts</h1>
      <ul>
        {posts.slice(0, 10).map(post => (
          <li key={post.id}>
            <h2>{post.title}</h2>
            <p>{post.body}</p>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

**ƒêi·ªÉm ƒë·∫∑c bi·ªát:**
- Component l√† `async function` - ƒëi·ªÅu n√†y **KH√îNG TH·ªÇ** l√†m trong React thu·∫ßn!
- Fetch data ngay trong component, kh√¥ng c·∫ßn `useEffect`.
- Data ƒë∆∞·ª£c fetch tr√™n server ‚Üí HTML ho√†n ch·ªânh g·ª≠i v·ªÅ browser ‚Üí SEO t·ªët.

---

#### 3.2. Client Component

**Khi n√†o c·∫ßn Client Component?**
- ‚úÖ C·∫ßn `useState`, `useEffect`, `useContext`.
- ‚úÖ C·∫ßn event handlers (`onClick`, `onChange`).
- ‚úÖ C·∫ßn browser APIs (`window`, `localStorage`).
- ‚úÖ C·∫ßn th∆∞ vi·ªán ch·ªâ ch·∫°y tr√™n browser.

**C√°ch khai b√°o:** Th√™m `'use client'` ·ªü ƒë·∫ßu file.

**V√≠ d·ª•: Counter v·ªõi useState**

```jsx
// src/components/Counter.js
'use client';  // B·∫Øt bu·ªôc ph·∫£i c√≥ d√≤ng n√†y!

import { useState } from 'react';

export default function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>
        TƒÉng
      </button>
    </div>
  );
}
```

**Quy t·∫Øc quan tr·ªçng:**
- Server Component c√≥ th·ªÉ import Client Component.
- Client Component **KH√îNG TH·ªÇ** import Server Component.

---

#### 3.3. K·∫øt h·ª£p Server v√† Client Components: S·ª©c m·∫°nh th·ª±c s·ª± c·ªßa Next.js

**C√¢u h·ªèi quan tr·ªçng:** Next.js c√≥ ph·∫£i l√† Server Component hay Client Component?

**Tr·∫£ l·ªùi:** Next.js **KH√îNG PH·∫¢I** ch·ªâ l√† m·ªôt trong hai. N√≥ l√† framework cho ph√©p b·∫°n **k·∫øt h·ª£p c·∫£ hai** m·ªôt c√°ch th√¥ng minh trong c√πng m·ªôt ·ª©ng d·ª•ng.

> **Mental Model: T√≤a nh√†**  
> - **K·∫øt c·∫•u b√™ t√¥ng (Server Components)**: T∆∞·ªùng, s√†n, c·ªôt ‚Üí C·ª©ng, kh√¥ng ƒë·ªïi, x√¢y s·∫µn tr√™n server  
> - **ƒê·ªì n·ªôi th·∫•t (Client Components)**: C·ª≠a, c√¥ng t·∫Øc ƒë√®n, t·ªß l·∫°nh ‚Üí C√≥ th·ªÉ t∆∞∆°ng t√°c, c·∫ßn JavaScript  
> - **Next.js = T√≤a nh√† ho√†n ch·ªânh** (c√≥ c·∫£ k·∫øt c·∫•u v√† n·ªôi th·∫•t)

##### V√≠ d·ª• th·ª±c t·∫ø: Trang Blog Post

M·ªôt trang blog ƒëi·ªÉn h√¨nh s·∫Ω c√≥:
- **N·ªôi dung b√†i vi·∫øt** (Server Component) - Kh√¥ng c·∫ßn JS, SEO t·ªët
- **N√∫t Like** (Client Component) - C·∫ßn `useState` v√† `onClick`
- **Form Comment** (Client Component) - C·∫ßn `useState` cho input

**Code minh h·ªça:**

```jsx
// src/app/blog/[id]/page.js
// ƒê√ÇY L√Ä SERVER COMPONENT (m·∫∑c ƒë·ªãnh)

import CommentForm from '@/components/CommentForm';  // Client Component
import LikeButton from '@/components/LikeButton';    // Client Component

// Fetch data tr√™n server (SEO t·ªët, nhanh)
async function getPost(id) {
  const res = await fetch(`https://api.example.com/posts/${id}`);
  if (!res.ok) throw new Error('Post not found');
  return res.json();
}

export default async function BlogPostPage({ params }) {
  const post = await getPost(params.id);  // Server-side fetch

  return (
    <article>
      {/* ===== PH·∫¶N SERVER COMPONENT ===== */}
      {/* Kh√¥ng c·∫ßn JS, SEO t·ªët, load nhanh */}
      <h1>{post.title}</h1>
      <p className="author">By {post.author}</p>
      <p className="date">{new Date(post.createdAt).toLocaleDateString('vi-VN')}</p>
      <div dangerouslySetInnerHTML={{ __html: post.content }} />
      
      {/* ===== PH·∫¶N CLIENT COMPONENT ===== */}
      {/* C·∫ßn t∆∞∆°ng t√°c, d√πng useState */}
      <LikeButton postId={post.id} initialLikes={post.likes} />
      
      <hr />
      
      {/* Form c·∫ßn useState v√† onChange */}
      <CommentForm postId={post.id} />
    </article>
  );
}
```

```jsx
// src/components/LikeButton.js
'use client';  // Client Component

import { useState } from 'react';

export default function LikeButton({ postId, initialLikes }) {
  const [likes, setLikes] = useState(initialLikes);
  const [isLiked, setIsLiked] = useState(false);

  const handleLike = async () => {
    setIsLiked(!isLiked);
    setLikes(isLiked ? likes - 1 : likes + 1);
    
    // G·ªçi API ƒë·ªÉ l∆∞u like
    await fetch(`/api/posts/${postId}/like`, { method: 'POST' });
  };

  return (
    <button 
      onClick={handleLike}
      style={{ 
        fontSize: '20px', 
        border: 'none', 
        background: 'transparent',
        cursor: 'pointer'
      }}
    >
      {isLiked ? '‚ù§Ô∏è' : 'ü§ç'} {likes} likes
    </button>
  );
}
```

```jsx
// src/components/CommentForm.js
'use client';

import { useState } from 'react';

export default function CommentForm({ postId }) {
  const [comment, setComment] = useState('');
  const [isSubmitting, setIsSubmitting] = useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);
    
    await fetch(`/api/posts/${postId}/comments`, {
      method: 'POST',
      body: JSON.stringify({ comment }),
    });
    
    setComment('');
    setIsSubmitting(false);
    alert('Comment ƒë√£ ƒë∆∞·ª£c g·ª≠i!');
  };

  return (
    <form onSubmit={handleSubmit}>
      <h3>ƒê·ªÉ l·∫°i b√¨nh lu·∫≠n</h3>
      <textarea
        value={comment}
        onChange={(e) => setComment(e.target.value)}
        placeholder="Nh·∫≠p b√¨nh lu·∫≠n c·ªßa b·∫°n..."
        rows={4}
        style={{ width: '100%', padding: '10px' }}
      />
      <button type="submit" disabled={isSubmitting}>
        {isSubmitting ? 'ƒêang g·ª≠i...' : 'G·ª≠i b√¨nh lu·∫≠n'}
      </button>
    </form>
  );
}
```

##### Ph√¢n t√≠ch: T·∫°i sao k·∫øt h·ª£p?

| Ph·∫ßn | Lo·∫°i Component | L√Ω do |
|---|---|---|
| **Title, Author, Content** | Server Component | ‚úÖ Kh√¥ng c·∫ßn JS, SEO t·ªët, load nhanh |
| **Like Button** | Client Component | ‚úÖ C·∫ßn `useState` v√† `onClick` |
| **Comment Form** | Client Component | ‚úÖ C·∫ßn `useState` cho input v√† submit |

##### L·ª£i √≠ch c·ªßa vi·ªác k·∫øt h·ª£p

**1. Performance t·ªëi ∆∞u**
- Server Components ‚Üí Kh√¥ng tƒÉng bundle size JavaScript (n·ªôi dung tƒ©nh kh√¥ng c·∫ßn JS)
- Client Components ‚Üí Ch·ªâ t·∫£i JS cho ph·∫ßn c·∫ßn t∆∞∆°ng t√°c (buttons, forms)

**2. SEO t·ªët**
- N·ªôi dung ch√≠nh (text, images) render tr√™n server ‚Üí Google ƒë·ªçc ƒë∆∞·ª£c ngay
- Ph·∫ßn t∆∞∆°ng t√°c (buttons) kh√¥ng ·∫£nh h∆∞·ªüng SEO

**3. Developer Experience t·ªët**
- Fetch data tr·ª±c ti·∫øp trong Server Component (kh√¥ng c·∫ßn `useEffect`)
- D√πng hooks tho·∫£i m√°i trong Client Component khi c·∫ßn

**4. Security t·ªët h∆°n**
- API keys, database queries ch·ªâ ch·∫°y tr√™n server (Server Components)
- Kh√¥ng bao gi·ªù l·ªô ra browser

##### Quy t·∫Øc Composition (K·∫øt h·ª£p)

**‚úÖ QUY T·∫ÆC 1: Server Component c√≥ th·ªÉ import Client Component**

```jsx
// ‚úÖ ƒê√öNG: Server Component import Client Component
// src/app/page.js (Server Component)

import ClientButton from '@/components/ClientButton';  // ‚úÖ OK

export default function HomePage() {
  return (
    <div>
      <h1>Welcome</h1>  {/* Server-rendered */}
      <ClientButton />   {/* Client-rendered */}
    </div>
  );
}
```

---

**‚ùå QUY T·∫ÆC 2: Client Component KH√îNG TH·ªÇ import Server Component**

```jsx
// ‚ùå SAI: Client Component import Server Component
// src/components/ClientWrapper.js
'use client';

import ServerData from './ServerData';  // ‚ùå L·ªñI!

export default function ClientWrapper() {
  return <ServerData />;  // ‚ùå Kh√¥ng ho·∫°t ƒë·ªông
}
```

**L√Ω do:** Client Component ch·∫°y tr√™n browser, kh√¥ng th·ªÉ ch·∫°y code server (database queries, file system).

---

**‚úÖ GI·∫¢I PH√ÅP: D√πng `children` prop (Composition Pattern)**

Thay v√¨ import tr·ª±c ti·∫øp, h√£y **truy·ªÅn Server Component qua `children`**:

```jsx
// ‚úÖ ƒê√öNG: Server Component pass v√†o Client Component qua children
// src/app/page.js (Server Component)

import ClientWrapper from '@/components/ClientWrapper';  // Client
import ServerData from '@/components/ServerData';        // Server

export default function Page() {
  return (
    <ClientWrapper>
      {/* ‚úÖ Pass Server Component qua children */}
      <ServerData />
    </ClientWrapper>
  );
}
```

```jsx
// src/components/ClientWrapper.js
'use client';

import { useState } from 'react';

export default function ClientWrapper({ children }) {
  const [isOpen, setIsOpen] = useState(true);
  
  return (
    <div>
      <button onClick={() => setIsOpen(!isOpen)}>
        {isOpen ? '·∫®n' : 'Hi·ªán'}
      </button>
      
      {/* ‚úÖ Render Server Component ƒë∆∞·ª£c pass v√†o */}
      {isOpen && children}
    </div>
  );
}
```

```jsx
// src/components/ServerData.js
// Server Component (m·∫∑c ƒë·ªãnh)

async function getData() {
  const res = await fetch('https://api.example.com/data');
  return res.json();
}

export default async function ServerData() {
  const data = await getData();
  
  return (
    <div>
      <h2>Server Data</h2>
      <pre>{JSON.stringify(data, null, 2)}</pre>
    </div>
  );
}
```

**Gi·∫£i th√≠ch:**
- `ClientWrapper` kh√¥ng import `ServerData` tr·ª±c ti·∫øp.
- `ServerData` ƒë∆∞·ª£c render ·ªü Server, k·∫øt qu·∫£ (HTML) ƒë∆∞·ª£c pass v√†o `ClientWrapper` qua `children`.
- `ClientWrapper` ch·ªâ c·∫ßn toggle hi·ªÉn th·ªã HTML ƒë√≥ (kh√¥ng c·∫ßn bi·∫øt n√≥ t·ª´ ƒë√¢u).

##### B·∫£ng t√≥m t·∫Øt: Quy t·∫Øc Composition

| T√¨nh hu·ªëng | C√≥ ƒë∆∞·ª£c ph√©p? | C√°ch l√†m |
|---|---|---|
| Server ‚Üí Client | ‚úÖ C√≥ | Import tr·ª±c ti·∫øp |
| Client ‚Üí Server | ‚ùå Kh√¥ng | D√πng `children` prop |
| Server ‚Üí Server | ‚úÖ C√≥ | Import tr·ª±c ti·∫øp |
| Client ‚Üí Client | ‚úÖ C√≥ | Import tr·ª±c ti·∫øp |

##### Khi n√†o d√πng Server, khi n√†o d√πng Client?

**D√πng Server Component khi:**
- ‚úÖ Fetch data t·ª´ database/API
- ‚úÖ C·∫ßn SEO (blog posts, product pages)
- ‚úÖ Hi·ªÉn th·ªã n·ªôi dung tƒ©nh (text, images)
- ‚úÖ D√πng API keys/secrets (b·∫£o m·∫≠t)

**D√πng Client Component khi:**
- ‚úÖ C·∫ßn `useState`, `useEffect`, `useContext`
- ‚úÖ C·∫ßn event handlers (`onClick`, `onChange`, `onSubmit`)
- ‚úÖ C·∫ßn browser APIs (`window`, `localStorage`, `navigator`)
- ‚úÖ C·∫ßn th∆∞ vi·ªán ch·ªâ ch·∫°y tr√™n browser (charts, animations)

**Quy t·∫Øc v√†ng:** **M·∫∑c ƒë·ªãnh d√πng Server Component**. Ch·ªâ chuy·ªÉn sang Client Component khi th·ª±c s·ª± c·∫ßn t∆∞∆°ng t√°c.

##### T√≥m t·∫Øt

> **Next.js = React + Server Components + Client Components + Routing + API Routes + Deployment**

Next.js cho ph√©p b·∫°n:
1. Vi·∫øt **Server Components** ƒë·ªÉ t·ªëi ∆∞u performance v√† SEO
2. Vi·∫øt **Client Components** khi c·∫ßn t∆∞∆°ng t√°c
3. **K·∫øt h·ª£p c·∫£ hai** m·ªôt c√°ch linh ho·∫°t trong c√πng m·ªôt app

**ƒê√¢y ch√≠nh l√† "Best of Both Worlds" - s·ª©c m·∫°nh th·ª±c s·ª± c·ªßa Next.js!** üöÄ

---

### 4. Routing: File-based Routing

Next.js d√πng **c·∫•u tr√∫c th∆∞ m·ª•c** ƒë·ªÉ t·∫°o routes t·ª± ƒë·ªông.

#### 4.1. Static Routes

| File Path | URL | V√≠ d·ª• |
|---|---|---|
| `app/page.js` | `/` | Trang ch·ªß |
| `app/about/page.js` | `/about` | Trang gi·ªõi thi·ªáu |
| `app/blog/page.js` | `/blog` | Danh s√°ch blog |
| `app/contact/page.js` | `/contact` | Li√™n h·ªá |

#### 4.2. Dynamic Routes

D√πng `[t√™n_bi·∫øn]` ƒë·ªÉ t·∫°o route ƒë·ªông.

**V√≠ d·ª•: Blog post detail**

```
app/
‚îî‚îÄ‚îÄ blog/
    ‚îî‚îÄ‚îÄ [id]/
        ‚îî‚îÄ‚îÄ page.js  ‚Üí URL: /blog/123, /blog/456, ...
```

**Code:**

```jsx
// src/app/blog/[id]/page.js

async function getPost(id) {
  const res = await fetch(`https://jsonplaceholder.typicode.com/posts/${id}`);
  if (!res.ok) throw new Error('Post not found');
  return res.json();
}

export default async function BlogPost({ params }) {
  // params.id = "123" (l·∫•y t·ª´ URL)
  const post = await getPost(params.id);

  return (
    <article>
      <h1>{post.title}</h1>
      <p>{post.body}</p>
    </article>
  );
}
```

**Truy c·∫≠p:** `http://localhost:3000/blog/5` ‚Üí `params.id = "5"`

---

#### 4.3. Navigation: Link Component

```jsx
import Link from 'next/link';

export default function Navbar() {
  return (
    <nav>
      <Link href="/">Trang ch·ªß</Link>
      <Link href="/about">Gi·ªõi thi·ªáu</Link>
      <Link href="/blog">Blog</Link>
    </nav>
  );
}
```

**L∆∞u √Ω:** D√πng `Link` thay v√¨ `<a>` ƒë·ªÉ c√≥ client-side navigation (kh√¥ng reload trang).

---

### 5. Data Fetching: 4 Chi·∫øn l∆∞·ª£c

React v√† Next.js h·ªó tr·ª£ 4 c√°ch render v√† fetch data, m·ªói c√°ch ph√π h·ª£p v·ªõi m·ªôt use case ri√™ng bi·ªát.

> **Mental Model:** H√£y nghƒ© v·ªÅ **n∆°i** (WHERE) v√† **khi n√†o** (WHEN) d·ªØ li·ªáu ƒë∆∞·ª£c fetch:
> - **CSR**: Fetch ·ªü **Browser**, **sau khi** trang ƒë√£ load
> - **SSR**: Fetch ·ªü **Server**, **m·ªói** request
> - **SSG**: Fetch ·ªü **Server**, **l√∫c** build time (1 l·∫ßn)
> - **ISR**: Fetch ·ªü **Server**, **l√∫c** build + **t·ª± ƒë·ªông** regenerate theo th·ªùi gian
>
> **L∆∞u √Ω:** "Fetch" = G·ª≠i y√™u c·∫ßu (request) + Nh·∫≠n ph·∫£n h·ªìi (response) v·ªõi d·ªØ li·ªáu.

---

#### Browser ‚Üî Server "Packet-Level Mental Model"

ƒê·ªÉ hi·ªÉu s√¢u h∆°n v·ªÅ CSR, SSR, SSG, h√£y xem x√©t **c√°ch tr√¨nh duy·ªát v√† server trao ƒë·ªïi d·ªØ li·ªáu** ·ªü m·ª©c ƒë·ªô k·ªπ thu·∫≠t.

##### 0) Baseline: ƒêi·ªÅu g√¨ lu√¥n x·∫£y ra?

B·∫•t k·ªÉ ph∆∞∆°ng ph√°p n√†o, khi truy c·∫≠p m·ªôt trang web lu√¥n c√≥ c√°c b∆∞·ªõc sau:

1. **Browser g·ª≠i request** `GET /some-page`
2. **Server ph·∫£n h·ªìi** v·ªõi *m·ªôt th·ª© g√¨ ƒë√≥* (HTML + c√≥ th·ªÉ c√≥ links ƒë·∫øn JS/CSS)
3. **Browser ph√¢n t√≠ch HTML**, t·∫£i CSS/JS/images
4. **JS ch·∫°y** (n·∫øu c√≥), trang tr·ªü n√™n interactive

**S·ª± kh√°c bi·ªát l·ªõn:** **Khi n√†o v√† ·ªü ƒë√¢u n·ªôi dung HTML ƒë∆∞·ª£c t·∫°o ra?**

---

##### 1) CSR ‚Äî Client Side Rendering

**√ù t∆∞·ªüng:** Server g·ª≠i HTML *r·ªóng*. Browser t·∫£i JS, sau ƒë√≥ JS x√¢y d·ª±ng n·ªôi dung trang.

**ƒêi·ªÅu g√¨ ƒë√£ c√≥ trong browser ban ƒë·∫ßu?**
* G·∫ßn nh∆∞ kh√¥ng c√≥ g√¨ ngo√†i m·ªôt container r·ªóng nh∆∞ `<div id="root"></div>` (v√† c√≥ th·ªÉ c√≥ "loading‚Ä¶")

**Server g·ª≠i g√¨?**
* HTML t·ªëi thi·ªÉu + links ƒë·∫øn JS/CSS bundles

**Browser l√†m g√¨?**
* T·∫£i JS
* Ch·∫°y React (ho·∫∑c framework t∆∞∆°ng t·ª±)
* G·ªçi APIs ƒë·ªÉ fetch data
* X√¢y d·ª±ng DOM (HTML) trong browser

**Timeline (ƒë∆°n gi·∫£n h√≥a):**

```
1. Browser ‚Üí Server: GET /products
2. Server ‚Üí Browser: index.html (g·∫ßn nh∆∞ r·ªóng) + JS bundle link
3. Browser ‚Üí Server/CDN: download JS bundle
4. Browser ch·∫°y JS ‚Üí Browser ‚Üí API: GET /api/products
5. API ‚Üí Browser: JSON data
6. Browser render danh s√°ch s·∫£n ph·∫©m
```

**∆Øu / Nh∆∞·ª£c ƒëi·ªÉm:**
* ‚úÖ Tuy·ªát v·ªùi cho t√≠nh t∆∞∆°ng t√°c gi·ªëng app
* ‚ùå Ch·∫≠m h∆°n ƒë·ªÉ hi·ªÉn th·ªã "n·ªôi dung c√≥ √Ω nghƒ©a ƒë·∫ßu ti√™n" tr√™n thi·∫øt b·ªã/m·∫°ng ch·∫≠m
* ‚ùå SEO kh√≥ khƒÉn h∆°n (Google ƒë√£ t·ªët h∆°n, nh∆∞ng v·∫´n kh√¥ng s·∫°ch b·∫±ng SSR/SSG)

---

##### 2) SSR ‚Äî Server Side Rendering

**√ù t∆∞·ªüng:** V·ªõi m·ªói request, server t·∫°o HTML **ngay l·∫≠p t·ª©c**, sau ƒë√≥ g·ª≠i HTML ƒë·∫ßy ƒë·ªß cho browser.

**ƒêi·ªÅu g√¨ ƒë√£ c√≥ trong browser ban ƒë·∫ßu?**
* HTML n·ªôi dung th·ª±c t·∫ø ƒë√£ c√≥ s·∫µn khi response ƒë·∫øn (text, lists, v.v.)

**Server l√†m g√¨?**
* Ch·∫°y code trang tr√™n server
* Fetch data (DB/API)
* Render HTML string
* G·ª≠i HTML + JS/CSS links

**Browser l√†m g√¨?**
* Hi·ªÉn th·ªã n·ªôi dung ngay sau khi nh·∫≠n HTML
* T·∫£i JS bundle
* "Hydrate" (g·∫Øn JS v√†o HTML ƒë√£ c√≥ s·∫µn ƒë·ªÉ c√°c n√∫t ho·∫°t ƒë·ªông)

> **Hydration** = JS "k·∫øt n·ªëi" HTML ƒë√£ ƒë∆∞·ª£c render s·∫µn. (hydrat h√≥a / g·∫Øn JS v√†o HTML)

**Timeline:**

```
1. Browser ‚Üí Server: GET /products
2. Server: fetch products ‚Üí render HTML
3. Server ‚Üí Browser: HTML ƒë·∫ßy ƒë·ªß v·ªõi danh s√°ch s·∫£n ph·∫©m + JS bundle link
4. Browser: v·∫Ω n·ªôi dung nhanh ch√≥ng
5. Browser t·∫£i JS
6. Browser hydrate ‚Üí b√¢y gi·ªù interactive
```

**∆Øu / Nh∆∞·ª£c ƒëi·ªÉm:**
* ‚úÖ N·ªôi dung ƒë·∫ßu ti√™n nhanh, SEO t·ªët
* ‚úÖ Lu√¥n m·ªõi (n·∫øu b·∫°n mu·ªën)
* ‚ùå Chi ph√≠ server m·ªói request (CPU + fetch data)
* ‚ùå Ch·∫≠m h∆°n "time to interactive" n·∫øu JS l·ªõn (v·∫´n c·∫ßn hydration)

---

##### 3) SSG ‚Äî Static Site Generation

**√ù t∆∞·ªüng:** HTML ƒë∆∞·ª£c t·∫°o **tr∆∞·ªõc** (build time). Khi c√≥ request, server ch·ªâ serve files.

**ƒêi·ªÅu g√¨ ƒë√£ c√≥ trong browser ban ƒë·∫ßu?**
* HTML n·ªôi dung ƒë·∫ßy ƒë·ªß ngay l·∫≠p t·ª©c (tr·∫£i nghi·ªám gi·ªëng SSR)

**Server l√†m g√¨ (khi c√≥ request)?**
* G·∫ßn nh∆∞ kh√¥ng l√†m g√¨: ch·ªâ tr·∫£ v·ªÅ file `.html` ƒë√£ build s·∫µn (th∆∞·ªùng t·ª´ CDN)

**Server l√†m g√¨ (l√∫c build time)?**
* Ch·∫°y render trang m·ªôt l·∫ßn
* T·∫°o ra `/products.html`
* Upload l√™n hosting/CDN

**Timeline (khi c√≥ request):**

```
1. Browser ‚Üí CDN/server: GET /products
2. CDN/server ‚Üí Browser: HTML ƒë√£ build s·∫µn + JS link
3. Browser v·∫Ω n·ªôi dung nhanh
4. Browser t·∫£i JS
5. Browser hydrate (t√πy ch·ªçn)
```

**∆Øu / Nh∆∞·ª£c ƒëi·ªÉm:**
* ‚úÖ Nhanh + r·∫ª ·ªü quy m√¥ l·ªõn (CDN)
* ‚úÖ SEO tuy·ªát v·ªùi
* ‚ùå N·ªôi dung c√≥ th·ªÉ c≈© cho ƒë·∫øn khi rebuild/deploy l·∫ßn sau
* ‚ùå Kh√≥ cho trang "user-specific" (tr·ª´ khi b·∫°n k·∫øt h·ª£p v·ªõi CSR)

---

##### B·∫£ng t√≥m t·∫Øt "T√¥i nh·∫≠n ƒë∆∞·ª£c g√¨?"

| Mode    | HTML ƒë·∫ßu ti√™n c√≥ n·ªôi dung th·ª±c? | N·ªôi dung HTML ƒë∆∞·ª£c t·∫°o ·ªü ƒë√¢u? | Browser c√≥ fetch data ƒë·ªÉ hi·ªÉn th·ªã trang ban ƒë·∫ßu? | C√¥ng vi·ªác server m·ªói l·∫ßn truy c·∫≠p |
| ------- | ------------------------------- | ----------------------------- | ------------------------------------------------- | --------------------------------- |
| **CSR** | Th∆∞·ªùng **Kh√¥ng** (shell r·ªóng)  | Browser (JS)                  | **C√≥** (API fetch)                                | Th·∫•p                              |
| **SSR** | **C√≥**                          | Server (m·ªói request)          | Kh√¥ng (cho hi·ªÉn th·ªã ban ƒë·∫ßu)                      | Cao/trung b√¨nh                    |
| **SSG** | **C√≥**                          | Server (l√∫c build time)       | Kh√¥ng (cho hi·ªÉn th·ªã ban ƒë·∫ßu)                      | R·∫•t th·∫•p                          |

---

##### Th·ª±c t·∫ø: H·∫ßu h·∫øt c√°c trang web hi·ªán ƒë·∫°i l√† **hybrid** (k·∫øt h·ª£p)

**V√≠ d·ª• hybrid ph·ªï bi·∫øn:**

* D√πng **SSG/SSR** cho shell trang ban ƒë·∫ßu + n·ªôi dung SEO
* D√πng **CSR** cho c√°c ph·∫ßn thay ƒë·ªïi th∆∞·ªùng xuy√™n (gi√°, t·ªìn kho, "s·∫£n ph·∫©m ƒë·ªÅ xu·∫•t", comments)

**T·∫°i sao kh√¥ng d√πng SSR cho Price, Stock, Recommendations, Comments?**

ƒê√¢y l√† c√¢u h·ªèi r·∫•t hay! N·∫øu **SSR (Server-Side Rendering)** c√≥ th·ªÉ fetch data tr√™n server v√† g·ª≠i trang ho√†n ch·ªânh, t·∫°i sao l·∫°i ph·∫£i ƒë·ª£i **CSR (Client-Side Rendering)** fetch nh·ªØng th·ª© nh∆∞ gi√° ho·∫∑c t·ªìn kho sau?

**L√Ω do:** ƒê√¢y l√† s·ª± ƒë√°nh ƒë·ªïi (trade-off) gi·ªØa **T·ªëc ƒë·ªô c·∫£m nh·∫≠n (Perceived Speed)**, **T·∫£i server (Server Load)**, v√† **Kh·∫£ nƒÉng cache (Caching)**.

---

###### 1. V·∫•n ƒë·ªÅ "TTFB" (Time to First Byte)

Khi b·∫°n d√πng SSR, server ph·∫£i ho√†n th√†nh **T·∫§T C·∫¢** vi·ªác fetch data tr∆∞·ªõc khi g·ª≠i m·ªôt byte HTML n√†o ƒë·∫øn browser.

**N·∫øu b·∫°n SSR m·ªçi th·ª©:**
- N·∫øu API "S·∫£n ph·∫©m ƒë·ªÅ xu·∫•t" ch·∫≠m ho·∫∑c d·ªãch v·ª• "Comments" c·ªßa b√™n th·ª© ba m·∫•t 2 gi√¢y ƒë·ªÉ ph·∫£n h·ªìi, user s·∫Ω nh√¨n v√†o m√†n h√¨nh tr·∫Øng trong 2 gi√¢y.

**C√°ch ti·∫øp c·∫≠n Hybrid:**
- B·∫°n SSR layout v√† text ngay l·∫≠p t·ª©c. User th·∫•y trang trong 0.2 gi√¢y.
- Sau ƒë√≥, gi√° v√† comments "xu·∫•t hi·ªán" qua CSR.
- User **C·∫¢M TH·∫§Y** trang web nhanh h∆°n v√¨ h·ªç c√≥ th·ªÉ b·∫Øt ƒë·∫ßu ƒë·ªçc ngay l·∫≠p t·ª©c.

**V√≠ d·ª• tr·ª±c quan:**

```
‚ùå SSR m·ªçi th·ª©:
User click ‚Üí ƒê·ª£i 2s (m√†n h√¨nh tr·∫Øng) ‚Üí Th·∫•y trang ho√†n ch·ªânh

‚úÖ Hybrid (SSR + CSR):
User click ‚Üí 0.2s th·∫•y layout + text ‚Üí ƒê·ªçc n·ªôi dung ‚Üí 1.8s sau gi√°/stock xu·∫•t hi·ªán
```

**Mental Model:**
- **SSR m·ªçi th·ª©** = ƒê·ª£i c·∫£ b·ªØa ƒÉn n·∫•u xong m·ªõi ƒë∆∞·ª£c v√†o nh√† h√†ng
- **Hybrid** = V√†o nh√† h√†ng ngay, ng·ªìi xu·ªëng, xem menu (SSR), sau ƒë√≥ m√≥n ƒÉn ƒë∆∞·ª£c mang ra (CSR)

---

###### 2. Global Caching (Y·∫øu t·ªë CDN)

Ki·∫øn tr√∫c web hi·ªán ƒë·∫°i ph·ª• thu·ªôc nhi·ªÅu v√†o **CDN (Content Delivery Networks)** nh∆∞ Cloudflare ho·∫∑c Vercel.

**N·ªôi dung tƒ©nh (Static Content):**
- B·∫°n c√≥ th·ªÉ cache HTML c·ªßa trang s·∫£n ph·∫©m (T√™n, M√¥ t·∫£, H√¨nh ·∫£nh) tr√™n c√°c server kh·∫Øp th·∫ø gi·ªõi.
- ƒêi·ªÅu n√†y l√†m trang load **ngay l·∫≠p t·ª©c** b·∫•t k·ªÉ user ·ªü ƒë√¢u.

**N·ªôi dung ƒë·ªông (Dynamic Content):**
- Gi√°, m·ª©c t·ªìn kho, v√† ƒë·ªÅ xu·∫•t c√° nh√¢n h√≥a thay ƒë·ªïi **qu√° nhanh** ƒë·ªÉ cache to√†n c·∫ßu.

**Gi·∫£i ph√°p:**
- B·∫°n serve "Static Shell" t·ª´ cache (nhanh)
- D√πng CSR ƒë·ªÉ fetch "Volatile Data" t·ª´ database (m·ªõi)

**V√≠ d·ª• c·ª• th·ªÉ:**

```
Trang s·∫£n ph·∫©m iPhone:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [T√™n: iPhone 15 Pro]      ‚Üê SSG/SSR ‚îÇ Cache tr√™n CDN to√†n c·∫ßu
‚îÇ [M√¥ t·∫£: Chip A17...]      ‚Üê SSG/SSR ‚îÇ (Kh√¥ng ƒë·ªïi)
‚îÇ [H√¨nh ·∫£nh]                ‚Üê SSG/SSR ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [Gi√°: $999]               ‚Üê CSR     ‚îÇ Fetch real-time t·ª´ DB
‚îÇ [T·ªìn kho: 5 s·∫£n ph·∫©m]    ‚Üê CSR     ‚îÇ (Thay ƒë·ªïi li√™n t·ª•c)
‚îÇ [ƒê·ªÅ xu·∫•t cho b·∫°n]        ‚Üê CSR     ‚îÇ (C√° nh√¢n h√≥a)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**K·∫øt qu·∫£:**
- User ·ªü Vi·ªát Nam: Nh·∫≠n HTML t·ª´ CDN Singapore (10ms)
- User ·ªü M·ªπ: Nh·∫≠n HTML t·ª´ CDN California (10ms)
- C·∫£ hai ƒë·ªÅu fetch gi√°/stock t·ª´ database ch√≠nh (100ms) - nh∆∞ng ƒë√£ th·∫•y trang r·ªìi!

---

###### 3. Chi ph√≠ Server & Kh·∫£ nƒÉng m·ªü r·ªông (Scalability)

SSR "ƒë·∫Øt ƒë·ªè" cho server c·ªßa b·∫°n. M·ªói khi user truy c·∫≠p trang, server ph·∫£i ch·∫°y code, n√≥i chuy·ªán v·ªõi database, v√† t·∫°o chu·ªói HTML.

**V·∫•n ƒë·ªÅ v·ªõi SSR m·ªçi th·ª©:**
- N·∫øu b·∫°n c√≥ 100,000 users truy c·∫≠p trang SSR c√πng l√∫c, server c√≥ th·ªÉ **crash**.
- M·ªói request ph·∫£i: Query DB cho gi√° ‚Üí Query DB cho stock ‚Üí Query DB cho recommendations ‚Üí Render HTML
- Chi ph√≠: CPU + RAM + Database connections

**V·ªõi CSR cho ph·∫ßn ƒë·ªông:**
- "C√¥ng vi·ªác n·∫∑ng" c·ªßa vi·ªác render UI ƒë∆∞·ª£c chuy·ªÉn sang **m√°y t√≠nh/ƒëi·ªán tho·∫°i c·ªßa user**.
- Server ch·ªâ c·∫ßn g·ª≠i d·ªØ li·ªáu JSON th√¥, **nh·∫π h∆°n nhi·ªÅu** so v·ªõi g·ª≠i HTML ƒë·∫ßy ƒë·ªß.

**So s√°nh t·∫£i server:**

```
SSR m·ªçi th·ª© (100,000 requests):
Server: Render 100,000 HTML pages + Fetch 400,000 DB queries
‚Üí Server CPU: 90% | RAM: 85% | DB: Overload ‚ùå

Hybrid (SSG + CSR):
Server: Serve 100,000 cached HTML (nh·∫π) + 200,000 API calls (JSON)
‚Üí Server CPU: 30% | RAM: 40% | DB: Normal ‚úÖ
```

**Mental Model:**
- **SSR m·ªçi th·ª©** = Nh√† h√†ng t·ª± n·∫•u + t·ª± giao h√†ng ƒë·∫øn t·∫≠n nh√† (ƒë·∫Øt, ch·∫≠m)
- **Hybrid** = Nh√† h√†ng g·ª≠i c√¥ng th·ª©c (HTML) + nguy√™n li·ªáu (JSON), b·∫°n t·ª± pha ch·∫ø (CSR)

---

###### 4. Tr·∫£i nghi·ªám ng∆∞·ªùi d√πng (UX) v√† T√≠nh t∆∞∆°ng t√°c

M·ªôt s·ªë th·ª© ƒë∆°n gi·∫£n **C·∫¢M TH·∫§Y T·ªêT H∆†N** khi x·ª≠ l√Ω ·ªü ph√≠a client:

**Comments:**
- N·∫øu user click "T·∫£i th√™m Comments", b·∫°n **kh√¥ng mu·ªën** re-render to√†n b·ªô trang qua SSR.
- B·∫°n ch·ªâ mu·ªën fetch 10 items n·ªØa v√† ch√®n v√†o.

**Stock Updates:**
- T∆∞·ªüng t∆∞·ª£ng "Flash Sale". N·∫øu stock thay ƒë·ªïi m·ªói gi√¢y, CSR c√≥ th·ªÉ c·∫≠p nh·∫≠t **ch·ªâ s·ªë "Stock"** tr√™n m√†n h√¨nh m√† kh√¥ng c·∫ßn user refresh trang.

**V√≠ d·ª•: Real-time Stock Updates**

```jsx
// CSR: C·∫≠p nh·∫≠t stock m·ªói 5 gi√¢y
'use client';

export default function LiveStock({ productId }) {
  const [stock, setStock] = useState(null);
  
  useEffect(() => {
    // Fetch l·∫ßn ƒë·∫ßu
    fetchStock();
    
    // C·∫≠p nh·∫≠t m·ªói 5 gi√¢y
    const interval = setInterval(fetchStock, 5000);
    return () => clearInterval(interval);
  }, []);
  
  async function fetchStock() {
    const res = await fetch(`/api/stock/${productId}`);
    const data = await res.json();
    setStock(data.quantity);
  }
  
  return (
    <div>
      C√≤n l·∫°i: <strong>{stock ?? '...'}</strong> s·∫£n ph·∫©m
      {stock < 5 && <span style={{color: 'red'}}>‚ö° S·∫Øp h·∫øt!</span>}
    </div>
  );
}
```

**V·ªõi SSR:** User ph·∫£i F5 trang m·ªói 5 gi√¢y ƒë·ªÉ th·∫•y stock m·ªõi ‚Üí Tr·∫£i nghi·ªám t·ªá!

**V·ªõi CSR:** S·ªë stock t·ª± ƒë·ªông c·∫≠p nh·∫≠t m√† kh√¥ng c·∫ßn refresh ‚Üí Tr·∫£i nghi·ªám m∆∞·ª£t m√†!

---

###### B·∫£ng so s√°nh t·ªïng h·ª£p

| Ti√™u ch√≠ | SSR (Server-Side) | CSR (Client-Side) |
| --- | --- | --- |
| **Initial Load** | Ch·∫≠m h∆°n (ƒê·ª£i t·∫•t c·∫£ data) | Nhanh h∆°n (Static shell tr∆∞·ªõc) |
| **SEO** | Xu·∫•t s·∫Øc | Trung b√¨nh/T·ªët |
| **Data Freshness** | Fresh t·∫°i th·ªùi ƒëi·ªÉm request | Real-time / C√≥ th·ªÉ c·∫≠p nh·∫≠t |
| **Server Load** | Cao (Server l√†m vi·ªác) | Th·∫•p (Client l√†m vi·ªác) |
| **Caching** | Kh√≥ (data ƒë·ªông) | D·ªÖ (cache shell, fetch data) |
| **Scalability** | Kh√≥ m·ªü r·ªông | D·ªÖ m·ªü r·ªông |
| **UX cho data thay ƒë·ªïi nhanh** | Ph·∫£i refresh trang | C·∫≠p nh·∫≠t t·ª± ƒë·ªông |

---

###### Ngo·∫°i l·ªá hi·ªán ƒë·∫°i

> **C√¥ng ngh·ªá m·ªõi:** **React Server Components (RSC)** v√† **Streaming SSR** ƒëang c·ªë g·∫Øng thu h·∫πp kho·∫£ng c√°ch n√†y b·∫±ng c√°ch "streaming" HTML khi n√≥ s·∫µn s√†ng, nh∆∞ng v·ªõi h·∫ßu h·∫øt c√°c ·ª©ng d·ª•ng, m√¥ h√¨nh Hybrid (SSR + CSR) v·∫´n l√† ti√™u chu·∫©n v√†ng cho hi·ªáu su·∫•t.

**Streaming SSR ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o:**

```
Thay v√¨:
Server: ƒê·ª£i t·∫•t c·∫£ data ‚Üí G·ª≠i HTML ho√†n ch·ªânh

Streaming SSR:
Server: G·ª≠i layout ngay l·∫≠p t·ª©c
     ‚Üí G·ª≠i product info khi s·∫µn s√†ng
     ‚Üí G·ª≠i recommendations khi s·∫µn s√†ng
     ‚Üí G·ª≠i comments khi s·∫µn s√†ng
```

**K·∫øt qu·∫£:** User th·∫•y trang "d·∫ßn d·∫ßn xu·∫•t hi·ªán" thay v√¨ ƒë·ª£i m√†n h√¨nh tr·∫Øng.

---

###### K·∫øt lu·∫≠n: Khi n√†o d√πng CSR thay v√¨ SSR?

**D√πng CSR cho:**
- ‚úÖ D·ªØ li·ªáu thay ƒë·ªïi **r·∫•t nhanh** (gi√°, stock, live chat)
- ‚úÖ D·ªØ li·ªáu **c√° nh√¢n h√≥a** (recommendations, user-specific content)
- ‚úÖ T√≠nh nƒÉng **t∆∞∆°ng t√°c** (load more, infinite scroll, real-time updates)
- ‚úÖ Khi b·∫°n mu·ªën **cache static shell** tr√™n CDN

**D√πng SSR cho:**
- ‚úÖ N·ªôi dung **quan tr·ªçng cho SEO** (ti√™u ƒë·ªÅ, m√¥ t·∫£, text ch√≠nh)
- ‚úÖ D·ªØ li·ªáu **kh√¥ng ƒë·ªïi th∆∞·ªùng xuy√™n** nh∆∞ng c·∫ßn fresh m·ªói request
- ‚úÖ Khi **initial content** quan tr·ªçng h∆°n **time to interactive**

**Quy t·∫Øc v√†ng:** K·∫øt h·ª£p c·∫£ hai! SSR/SSG cho "khung x∆∞∆°ng" (SEO + fast first paint), CSR cho "n·ªôi t·∫°ng" (dynamic data + interactivity).

---



* "SSG cho layout v√† m√¥ t·∫£ s·∫£n ph·∫©m c∆° b·∫£n"
* c·ªông v·ªõi "CSR cho tr·∫°ng th√°i t·ªìn kho tr·ª±c ti·∫øp"

**V√≠ d·ª• c·ª• th·ªÉ:**

```jsx
// src/app/product/[id]/page.js

// SSG: Th√¥ng tin s·∫£n ph·∫©m c∆° b·∫£n (build time)
export default async function ProductPage({ params }) {
  const product = await getProduct(params.id); // Fetch l√∫c build
  
  return (
    <div>
      {/* SSG: N·ªôi dung tƒ©nh, SEO-friendly */}
      <h1>{product.name}</h1>
      <p>{product.description}</p>
      
      {/* CSR: D·ªØ li·ªáu ƒë·ªông, real-time */}
      <StockStatus productId={params.id} />  {/* Client Component */}
      <UserReviews productId={params.id} />  {/* Client Component */}
    </div>
  );
}
```

```jsx
// src/components/StockStatus.js
'use client';

import { useState, useEffect } from 'react';

export default function StockStatus({ productId }) {
  const [stock, setStock] = useState(null);
  
  useEffect(() => {
    // CSR: Fetch stock real-time
    fetch(`/api/stock/${productId}`)
      .then(res => res.json())
      .then(data => setStock(data.quantity));
  }, [productId]);
  
  return <p>C√≤n l·∫°i: {stock ?? 'Loading...'} s·∫£n ph·∫©m</p>;
}
```

**K·∫øt qu·∫£:**
1. Browser nh·∫≠n HTML v·ªõi t√™n + m√¥ t·∫£ s·∫£n ph·∫©m ngay l·∫≠p t·ª©c (SSG ‚Üí SEO t·ªët)
2. JS load v√† fetch stock real-time (CSR ‚Üí d·ªØ li·ªáu m·ªõi nh·∫•t)

---

##### So s√°nh v·ªõi WordPress (ƒë·ªÉ d·ªÖ h√¨nh dung)

**WordPress truy·ªÅn th·ªëng:**

* Th∆∞·ªùng **gi·ªëng SSR** (PHP render HTML m·ªói request)
* V·ªõi caching plugins/CDN, n√≥ ho·∫°t ƒë·ªông **gi·ªëng SSG** cho kh√°ch ·∫©n danh
* V·ªõi c√°c t√≠nh nƒÉng JS, n√≥ tr·ªü th√†nh **hybrid SSR + CSR**

**Mental Model:**
* WordPress c≈© = SSR (m·ªói request ch·∫°y PHP)
* WordPress + WP Super Cache = SSG (serve HTML tƒ©nh)
* WordPress + AJAX comments = Hybrid (SSR/SSG + CSR)

---


#### 5.1. CSR - Client-Side Rendering (Browser-based)

**Khi n√†o d√πng:** 
- D·ªØ li·ªáu c√° nh√¢n h√≥a (user-specific data)
- D·ªØ li·ªáu kh√¥ng c·∫ßn SEO (dashboard, admin panel)
- Progressive enhancement (load trang tr∆∞·ªõc, data sau)

**C∆° ch·∫ø:** Server g·ª≠i HTML r·ªóng/skeleton ‚Üí JavaScript load ‚Üí Browser fetch data ‚Üí Render.

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ **T·ªët cho:** Interactive dashboards, user-specific data
- ‚ùå **Kh√¥ng t·ªët cho:** SEO, initial page load speed

```jsx
// src/app/dashboard/page.js (Client Component)
'use client';  // ƒê√°nh d·∫•u ƒë√¢y l√† Client Component

import { useState, useEffect } from 'react';

export default function DashboardPage() {
  const [userData, setUserData] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    // Fetch data ·ªü browser (sau khi component mount)
    async function fetchUserData() {
      const res = await fetch('/api/user/profile');
      const data = await res.json();
      setUserData(data);
      setLoading(false);
    }
    
    fetchUserData();
  }, []);
  
  if (loading) return <div>Loading...</div>;
  
  return (
    <div>
      <h1>Welcome, {userData.name}!</h1>
      <p>Your balance: ${userData.balance}</p>
    </div>
  );
}
```

**Timeline:**
1. Browser nh·∫≠n HTML (r·ªóng/skeleton)
2. JavaScript load v√† execute
3. `useEffect` ch·∫°y ‚Üí fetch data
4. Re-render v·ªõi data

---

#### 5.2. SSR - Server-Side Rendering (Dynamic)

**Khi n√†o d√πng:** 
- D·ªØ li·ªáu thay ƒë·ªïi li√™n t·ª•c cho m·ªçi user (gi√° c·ªï phi·∫øu, tin t·ª©c m·ªõi nh·∫•t)
- C·∫ßn SEO + fresh data m·ªçi l√∫c
- Personalized content c·∫ßn SEO

**C∆° ch·∫ø:** M·ªói request ‚Üí Server fetch data m·ªõi ‚Üí Render HTML ‚Üí G·ª≠i v·ªÅ browser.

**Gi·∫£i th√≠ch chi ti·∫øt:**

SSR (Server-Side Rendering) ho·∫°t ƒë·ªông nh∆∞ m·ªôt **nh√† h√†ng c√≥ ƒë·∫ßu b·∫øp** - m·ªói khi kh√°ch ƒë·∫∑t m√≥n, ƒë·∫ßu b·∫øp n·∫•u m√≥n ƒÉn m·ªõi toanh, sau ƒë√≥ mang ra ph·ª•c v·ª•.

##### B∆∞·ªõc 1: User g·ª≠i request

```
User nh·∫•n v√†o link ho·∫∑c g√µ URL ‚Üí Browser g·ª≠i request ƒë·∫øn server
V√≠ d·ª•: GET https://myapp.com/stocks
```

**ƒêi·ªÅu g√¨ x·∫£y ra:**
- Browser g·ª≠i HTTP request ƒë·∫øn Next.js server
- Server nh·∫≠n request v√† b·∫Øt ƒë·∫ßu x·ª≠ l√Ω

##### B∆∞·ªõc 2: Server fetch data M·ªöI

```
Server ‚Üí API/Database: "Cho t√¥i d·ªØ li·ªáu m·ªõi nh·∫•t!"
API/Database ‚Üí Server: Tr·∫£ v·ªÅ JSON data
```

**ƒêi·ªÅu g√¨ x·∫£y ra:**
- Server ch·∫°y code trong component c·ªßa b·∫°n (v√≠ d·ª•: `getStocks()`)
- Server g·ªçi API ho·∫∑c query database ƒë·ªÉ l·∫•y d·ªØ li·ªáu **real-time**
- **Quan tr·ªçng:** Vi·ªác n√†y x·∫£y ra **M·ªñI L·∫¶N** c√≥ request, kh√¥ng d√πng cache

**V√≠ d·ª• c·ª• th·ªÉ:**

```javascript
// Code n√†y ch·∫°y TR√äN SERVER, kh√¥ng ph·∫£i browser
async function getStocks() {
  // Server fetch data t·ª´ API b√™n ngo√†i
  const res = await fetch('https://api.example.com/stocks', {
    cache: 'no-store'  // ‚Üê Kh√¥ng cache = lu√¥n fetch m·ªõi
  });
  return res.json();
}
```

**Mental Model - So s√°nh v·ªõi CSR:**

| B∆∞·ªõc | CSR (Client-Side) | SSR (Server-Side) |
|------|-------------------|-------------------|
| **Ai fetch data?** | Browser (JavaScript) | Server (Node.js) |
| **Khi n√†o fetch?** | Sau khi trang load xong | Tr∆∞·ªõc khi g·ª≠i HTML |
| **User th·∫•y g√¨ l√∫c fetch?** | "Loading..." spinner | Kh√¥ng th·∫•y g√¨ (ƒëang ƒë·ª£i server) |

##### B∆∞·ªõc 3: Server RENDER HTML v·ªõi data

```
Server: L·∫•y data ‚Üí Ch·∫°y React component ‚Üí T·∫°o HTML string
```

**ƒêi·ªÅu g√¨ x·∫£y ra:**
- Server ch·∫°y React component c·ªßa b·∫°n **tr√™n server** (kh√¥ng ph·∫£i browser!)
- React "v·∫Ω" component th√†nh chu·ªói HTML
- HTML n√†y **ƒê√É CH·ª®A D·ªÆ LI·ªÜU** (kh√¥ng ph·∫£i `<div id="root"></div>` r·ªóng nh∆∞ CSR)

**V√≠ d·ª•:**

```javascript
// Component n√†y ch·∫°y tr√™n SERVER
export default async function StocksPage() {
  const stocks = await getStocks();  // ‚Üê Data ƒë√£ c√≥ s·∫µn
  
  // React render th√†nh HTML STRING tr√™n server
  return (
    <div>
      <h1>Gi√° c·ªï phi·∫øu</h1>
      {stocks.map(stock => (
        <div key={stock.id}>
          {stock.name}: ${stock.price}  {/* ‚Üê Data ƒë√£ c√≥ trong HTML */}
        </div>
      ))}
    </div>
  );
}
```

**K·∫øt qu·∫£ (HTML string m√† server t·∫°o ra):**

```html
<div>
  <h1>Gi√° c·ªï phi·∫øu</h1>
  <div>Apple: $150.25</div>
  <div>Google: $2800.50</div>
  <div>Tesla: $220.75</div>
</div>
```

##### B∆∞·ªõc 4: Server G·ª¨I HTML ho√†n ch·ªânh v·ªÅ browser

```
Server ‚Üí Browser: G·ª≠i HTML (ƒë√£ c√≥ data) + links ƒë·∫øn JS/CSS
```

**ƒêi·ªÅu g√¨ x·∫£y ra:**
- Server g·ª≠i HTML **ƒë·∫ßy ƒë·ªß n·ªôi dung** v·ªÅ browser
- Browser nh·∫≠n ƒë∆∞·ª£c v√† **hi·ªÉn th·ªã ngay l·∫≠p t·ª©c** (kh√¥ng c·∫ßn ch·ªù JS load)
- User th·∫•y n·ªôi dung ngay (fast first paint)

**Response t·ª´ server:**

```html
<!DOCTYPE html>
<html>
<head>
  <title>Stocks</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <!-- ‚Üì HTML ƒê√É C√ì DATA, kh√¥ng ph·∫£i r·ªóng -->
  <div>
    <h1>Gi√° c·ªï phi·∫øu</h1>
    <div>Apple: $150.25</div>
    <div>Google: $2800.50</div>
    <div>Tesla: $220.75</div>
  </div>
  
  <!-- JS ƒë·ªÉ hydrate (l√†m trang interactive) -->
  <script src="/app.js"></script>
</body>
</html>
```

##### B∆∞·ªõc 5 (Optional): Browser t·∫£i JS v√† Hydrate

```
Browser t·∫£i JS ‚Üí "Hydrate" HTML ‚Üí Trang tr·ªü n√™n interactive
```

**Hydration l√† g√¨?**
- HTML ƒë√£ c√≥ s·∫µn nh∆∞ng ch∆∞a c√≥ "s·ª± s·ªëng" (kh√¥ng click ƒë∆∞·ª£c button, kh√¥ng c√≥ event handlers)
- JS t·∫£i v·ªÅ v√† "g·∫Øn" event handlers v√†o HTML ƒë√£ c√≥
- Gi·ªëng nh∆∞ "th·ªïi h·ªìn" v√†o HTML tƒ©nh

**V√≠ d·ª•:**

```jsx
// Tr∆∞·ªõc hydration: Button hi·ªÉn th·ªã nh∆∞ng click kh√¥ng l√†m g√¨
<button>Mua c·ªï phi·∫øu</button>

// Sau hydration: Button c√≥ th·ªÉ click ƒë∆∞·ª£c
<button onClick={handleBuy}>Mua c·ªï phi·∫øu</button>
```

---

##### T√≥m t·∫Øt: SSR vs CSR (So s√°nh tr·ª±c quan)

**CSR (Client-Side Rendering):**

```
1. Browser ‚Üí Server: "Cho t√¥i trang /stocks"
2. Server ‚Üí Browser: HTML r·ªóng + JS bundle
3. Browser t·∫£i JS (ƒë·ª£i...)
4. Browser ch·∫°y JS
5. Browser ‚Üí API: "Cho t√¥i data stocks"
6. API ‚Üí Browser: JSON data
7. Browser render HTML v·ªõi data
   ‚Üì
   User ph·∫£i ƒê·ª¢I t·ª´ b∆∞·ªõc 1 ‚Üí 7 m·ªõi th·∫•y n·ªôi dung
```

**SSR (Server-Side Rendering):**

```
1. Browser ‚Üí Server: "Cho t√¥i trang /stocks"
2. Server ‚Üí API: "Cho t√¥i data stocks"
3. API ‚Üí Server: JSON data
4. Server render HTML v·ªõi data
5. Server ‚Üí Browser: HTML ho√†n ch·ªânh (c√≥ data)
   ‚Üì
   User th·∫•y n·ªôi dung NGAY t·∫°i b∆∞·ªõc 5
6. (Optional) Browser t·∫£i JS ƒë·ªÉ hydrate
```

**S·ª± kh√°c bi·ªát l·ªõn:**
- **CSR**: User th·∫•y trang tr·∫Øng ‚Üí Loading spinner ‚Üí N·ªôi dung
- **SSR**: User th·∫•y n·ªôi dung ngay l·∫≠p t·ª©c (nh∆∞ng ch∆∞a interactive) ‚Üí Interactive sau khi JS load

---

##### V√≠ d·ª• th·ª±c t·∫ø: Trang tin t·ª©c

**T√¨nh hu·ªëng:** B·∫°n x√¢y d·ª±ng trang tin t·ª©c, c·∫ßn hi·ªÉn th·ªã 10 b√†i vi·∫øt m·ªõi nh·∫•t.

**V·ªõi SSR:**

```jsx
// src/app/news/page.js
async function getLatestNews() {
  const res = await fetch('https://api.news.com/latest', {
    cache: 'no-store'  // Lu√¥n l·∫•y tin m·ªõi nh·∫•t
  });
  return res.json();
}

export default async function NewsPage() {
  const news = await getLatestNews();  // Fetch tr√™n server
  
  return (
    <div>
      <h1>Tin t·ª©c m·ªõi nh·∫•t</h1>
      {news.map(article => (
        <article key={article.id}>
          <h2>{article.title}</h2>
          <p>{article.summary}</p>
        </article>
      ))}
    </div>
  );
}
```

**ƒêi·ªÅu g√¨ x·∫£y ra khi user truy c·∫≠p:**

1. **9:00 AM** - User A truy c·∫≠p ‚Üí Server fetch tin t·ª©c l√∫c 9:00 AM ‚Üí G·ª≠i HTML
2. **9:05 AM** - User B truy c·∫≠p ‚Üí Server fetch tin t·ª©c l√∫c 9:05 AM (c√≥ th·ªÉ c√≥ tin m·ªõi) ‚Üí G·ª≠i HTML
3. **9:10 AM** - User C truy c·∫≠p ‚Üí Server fetch tin t·ª©c l√∫c 9:10 AM (c√≥ th·ªÉ c√≥ tin m·ªõi) ‚Üí G·ª≠i HTML

**K·∫øt qu·∫£:** M·ªói user ƒë·ªÅu th·∫•y tin t·ª©c **M·ªöI NH·∫§T** t·∫°i th·ªùi ƒëi·ªÉm h·ªç truy c·∫≠p.

---

##### T·∫°i sao g·ªçi l√† "Server-Side" Rendering?

**"Server-Side"** = Vi·ªác render (t·∫°o HTML) x·∫£y ra **·ªü ph√≠a server**, kh√¥ng ph·∫£i browser.

**So s√°nh:**

| Kh√≠a c·∫°nh | Client-Side (CSR) | Server-Side (SSR) |
|-----------|-------------------|-------------------|
| **N∆°i ch·∫°y React** | Browser | Server (Node.js) |
| **N∆°i fetch data** | Browser | Server |
| **N∆°i t·∫°o HTML** | Browser | Server |
| **Browser nh·∫≠n g√¨?** | HTML r·ªóng + JS | HTML ƒë·∫ßy ƒë·ªß + JS |
| **Khi n√†o user th·∫•y n·ªôi dung?** | Sau khi JS ch·∫°y xong | Ngay khi nh·∫≠n HTML |

---

##### L∆∞u √Ω quan tr·ªçng

**1. SSR ‚â† Static (tƒ©nh)**
- SSR render **m·ªói l·∫ßn c√≥ request** ‚Üí Lu√¥n fresh
- SSG render **1 l·∫ßn l√∫c build** ‚Üí C√≥ th·ªÉ c≈©

**2. SSR t·ªën server resources**
- M·ªói request ph·∫£i: fetch data + render HTML
- N·∫øu c√≥ 1000 requests/gi√¢y ‚Üí Server ph·∫£i l√†m vi·ªác 1000 l·∫ßn/gi√¢y
- Chi ph√≠ cao h∆°n SSG (ch·ªâ serve file tƒ©nh)

**3. SSR t·ªët cho SEO**
- Google bot nh·∫≠n HTML ƒë·∫ßy ƒë·ªß ngay l·∫≠p t·ª©c
- Kh√¥ng c·∫ßn ch·ªù JS ch·∫°y ƒë·ªÉ th·∫•y n·ªôi dung
- T·ªët h∆°n CSR cho SEO


- ‚úÖ **T·ªët cho:** SEO, fresh data m·ªçi request
- ‚ùå **Kh√¥ng t·ªët cho:** Performance (ch·∫≠m h∆°n SSG/ISR), server load cao

```jsx
// src/app/stocks/page.js (Server Component - m·∫∑c ƒë·ªãnh)

async function getStocks() {
  const res = await fetch('https://api.example.com/stocks', {
    cache: 'no-store'  // Kh√¥ng cache, lu√¥n fetch m·ªõi m·ªói request
  });
  return res.json();
}

export default async function StocksPage() {
  const stocks = await getStocks();  // Fetch tr√™n server m·ªói request
  
  return (
    <div>
      <h1>Gi√° c·ªï phi·∫øu (Real-time)</h1>
      {stocks.map(stock => (
        <div key={stock.id}>
          {stock.name}: ${stock.price}
        </div>
      ))}
    </div>
  );
}
```

**Timeline:**
1. User request `/stocks`
2. Server fetch data m·ªõi t·ª´ API
3. Server render HTML v·ªõi data
4. Browser nh·∫≠n HTML ho√†n ch·ªânh (c√≥ data)

---

#### 5.3. SSG - Static Site Generation (Static)

**Khi n√†o d√πng:** 
- D·ªØ li·ªáu √≠t/kh√¥ng thay ƒë·ªïi (blog posts, documentation, landing pages)
- ∆Øu ti√™n performance t·ªëi ƒëa
- Traffic cao (static files d·ªÖ cache v√† serve qua CDN)

**C∆° ch·∫ø:** Build time ‚Üí Fetch data 1 l·∫ßn ‚Üí T·∫°o HTML tƒ©nh ‚Üí Serve HTML cho m·ªçi request.

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ **T·ªët cho:** Performance c·ª±c nhanh, SEO, low server load
- ‚ùå **Kh√¥ng t·ªët cho:** D·ªØ li·ªáu thay ƒë·ªïi th∆∞·ªùng xuy√™n (c·∫ßn rebuild ƒë·ªÉ update)

```jsx
// src/app/docs/page.js (Server Component)

async function getDocs() {
  const res = await fetch('https://api.example.com/docs', {
    cache: 'force-cache'  // Cache vƒ©nh vi·ªÖn (SSG)
  });
  return res.json();
}

export default async function DocsPage() {
  const docs = await getDocs();  // Fetch 1 l·∫ßn l√∫c build
  
  return (
    <div>
      <h1>Documentation</h1>
      {docs.map(doc => (
        <article key={doc.id}>
          <h2>{doc.title}</h2>
          <p>{doc.content}</p>
        </article>
      ))}
    </div>
  );
}
```

**Build command:**

```bash
npm run build  # Fetch data + T·∫°o HTML tƒ©nh
npm start      # Serve HTML tƒ©nh (kh√¥ng fetch l·∫°i data)
```

**Timeline:**
1. Build time: Fetch data ‚Üí T·∫°o HTML tƒ©nh
2. Runtime: M·ªçi request serve HTML tƒ©nh (instant)

---

#### 5.4. ISR - Incremental Static Regeneration (SSG + Auto-Update)

**Khi n√†o d√πng:** 
- D·ªØ li·ªáu thay ƒë·ªïi ƒë·ªãnh k·ª≥ nh∆∞ng kh√¥ng c·∫ßn realtime (product catalog, blog v·ªõi analytics)
- Mu·ªën k·∫øt h·ª£p t·ªëc ƒë·ªô c·ªßa SSG + freshness c·ªßa SSR
- Traffic cao nh∆∞ng c·∫ßn data "relatively fresh"

**C∆° ch·∫ø:** Build t·∫°o HTML tƒ©nh (nh∆∞ SSG) ‚Üí Sau X gi√¢y ‚Üí T·ª± ƒë·ªông regenerate HTML m·ªõi ·ªü background.

> **B·∫£n ch·∫•t:** ISR = SSG + Revalidation Timer. Kh√¥ng ph·∫£i chi·∫øn l∆∞·ª£c ri√™ng bi·ªát m√† l√† **SSG c√≥ kh·∫£ nƒÉng t·ª± ƒë·ªông update**.

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ **T·ªët cho:** Best of both worlds (fast nh∆∞ SSG + fresh nh∆∞ SSR)
- ‚ùå **Kh√¥ng t·ªët cho:** Realtime data (c√≥ ƒë·ªô tr·ªÖ revalidation period)

```jsx
// src/app/products/page.js (Server Component)

async function getProducts() {
  const res = await fetch('https://api.example.com/products', {
    next: { revalidate: 3600 }  // Regenerate m·ªói 1 gi·ªù (3600 gi√¢y)
  });
  return res.json();
}

export default async function ProductsPage() {
  const products = await getProducts();
  
  return (
    <div>
      <h1>S·∫£n ph·∫©m</h1>
      <p><small>C·∫≠p nh·∫≠t m·ªói 1 gi·ªù</small></p>
      {products.map(product => (
        <div key={product.id}>
          <h2>{product.name}</h2>
          <p>${product.price}</p>
        </div>
      ))}
    </div>
  );
}
```

**Timeline (Stale-While-Revalidate Pattern):**
1. **Build time:** Fetch data ‚Üí T·∫°o HTML version 1
2. **0-59 ph√∫t:** M·ªçi user nh·∫≠n HTML version 1 (cached, instant)
3. **Ph√∫t 60:** 
   - User A request ‚Üí V·∫´n nh·∫≠n HTML version 1 (instant)
   - Background: Next.js t·ª± ƒë·ªông fetch data m·ªõi ‚Üí T·∫°o HTML version 2
4. **Ph√∫t 61+:** User B request ‚Üí Nh·∫≠n HTML version 2

**So s√°nh ISR vs SSG:**

| Aspect | SSG | ISR |
|---|---|---|
| **Build** | Fetch 1 l·∫ßn | Fetch 1 l·∫ßn |
| **Runtime** | Serve static HTML | Serve static HTML **+** auto-regenerate |
| **Update data** | Ph·∫£i rebuild manually | T·ª± ƒë·ªông sau X gi√¢y |
| **Performance** | Instant | Instant (v√¨ v·∫´n serve static) |

---

#### So s√°nh 4 chi·∫øn l∆∞·ª£c

| Chi·∫øn l∆∞·ª£c | Render ·ªü ƒë√¢u? | Khi n√†o fetch? | Performance | SEO | Fresh Data | Use Case |
|---|---|---|---|---|---|---|
| **CSR** | Browser | Sau khi JS load | Ch·∫≠m (initial) | ‚ùå K√©m | ‚úÖ C√≥ (m·ªói load) | Dashboard, user-specific UI |
| **SSR** | Server | M·ªói request | Trung b√¨nh | ‚úÖ T·ªët | ‚úÖ Lu√¥n fresh | News, personalized + SEO |
| **SSG** | Server (build) | Build time (1 l·∫ßn) | ‚ö° C·ª±c nhanh | ‚úÖ T·ªët | ‚ùå Static | Blog, docs, landing pages |
| **ISR** | Server (build + revalidate) | Build + ƒë·ªãnh k·ª≥ | ‚ö° C·ª±c nhanh | ‚úÖ T·ªët | ‚ö†Ô∏è "Fresh enough" | E-commerce, semi-static content |

---

#### Decision Tree: Ch·ªçn chi·∫øn l∆∞·ª£c n√†o?

```
B·∫°n c·∫ßn SEO?
‚îÇ
‚îú‚îÄ KH√îNG ‚Üí CSR (Client-side rendering v·ªõi useEffect)
‚îÇ
‚îî‚îÄ C√ì ‚Üí D·ªØ li·ªáu thay ƒë·ªïi th·∫ø n√†o?
    ‚îÇ
    ‚îú‚îÄ KH√îNG BAO GI·ªú/R·∫§T √çT ‚Üí SSG (Static generation)
    ‚îÇ
    ‚îú‚îÄ ƒê·ªäNH K·ª≤ (gi·ªù/ng√†y) ‚Üí ISR (SSG + revalidation)
    ‚îÇ
    ‚îî‚îÄ M·ªåI REQUEST (realtime) ‚Üí SSR (Server-side rendering)
```

---

#### K·∫øt h·ª£p nhi·ªÅu chi·∫øn l∆∞·ª£c trong 1 app

**Best Practice:** S·ª≠ d·ª•ng chi·∫øn l∆∞·ª£c ph√π h·ª£p cho t·ª´ng trang.

**V√≠ d·ª• 1: Multi-purpose App**

```
/                    ‚Üí SSG (Landing page - static)
/blog                ‚Üí SSG (Blog list - static)
/blog/[slug]         ‚Üí ISR (Blog post - c·∫≠p nh·∫≠t khi edit)
/products            ‚Üí ISR (Product catalog - c·∫≠p nh·∫≠t ƒë·ªãnh k·ª≥)
/products/[id]       ‚Üí ISR (Product detail - revalidate m·ªói gi·ªù)
/dashboard           ‚Üí CSR (User dashboard - personalized data)
/stock-ticker        ‚Üí SSR (Stock prices - realtime)
/api/user/profile    ‚Üí API route (Backend cho CSR)
```

**V√≠ d·ª• 2: E-commerce Site (Monorepo - 2 Apps ri√™ng bi·ªát)**

> **K·ªãch b·∫£n:** C√πng 1 database, nh∆∞ng 2 Next.js apps ri√™ng bi·ªát:
> - `apps/public` ‚Üí Static export (deploy l√™n hosting)
> - `apps/admin` ‚Üí Local-only admin panel (ch·∫°y tr√™n laptop)

**C·∫•u tr√∫c project:**

```
my-ecommerce/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ public/          ‚Üí Next.js Public Site (Static Export)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.js              ‚Üí SSG (Homepage)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products/page.js     ‚Üí SSG (Product list)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ products/[slug]/page.js ‚Üí SSG (Product detail)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ next.config.js
‚îÇ   ‚îÇ   ‚îÇ   output: 'export'  ‚Üê Static export
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ admin/           ‚Üí Next.js Admin Site (Local Only)
‚îÇ       ‚îú‚îÄ‚îÄ app/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ page.js              ‚Üí CSR (Dashboard)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ products/page.js     ‚Üí SSR (Product list - fresh data)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ products/[id]/page.js ‚Üí SSR (Product editor)
‚îÇ       ‚îú‚îÄ‚îÄ next.config.js
‚îÇ       ‚îÇ   (no export, runs as dev server)
‚îÇ       ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îî‚îÄ‚îÄ packages/
    ‚îî‚îÄ‚îÄ database/        ‚Üí Shared database client (Prisma/Drizzle)
        ‚îú‚îÄ‚îÄ schema.prisma
        ‚îî‚îÄ‚îÄ client.ts
```

**Routing Architecture:**

```
üì¶ apps/public (Static Site - Deploy l√™n Vercel/Netlify)
/                        ‚Üí SSG (Homepage - static HTML)
/products                ‚Üí SSG (Product list - build time data)
/products/giay-nike      ‚Üí SSG (Product detail - static HTML cho m·ªói product)
/cart                    ‚Üí Client-only (localStorage/sessionStorage)
/checkout                ‚Üí Client-only (kh√¥ng c·∫ßn backend)

üîß apps/admin (Local Dev Server - Ch·ªâ ch·∫°y tr√™n laptop)
http://localhost:3001/                  ‚Üí CSR (Admin dashboard)
http://localhost:3001/products          ‚Üí SSR (Product list - fresh t·ª´ DB)
http://localhost:3001/products/123/edit ‚Üí SSR (Product editor)
http://localhost:3001/orders            ‚Üí SSR (Order management)
```

**Gi·∫£i th√≠ch lu·ªìng ho·∫°t ƒë·ªông:**

1. **Admin edit product (Local):**
   - M·ªü `http://localhost:3001/products/123/edit`
   - SSR fetch data t·ª´ database ‚Üí Always fresh
   - Edit product ‚Üí Save v√†o database
   
2. **Rebuild public site:**
   - Admin ch·∫°y: `cd apps/public && npm run build`
   - Next.js fetch t·∫•t c·∫£ products t·ª´ database
   - Generate static HTML cho m·ªói product page
   - Deploy folder `out/` l√™n hosting (Vercel/Netlify/S3)

3. **Customer truy c·∫≠p (Production):**
   - Truy c·∫≠p `https://myshop.com/products/giay-nike`
   - CDN serve static HTML ‚Üí Instant load ‚ö°
   - No server, no database query ‚Üí C·ª±c nhanh

**So s√°nh 2 apps:**

| Aspect | `apps/public` | `apps/admin` |
|---|---|---|
| **Ki·∫øn tr√∫c** | Static Export (`output: 'export'`) | Dev server (`npm run dev`) |
| **Deploy** | ‚úÖ Deploy l√™n CDN (Vercel/Netlify) | ‚ùå Ch·ªâ ch·∫°y local |
| **Database** | ‚ùå No runtime DB connection | ‚úÖ Direct DB connection |
| **Rendering** | SSG (build time only) | SSR/CSR (runtime) |
| **Performance** | ‚ö° Instant (static files) | Trung b√¨nh (query DB m·ªói request) |
| **Update data** | Rebuild + redeploy | Realtime (query DB) |
| **Cost** | üü¢ Mi·ªÖn ph√≠ (static hosting) | üü° Kh√¥ng deploy (local only) |

**∆Øu ƒëi·ªÉm ki·∫øn tr√∫c n√†y:**

‚úÖ **T√°ch bi·ªát ho√†n to√†n:** Public site kh√¥ng c√≥ backend code, an to√†n tuy·ªát ƒë·ªëi  
‚úÖ **Free hosting:** Static site c√≥ th·ªÉ host mi·ªÖn ph√≠ (Vercel/Netlify/GitHub Pages)  
‚úÖ **No server costs:** Kh√¥ng c·∫ßn server ch·∫°y 24/7, kh√¥ng t·ªën ti·ªÅn database hosting  
‚úÖ **Admin ƒë∆°n gi·∫£n:** Kh√¥ng c·∫ßn authentication ph·ª©c t·∫°p (ch·ªâ ch·∫°y local)  
‚úÖ **Performance t·ªëi ƒëa:** Customer lu√¥n nh·∫≠n static HTML (kh√¥ng c√≥ API call)

**Trade-offs:**

‚ö†Ô∏è **Manual rebuild:** M·ªói l·∫ßn update product c·∫ßn rebuild + redeploy (kh√¥ng t·ª± ƒë·ªông nh∆∞ ISR)  
‚ö†Ô∏è **Build time:** N·∫øu c√≥ 10,000 products ‚Üí Build l√¢u (c√≥ th·ªÉ d√πng Incremental Static Regeneration n·∫øu c·∫ßn)  
‚ö†Ô∏è **Real-time data:** Kh√¥ng ph√π h·ª£p n·∫øu c·∫ßn realtime inventory/pricing (stock real-time, flash sale)

---

### 6. Layout v√† Metadata: C·∫•u tr√∫c l·ªìng gh√©p (Nested Structure)

> **Mental Model:** Layout gi·ªëng nh∆∞ **H·ªôp Matryoshka (Russian Nesting Dolls)**. M·ªói trang ƒë∆∞·ª£c bao b·ªçc b·ªüi nhi·ªÅu l·ªõp layout t·ª´ ngo√†i v√†o trong: Root Layout ‚Üí Nested Layout ‚Üí Page.

---

#### 6.0. Hi·ªÉu v·ªÅ c·∫•u tr√∫c th∆∞ m·ª•c v√† quan h·ªá cha-con

**Nguy√™n t·∫Øc v√†ng trong Next.js App Router:**

M·ªói folder c√≥ th·ªÉ ch·ª©a 2 file ƒë·∫∑c bi·ªát:
- `layout.js` - Khung bao quanh (wrapper) cho t·∫•t c·∫£ routes con
- `page.js` - N·ªôi dung th·ª±c s·ª± c·ªßa route

**C·∫•u tr√∫c th∆∞ m·ª•c v√† k·∫øt qu·∫£:**

```
app/
‚îú‚îÄ‚îÄ layout.js          ‚Üí Root Layout (√°p d·ª•ng cho T·∫§T C·∫¢ trang)
‚îú‚îÄ‚îÄ page.js            ‚Üí Homepage (/)
‚îÇ
‚îú‚îÄ‚îÄ blog/
‚îÇ   ‚îú‚îÄ‚îÄ layout.js      ‚Üí Blog Layout (ch·ªâ √°p d·ª•ng cho /blog/*)
‚îÇ   ‚îú‚îÄ‚îÄ page.js        ‚Üí Blog list (/blog)
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ [slug]/
‚îÇ       ‚îî‚îÄ‚îÄ page.js    ‚Üí Blog post (/blog/react-intro)
‚îÇ
‚îî‚îÄ‚îÄ products/
    ‚îú‚îÄ‚îÄ page.js        ‚Üí Product list (/products)
    ‚îÇ
    ‚îî‚îÄ‚îÄ [id]/
        ‚îî‚îÄ‚îÄ page.js    ‚Üí Product detail (/products/123)
```

**Quy t·∫Øc √°p d·ª•ng:**

| URL | Layouts ƒë∆∞·ª£c √°p d·ª•ng (ngo√†i ‚Üí trong) | Page |
|---|---|---|
| `/` | `app/layout.js` | `app/page.js` |
| `/blog` | `app/layout.js` ‚Üí `app/blog/layout.js` | `app/blog/page.js` |
| `/blog/react-intro` | `app/layout.js` ‚Üí `app/blog/layout.js` | `app/blog/[slug]/page.js` |
| `/products` | `app/layout.js` | `app/products/page.js` |
| `/products/123` | `app/layout.js` | `app/products/[id]/page.js` |

---

#### 6.1. Root Layout (B·∫Øt bu·ªôc)

**Root Layout** l√† l·ªõp ngo√†i c√πng, bao quanh **T·∫§T C·∫¢** c√°c trang trong ·ª©ng d·ª•ng.

```jsx
// app/layout.js (Root Layout)

export const metadata = {
  title: 'My Next.js App',
  description: 'A production-ready React app',
};

export default function RootLayout({ children }) {
  return (
    <html lang="vi">
      <body>
        <header>
          <nav>
            <a href="/">Home</a>
            <a href="/blog">Blog</a>
            <a href="/products">Products</a>
          </nav>
        </header>
        
        <main>{children}</main> {/* ‚Üê ƒê√¢y l√† "l·ªó h·ªïng" cho n·ªôi dung */}
        
        <footer>
          <p>&copy; 2026 My App</p>
        </footer>
      </body>
    </html>
  );
}
```

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ **B·∫Øt bu·ªôc**: M·ªçi Next.js app ph·∫£i c√≥ `app/layout.js`
- ‚úÖ **Lu√¥n render**: Header/Footer hi·ªán ·ªü m·ªçi trang
- ‚úÖ **Props `children`**: L√† placeholder cho n·ªôi dung con (nested layout ho·∫∑c page)

**`children` l√† g√¨?**

Khi user truy c·∫≠p `/blog`, React s·∫Ω render:

```jsx
<RootLayout>
  {/* children = BlogLayout ho·∫∑c BlogPage */}
  <BlogLayout>
    <BlogPage />
  </BlogLayout>
</RootLayout>
```

---

#### 6.2. Nested Layout (Layout con)

**Nested Layout** ch·ªâ √°p d·ª•ng cho m·ªôt nh√≥m routes c·ª• th·ªÉ.

```jsx
// app/blog/layout.js (Blog Layout)

export default function BlogLayout({ children }) {
  return (
    <div style={{ display: 'flex' }}>
      {/* Sidebar ch·ªâ hi·ªán trong /blog/* */}
      <aside style={{ width: '200px', background: '#f0f0f0' }}>
        <h3>Categories</h3>
        <ul>
          <li><a href="/blog?category=tech">Tech</a></li>
          <li><a href="/blog?category=lifestyle">Lifestyle</a></li>
        </ul>
      </aside>
      
      <div style={{ flex: 1, padding: '20px' }}>
        {children}  {/* ‚Üê Blog page content */}
      </div>
    </div>
  );
}
```

**K·∫øt qu·∫£ render khi truy c·∫≠p `/blog`:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Header (Root Layout)                ‚îÇ ‚Üê app/layout.js
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇCategories‚îÇ Blog List (Page)   ‚îÇ   ‚îÇ ‚Üê app/blog/layout.js + page.js
‚îÇ ‚îÇ         ‚îÇ                     ‚îÇ   ‚îÇ
‚îÇ ‚îÇ - Tech  ‚îÇ ‚Ä¢ React intro       ‚îÇ   ‚îÇ
‚îÇ ‚îÇ - Life  ‚îÇ ‚Ä¢ Next.js guide     ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Footer (Root Layout)                ‚îÇ ‚Üê app/layout.js
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**K·∫øt qu·∫£ render khi truy c·∫≠p `/products` (kh√¥ng c√≥ blog layout):**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Header (Root Layout)                ‚îÇ ‚Üê app/layout.js
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Product List (Page)                 ‚îÇ ‚Üê app/products/page.js
‚îÇ                                     ‚îÇ    (KH√îNG c√≥ sidebar)
‚îÇ ‚Ä¢ Product 1                         ‚îÇ
‚îÇ ‚Ä¢ Product 2                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Footer (Root Layout)                ‚îÇ ‚Üê app/layout.js
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

#### 6.3. Composition Flow: Hi·ªÉu v·ªÅ lu·ªìng l·ªìng gh√©p

**V√≠ d·ª•: User truy c·∫≠p `/blog/react-intro`**

**1. Next.js t√¨m file theo th·ª© t·ª±:**

```
app/layout.js               ‚úÖ T√¨m th·∫•y (Root Layout)
app/blog/layout.js          ‚úÖ T√¨m th·∫•y (Blog Layout)  
app/blog/[slug]/page.js     ‚úÖ T√¨m th·∫•y (Blog Post Page)
```

**2. React compose components (ngo√†i ‚Üí trong):**

```jsx
// K·∫øt qu·∫£ cu·ªëi c√πng (pseudo-code)
<RootLayout>              {/* app/layout.js */}
  <html>
    <body>
      <header>...</header>
      <main>
        <BlogLayout>      {/* app/blog/layout.js */}
          <div style={{ display: 'flex' }}>
            <aside>Sidebar</aside>
            <div>
              <BlogPostPage />  {/* app/blog/[slug]/page.js */}
            </div>
          </div>
        </BlogLayout>
      </main>
      <footer>...</footer>
    </body>
  </html>
</RootLayout>
```

**3. C√°ch `children` ƒë∆∞·ª£c truy·ªÅn:**

```jsx
// B∆∞·ªõc 1: RootLayout render
<RootLayout children={<BlogLayout>...</BlogLayout>} />

// B∆∞·ªõc 2: BlogLayout render
<BlogLayout children={<BlogPostPage />} />

// B∆∞·ªõc 3: BlogPostPage render
<BlogPostPage /> // Kh√¥ng c√≥ children (leaf node)
```

---

#### 6.4. Layout trong Monorepo (apps/public vs apps/admin)

**K·ªãch b·∫£n:** C√πng database nh∆∞ng 2 apps c√≥ layout kh√°c nhau.

**apps/public/app/layout.js (Customer Site):**

```jsx
// Minimal, SEO-focused, clean UI
export default function PublicRootLayout({ children }) {
  return (
    <html lang="vi">
      <body>
        <header className="sticky-header">
          <nav>
            <Logo />
            <SearchBar />
            <CartIcon />
          </nav>
        </header>
        <main>{children}</main>
        <footer>
          <SocialLinks />
          <ContactInfo />
        </footer>
      </body>
    </html>
  );
}
```

**apps/admin/app/layout.js (Admin Panel):**

```jsx
// Sidebar navigation, no SEO needed
export default function AdminRootLayout({ children }) {
  return (
    <html lang="vi">
      <body>
        <div style={{ display: 'flex', height: '100vh' }}>
          {/* Sidebar c·ªë ƒë·ªãnh */}
          <aside style={{ width: '250px', background: '#2c3e50' }}>
            <h2>Admin Panel</h2>
            <nav>
              <a href="/products">Products</a>
              <a href="/orders">Orders</a>
              <a href="/customers">Customers</a>
            </nav>
          </aside>
          
          {/* Content area */}
          <main style={{ flex: 1, padding: '20px' }}>
            {children}
          </main>
        </div>
      </body>
    </html>
  );
}
```

**So s√°nh layouts:**

| Aspect | `apps/public/app/layout.js` | `apps/admin/app/layout.js` |
|---|---|---|
| **Header** | Logo + Search + Cart | Sidebar navigation |
| **Footer** | ‚úÖ Social links, contact | ‚ùå Kh√¥ng c·∫ßn |
| **SEO** | ‚úÖ Metadata, structured data | ‚ùå Kh√¥ng quan tr·ªçng |
| **Styling** | Clean, customer-friendly | Functional, admin-focused |

---

#### 6.5. Nested Layout trong Admin App

**apps/admin/app/products/layout.js:**

```jsx
// Layout ri√™ng cho product management
export default function ProductLayout({ children }) {
  return (
    <div>
      {/* Breadcrumb */}
      <nav>
        <a href="/admin">Dashboard</a> / <span>Products</span>
      </nav>
      
      {/* Action bar */}
      <div style={{ marginBottom: '20px' }}>
        <button>+ Add New Product</button>
        <button>Export CSV</button>
      </div>
      
      {/* Content */}
      {children}
    </div>
  );
}
```

**K·∫øt qu·∫£ khi truy c·∫≠p `localhost:3001/products`:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Admin Panel (Root Layout Sidebar)           ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ Dashboard / Products (Breadcrumb)        ‚îÇ ‚îÇ ‚Üê products/layout.js
‚îÇ ‚îÇ [+ Add] [Export]                         ‚îÇ ‚îÇ ‚Üê products/layout.js
‚îÇ ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ ‚îÇ
‚îÇ ‚îÇ Product List (Page content)              ‚îÇ ‚îÇ ‚Üê products/page.js
‚îÇ ‚îÇ ‚Ä¢ Nike Shoes - $100                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚Ä¢ Adidas Shirt - $50                     ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

#### 6.6. Best Practices cho Layout

‚úÖ **DO:**
- ƒê·∫∑t navigation, header, footer trong Root Layout
- D√πng nested layout cho shared UI trong m·ªôt section (v√≠ d·ª•: blog sidebar)
- Truy·ªÅn metadata ri√™ng cho t·ª´ng layout
- T·∫≠n d·ª•ng `children` ƒë·ªÉ t√°i s·ª≠ d·ª•ng code

‚ùå **DON'T:**
- Duplicate header/footer ·ªü m·ªói page (d√πng layout thay v√¨)
- Fetch data trong layout (d√πng Server Components trong page thay v√¨)
- Nest qu√° nhi·ªÅu layout (t·ªëi ƒëa 3 levels: Root ‚Üí Section ‚Üí Sub-section)

---

---

### 7. API Routes: Backend Built-in

#### 7.0. Ki·∫øn th·ª©c n·ªÅn t·∫£ng v·ªÅ API

##### A. API l√† g√¨?

**API (Application Programming Interface)** l√† c√°ch ƒë·ªÉ c√°c ·ª©ng d·ª•ng "n√≥i chuy·ªán" v·ªõi nhau.

**Mental Model: Nh√† h√†ng**
- **Kh√°ch h√†ng (Frontend):** B·∫°n ng·ªìi ·ªü b√†n, mu·ªën g·ªçi m√≥n.
- **Th·ª±c ƒë∆°n (API Documentation):** Danh s√°ch m√≥n ƒÉn b·∫°n c√≥ th·ªÉ g·ªçi.
- **Ng∆∞·ªùi ph·ª•c v·ª• (API):** Nh·∫≠n y√™u c·∫ßu c·ªßa b·∫°n, chuy·ªÉn cho b·∫øp, mang m√≥n ra.
- **B·∫øp (Backend/Database):** N∆°i th·ª±c s·ª± n·∫•u m√≥n ƒÉn (x·ª≠ l√Ω logic, l·∫•y data).

**V√≠ d·ª• th·ª±c t·∫ø:**
```javascript
// Frontend g·ªçi API
fetch('https://api.example.com/users')  // ‚Üê G·ªçi m√≥n "danh s√°ch users"
  .then(res => res.json())
  .then(users => console.log(users));   // ‚Üê Nh·∫≠n m√≥n (data)
```

**T·∫°i sao c·∫ßn API?**
- ‚úÖ **T√°ch bi·ªát Frontend v√† Backend:** Frontend kh√¥ng c·∫ßn bi·∫øt database l√† g√¨, ch·ªâ c·∫ßn g·ªçi API.
- ‚úÖ **T√°i s·ª≠ d·ª•ng:** C√πng 1 API c√≥ th·ªÉ d√πng cho web, mobile app, desktop app.
- ‚úÖ **B·∫£o m·∫≠t:** Database kh√¥ng public, ch·ªâ API ƒë∆∞·ª£c ph√©p truy c·∫≠p.

---

##### B. REST API l√† g√¨?

**REST (Representational State Transfer)** l√† m·ªôt ki·∫øn tr√∫c thi·∫øt k·∫ø API ph·ªï bi·∫øn nh·∫•t.

**Nguy√™n t·∫Øc c·ªët l√µi:**
1. **M·ªói resource c√≥ m·ªôt URL duy nh·∫•t**
   - Users: `/api/users`
   - User c·ª• th·ªÉ: `/api/users/5`
   - Posts c·ªßa user: `/api/users/5/posts`

2. **D√πng HTTP Methods ƒë·ªÉ thao t√°c**
   - `GET`: L·∫•y data (Read)
   - `POST`: T·∫°o m·ªõi (Create)
   - `PATCH/PUT`: C·∫≠p nh·∫≠t (Update)
   - `DELETE`: X√≥a (Delete)

**V√≠ d·ª• CRUD (Create, Read, Update, Delete):**

| H√†nh ƒë·ªông | HTTP Method | URL | Body |
|---|---|---|---|
| L·∫•y t·∫•t c·∫£ users | `GET` | `/api/users` | Kh√¥ng |
| L·∫•y user ID 5 | `GET` | `/api/users/5` | Kh√¥ng |
| T·∫°o user m·ªõi | `POST` | `/api/users` | `{ name: "An" }` |
| C·∫≠p nh·∫≠t user 5 | `PATCH` | `/api/users/5` | `{ name: "B√¨nh" }` |
| X√≥a user 5 | `DELETE` | `/api/users/5` | Kh√¥ng |

---

##### C. HTTP Methods chi ti·∫øt

###### 1. GET - L·∫•y d·ªØ li·ªáu

```javascript
// Client g·ªçi
fetch('https://api.example.com/users')
  .then(res => res.json())
  .then(data => console.log(data));

// Server tr·∫£ v·ªÅ
// Status: 200 OK
// Body: [{ id: 1, name: "An" }, { id: 2, name: "B√¨nh" }]
```

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ Kh√¥ng thay ƒë·ªïi data tr√™n server (Safe)
- ‚úÖ C√≥ th·ªÉ cache
- ‚úÖ C√≥ th·ªÉ bookmark URL
- ‚ùå Kh√¥ng n√™n g·ª≠i data nh·∫°y c·∫£m qua URL

---

###### 2. POST - T·∫°o m·ªõi

```javascript
// Client g·ªçi
fetch('https://api.example.com/users', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: "C∆∞·ªùng", age: 30 })
})
  .then(res => res.json())
  .then(data => console.log(data));

// Server tr·∫£ v·ªÅ
// Status: 201 Created
// Body: { id: 3, name: "C∆∞·ªùng", age: 30 }
```

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ T·∫°o resource m·ªõi
- ‚úÖ G·ª≠i data qua body (an to√†n h∆°n URL)
- ‚ùå Kh√¥ng cache

---

###### 3. PATCH/PUT - C·∫≠p nh·∫≠t

```javascript
// PATCH: C·∫≠p nh·∫≠t m·ªôt ph·∫ßn
fetch('https://api.example.com/users/3', {
  method: 'PATCH',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ age: 31 })  // Ch·ªâ update age
});

// PUT: Thay th·∫ø to√†n b·ªô
fetch('https://api.example.com/users/3', {
  method: 'PUT',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: "C∆∞·ªùng", age: 31 })  // Ph·∫£i g·ª≠i ƒë·∫ßy ƒë·ªß
});
```

**S·ª± kh√°c bi·ªát:**
- **PATCH:** C·∫≠p nh·∫≠t m·ªôt v√†i field ‚Üí Linh ho·∫°t h∆°n
- **PUT:** Thay th·∫ø to√†n b·ªô object ‚Üí √çt d√πng h∆°n

---

###### 4. DELETE - X√≥a

```javascript
fetch('https://api.example.com/users/3', {
  method: 'DELETE'
});

// Server tr·∫£ v·ªÅ
// Status: 204 No Content (ho·∫∑c 200 OK)
```

---

##### D. API trong React vs Next.js

###### React thu·∫ßn (Client-side API calls)

```jsx
// React Component
import { useState, useEffect } from 'react';

function Users() {
  const [users, setUsers] = useState([]);

  useEffect(() => {
    // G·ªçi API t·ª´ browser
    fetch('https://api.example.com/users')
      .then(res => res.json())
      .then(data => setUsers(data));
  }, []);

  return (
    <ul>
      {users.map(user => <li key={user.id}>{user.name}</li>)}
    </ul>
  );
}
```

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚ùå API call ch·∫°y tr√™n **browser** (client-side)
- ‚ùå Ng∆∞·ªùi d√πng th·∫•y loading spinner
- ‚ùå Kh√¥ng t·ªët cho SEO (Google bot kh√¥ng ƒë·ª£i API)
- ‚ùå API keys b·ªã l·ªô (n·∫øu g·ªçi API c·∫ßn authentication)

---

###### Next.js Server Components (Server-side API calls)

```jsx
// Next.js Server Component
async function getUsers() {
  const res = await fetch('https://api.example.com/users');
  return res.json();
}

export default async function UsersPage() {
  const users = await getUsers();  // Ch·∫°y tr√™n server!

  return (
    <ul>
      {users.map(user => <li key={user.id}>{user.name}</li>)}
    </ul>
  );
}
```

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ API call ch·∫°y tr√™n **server** (server-side)
- ‚úÖ HTML ƒë√£ c√≥ data khi g·ª≠i v·ªÅ browser ‚Üí Kh√¥ng loading
- ‚úÖ T·ªët cho SEO
- ‚úÖ C√≥ th·ªÉ d√πng API keys an to√†n (kh√¥ng l·ªô ra browser)

---

##### E. API Routes trong Next.js

**API Routes** cho ph√©p b·∫°n t·∫°o backend API ngay trong Next.js project, kh√¥ng c·∫ßn server ri√™ng (Express, Node.js).

**Mental Model: Nh√† h√†ng t·ª± ph·ª•c v·ª•**
- Tr∆∞·ªõc ƒë√¢y: Frontend (nh√† h√†ng) + Backend ri√™ng (b·∫øp ·ªü t√≤a nh√† kh√°c)
- Next.js: Frontend + Backend c√πng 1 ch·ªó (b·∫øp ngay trong nh√† h√†ng)

**C·∫•u tr√∫c th∆∞ m·ª•c:**

```
src/app/
‚îú‚îÄ‚îÄ page.js              ‚Üí Frontend: http://localhost:3000/
‚îú‚îÄ‚îÄ about/page.js        ‚Üí Frontend: http://localhost:3000/about
‚îî‚îÄ‚îÄ api/                 ‚Üí Backend API
    ‚îú‚îÄ‚îÄ users/
    ‚îÇ   ‚îî‚îÄ‚îÄ route.js     ‚Üí API: http://localhost:3000/api/users
    ‚îî‚îÄ‚îÄ posts/
        ‚îî‚îÄ‚îÄ route.js     ‚Üí API: http://localhost:3000/api/posts
```

**Quy t·∫Øc:**
- File trong `app/api/` ‚Üí T·∫°o API endpoint
- File ph·∫£i t√™n `route.js` (ho·∫∑c `route.ts`)
- Export c√°c h√†m: `GET`, `POST`, `PATCH`, `DELETE`

---

##### F. Endpoint l√† g√¨?

**Endpoint** l√† m·ªôt URL c·ª• th·ªÉ m√† b·∫°n c√≥ th·ªÉ g·ªçi ƒë·ªÉ l·∫•y/g·ª≠i data.

**V√≠ d·ª•:**
```
https://api.example.com/users       ‚Üê Endpoint 1
https://api.example.com/users/5     ‚Üê Endpoint 2
https://api.example.com/posts       ‚Üê Endpoint 3
```

**Mental Model: ƒê·ªãa ch·ªâ nh√†**
- API = Khu ph·ªë
- Endpoint = ƒê·ªãa ch·ªâ c·ª• th·ªÉ c·ªßa t·ª´ng ng√¥i nh√†

---

##### G. Static vs Dynamic API Routes

###### 1. Static API Route (URL c·ªë ƒë·ªãnh)

**V√≠ d·ª•:** `/api/users` - Lu√¥n tr·∫£ v·ªÅ danh s√°ch t·∫•t c·∫£ users

```
File: src/app/api/users/route.js
URL:  http://localhost:3000/api/users
```

**ƒê·∫∑c ƒëi·ªÉm:**
- ‚úÖ URL kh√¥ng thay ƒë·ªïi
- ‚úÖ D√πng cho: Danh s√°ch, t·ªïng quan, th·ªëng k√™ chung

---

###### 2. Dynamic API Route (URL c√≥ tham s·ªë)

**V√≠ d·ª•:** `/api/users/[id]` - Tr·∫£ v·ªÅ user c·ª• th·ªÉ theo ID

```
File: src/app/api/users/[id]/route.js
URL:  http://localhost:3000/api/users/5
      http://localhost:3000/api/users/123
      http://localhost:3000/api/users/abc
```

**C√°ch ho·∫°t ƒë·ªông:**
- `[id]` = Placeholder (bi·∫øn)
- Next.js t·ª± ƒë·ªông extract gi√° tr·ªã t·ª´ URL
- B·∫°n nh·∫≠n ƒë∆∞·ª£c qua `params.id`

**So s√°nh:**

| Lo·∫°i | File Path | URL | Khi n√†o d√πng |
|---|---|---|---|
| **Static** | `api/users/route.js` | `/api/users` | L·∫•y danh s√°ch |
| **Dynamic** | `api/users/[id]/route.js` | `/api/users/5` | L·∫•y 1 item c·ª• th·ªÉ |
| **Nested Dynamic** | `api/users/[id]/posts/[postId]/route.js` | `/api/users/5/posts/10` | L·∫•y post 10 c·ªßa user 5 |

**V√≠ d·ª• th·ª±c t·∫ø:**

```javascript
// Static Route
// File: src/app/api/products/route.js
export async function GET() {
  const products = await db.products.findAll();
  return Response.json(products);
}
// URL: /api/products ‚Üí T·∫•t c·∫£ s·∫£n ph·∫©m

// Dynamic Route
// File: src/app/api/products/[id]/route.js
export async function GET(request, { params }) {
  const product = await db.products.findById(params.id);
  return Response.json(product);
}
// URL: /api/products/42 ‚Üí S·∫£n ph·∫©m ID 42
```

---

##### H. Request v√† Response trong API Routes

###### 1. Request Object

```javascript
export async function POST(request) {
  // 1. L·∫•y body (JSON)
  const body = await request.json();
  
  // 2. L·∫•y query params (?search=abc)
  const searchParams = request.nextUrl.searchParams;
  const query = searchParams.get('search');
  
  // 3. L·∫•y headers
  const token = request.headers.get('authorization');
  
  console.log({ body, query, token });
  
  return Response.json({ success: true });
}
```

**V√≠ d·ª• g·ªçi:**
```javascript
fetch('/api/users?search=An', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer abc123'
  },
  body: JSON.stringify({ name: 'An', age: 25 })
});

// Server nh·∫≠n:
// body = { name: 'An', age: 25 }
// query = 'An'
// token = 'Bearer abc123'
```

---

###### 2. Response Object

```javascript
export async function GET() {
  // 1. Tr·∫£ v·ªÅ JSON (c√°ch ph·ªï bi·∫øn nh·∫•t)
  return Response.json({ message: 'Hello' });
  
  // 2. Tr·∫£ v·ªÅ v·ªõi status code t√πy ch·ªânh
  return Response.json(
    { error: 'Not found' },
    { status: 404 }
  );
  
  // 3. Tr·∫£ v·ªÅ v·ªõi headers t√πy ch·ªânh
  return Response.json(
    { data: [...] },
    {
      status: 200,
      headers: {
        'Cache-Control': 'max-age=3600',
        'X-Custom-Header': 'value'
      }
    }
  );
}
```

**HTTP Status Codes ph·ªï bi·∫øn:**

| Code | √ù nghƒ©a | Khi n√†o d√πng |
|---|---|---|
| **200** | OK | Request th√†nh c√¥ng (GET, PATCH, DELETE) |
| **201** | Created | T·∫°o m·ªõi th√†nh c√¥ng (POST) |
| **204** | No Content | X√≥a th√†nh c√¥ng, kh√¥ng tr·∫£ data |
| **400** | Bad Request | Client g·ª≠i data sai format |
| **401** | Unauthorized | Ch∆∞a ƒëƒÉng nh·∫≠p |
| **403** | Forbidden | Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p |
| **404** | Not Found | Resource kh√¥ng t·ªìn t·∫°i |
| **500** | Internal Server Error | L·ªói server (bug trong code) |

---

##### I. T√≥m t·∫Øt: Lu·ªìng ho·∫°t ƒë·ªông c·ªßa API

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Browser   ‚îÇ                    ‚îÇ  Next.js    ‚îÇ                    ‚îÇ  Database   ‚îÇ
‚îÇ  (Client)   ‚îÇ                    ‚îÇ API Route   ‚îÇ                    ‚îÇ             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ                                    ‚îÇ                                  ‚îÇ
      ‚îÇ  1. fetch('/api/users')            ‚îÇ                                  ‚îÇ
      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                                  ‚îÇ
      ‚îÇ                                    ‚îÇ                                  ‚îÇ
      ‚îÇ                                    ‚îÇ  2. Query database               ‚îÇ
      ‚îÇ                                    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
      ‚îÇ                                    ‚îÇ                                  ‚îÇ
      ‚îÇ                                    ‚îÇ  3. Return data                  ‚îÇ
      ‚îÇ                                    ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
      ‚îÇ                                    ‚îÇ                                  ‚îÇ
      ‚îÇ  4. Response.json(users)           ‚îÇ                                  ‚îÇ
      ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                                  ‚îÇ
      ‚îÇ                                    ‚îÇ                                  ‚îÇ
      ‚îÇ  5. Display data                   ‚îÇ                                  ‚îÇ
      ‚îÇ                                    ‚îÇ                                  ‚îÇ
```

**C√°c b∆∞·ªõc:**
1. **Client g·ª≠i request** ‚Üí URL + HTTP Method + Body (n·∫øu c√≥)
2. **API Route nh·∫≠n request** ‚Üí X·ª≠ l√Ω logic (query database, validate, etc.)
3. **Database tr·∫£ data** ‚Üí API Route nh·∫≠n k·∫øt qu·∫£
4. **API Route tr·∫£ response** ‚Üí JSON + Status Code
5. **Client nh·∫≠n response** ‚Üí Hi·ªÉn th·ªã data ho·∫∑c x·ª≠ l√Ω l·ªói

---

#### 7.1. V√≠ d·ª• th·ª±c h√†nh: API CRUD ho√†n ch·ªânh

##### Static Route: Danh s√°ch users

```javascript
// src/app/api/users/route.js

// Gi·∫£ l·∫≠p database
let users = [
  { id: 1, name: 'An', email: 'an@example.com' },
  { id: 2, name: 'B√¨nh', email: 'binh@example.com' },
];

// GET: L·∫•y t·∫•t c·∫£ users
export async function GET(request) {
  // H·ªó tr·ª£ search query: /api/users?search=An
  const searchParams = request.nextUrl.searchParams;
  const search = searchParams.get('search');
  
  let result = users;
  if (search) {
    result = users.filter(u => 
      u.name.toLowerCase().includes(search.toLowerCase())
    );
  }
  
  return Response.json(result);
}

// POST: T·∫°o user m·ªõi
export async function POST(request) {
  const body = await request.json();
  
  // Validation
  if (!body.name || !body.email) {
    return Response.json(
      { error: 'Name and email are required' },
      { status: 400 }
    );
  }
  
  // T·∫°o user m·ªõi
  const newUser = {
    id: users.length + 1,
    name: body.name,
    email: body.email
  };
  
  users.push(newUser);
  
  return Response.json(newUser, { status: 201 });
}
```

**C√°ch g·ªçi t·ª´ Frontend:**

```javascript
// GET: L·∫•y t·∫•t c·∫£ users
fetch('/api/users')
  .then(res => res.json())
  .then(data => console.log(data));

// GET: Search users
fetch('/api/users?search=An')
  .then(res => res.json())
  .then(data => console.log(data));

// POST: T·∫°o user m·ªõi
fetch('/api/users', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: 'C∆∞·ªùng', email: 'cuong@example.com' })
})
  .then(res => res.json())
  .then(data => console.log(data));
```

---

##### Dynamic Route: User c·ª• th·ªÉ

```javascript
// src/app/api/users/[id]/route.js

// Gi·∫£ l·∫≠p database (trong th·ª±c t·∫ø d√πng chung v·ªõi route.js ·ªü tr√™n)
let users = [
  { id: 1, name: 'An', email: 'an@example.com' },
  { id: 2, name: 'B√¨nh', email: 'binh@example.com' },
];

// GET: L·∫•y 1 user theo ID
export async function GET(request, { params }) {
  const userId = parseInt(params.id);
  const user = users.find(u => u.id === userId);
  
  if (!user) {
    return Response.json(
      { error: 'User not found' },
      { status: 404 }
    );
  }
  
  return Response.json(user);
}

// PATCH: C·∫≠p nh·∫≠t user
export async function PATCH(request, { params }) {
  const userId = parseInt(params.id);
  const body = await request.json();
  
  const userIndex = users.findIndex(u => u.id === userId);
  
  if (userIndex === -1) {
    return Response.json(
      { error: 'User not found' },
      { status: 404 }
    );
  }
  
  // C·∫≠p nh·∫≠t (ch·ªâ c√°c field ƒë∆∞·ª£c g·ª≠i l√™n)
  users[userIndex] = {
    ...users[userIndex],
    ...body
  };
  
  return Response.json(users[userIndex]);
}

// DELETE: X√≥a user
export async function DELETE(request, { params }) {
  const userId = parseInt(params.id);
  const userIndex = users.findIndex(u => u.id === userId);
  
  if (userIndex === -1) {
    return Response.json(
      { error: 'User not found' },
      { status: 404 }
    );
  }
  
  users.splice(userIndex, 1);
  
  return Response.json(
    { message: 'User deleted successfully' },
    { status: 200 }
  );
}
```

**C√°ch g·ªçi t·ª´ Frontend:**

```javascript
// GET: L·∫•y user ID 1
fetch('/api/users/1')
  .then(res => res.json())
  .then(data => console.log(data));

// PATCH: C·∫≠p nh·∫≠t user ID 1
fetch('/api/users/1', {
  method: 'PATCH',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: 'An Nguy·ªÖn' })
})
  .then(res => res.json())
  .then(data => console.log(data));

// DELETE: X√≥a user ID 1
fetch('/api/users/1', {
  method: 'DELETE'
})
  .then(res => res.json())
  .then(data => console.log(data));
```

---

#### 7.2. V√≠ d·ª• ƒë∆°n gi·∫£n h∆°n (cho ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu)

##### V√≠ d·ª•: API tr·∫£ v·ªÅ danh s√°ch users

```javascript
// src/app/api/users/route.js

export async function GET(request) {
  const users = [
    { id: 1, name: 'An' },
    { id: 2, name: 'B√¨nh' },
  ];
  
  return Response.json(users);
}

export async function POST(request) {
  const body = await request.json();
  
  // L∆∞u v√†o database (gi·∫£ l·∫≠p)
  console.log('New user:', body);
  
  return Response.json({ success: true, data: body }, { status: 201 });
}
```

**Truy c·∫≠p:**
- GET: `http://localhost:3000/api/users`
- POST: `http://localhost:3000/api/users` (v·ªõi body JSON)

---

#### V√≠ d·ª•: Dynamic API Route

```javascript
// src/app/api/users/[id]/route.js

export async function GET(request, { params }) {
  const userId = params.id;
  
  // Gi·∫£ l·∫≠p fetch t·ª´ database
  const user = { id: userId, name: 'User ' + userId };
  
  return Response.json(user);
}
```

**Truy c·∫≠p:** `http://localhost:3000/api/users/5` ‚Üí `{ id: "5", name: "User 5" }`

---

### 8. Loading v√† Error Handling

#### 8.1. Loading UI

```jsx
// src/app/blog/loading.js

export default function Loading() {
  return (
    <div>
      <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
      <div className="spinner"></div>
    </div>
  );
}
```

**C∆° ch·∫ø:** Khi `/blog` ƒëang fetch data, Next.js t·ª± ƒë·ªông hi·ªÉn th·ªã `loading.js`.

---

#### 8.2. Error UI

```jsx
// src/app/blog/error.js
'use client';  // Error components ph·∫£i l√† Client Component

export default function Error({ error, reset }) {
  return (
    <div>
      <h2>C√≥ l·ªói x·∫£y ra!</h2>
      <p>{error.message}</p>
      <button onClick={() => reset()}>Th·ª≠ l·∫°i</button>
    </div>
  );
}
```

**C∆° ch·∫ø:** N·∫øu `page.js` throw error, Next.js hi·ªÉn th·ªã `error.js`.

---

### 9. Deployment: Vercel (1-Click Deploy)

#### B∆∞·ªõc 1: Push code l√™n GitHub

```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/username/my-app.git
git push -u origin main
```

#### B∆∞·ªõc 2: Deploy l√™n Vercel

1. Truy c·∫≠p: [vercel.com](https://vercel.com)
2. ƒêƒÉng nh·∫≠p b·∫±ng GitHub
3. Click **"New Project"**
4. Ch·ªçn repository `my-app`
5. Click **"Deploy"**

**K·∫øt qu·∫£:** Sau 1-2 ph√∫t, app c·ªßa b·∫°n s·∫Ω live t·∫°i `https://my-app.vercel.app`

**T·ª± ƒë·ªông deploy:** M·ªói l·∫ßn push code l√™n GitHub ‚Üí Vercel t·ª± ƒë·ªông deploy l·∫°i.

---

### 10. State Management: Qu·∫£n l√Ω tr·∫°ng th√°i to√†n c·ª•c

#### 10.1. T·∫°i sao c·∫ßn State Management Libraries?

**V·∫•n ƒë·ªÅ v·ªõi Context API:**

Context API (ƒë√£ h·ªçc ·ªü Ph·∫ßn 5) t·ªët cho:
- ‚úÖ Chia s·∫ª data ƒë∆°n gi·∫£n (theme, user info)
- ‚úÖ ·ª®ng d·ª•ng nh·ªè, v·ª´a

Nh∆∞ng c√≥ h·∫°n ch·∫ø:
- ‚ùå Re-render kh√¥ng c·∫ßn thi·∫øt (m·ªçi component d√πng context ƒë·ªÅu re-render khi context thay ƒë·ªïi)
- ‚ùå Kh√¥ng c√≥ DevTools ƒë·ªÉ debug
- ‚ùå Kh√≥ t·ªï ch·ª©c code khi app l·ªõn

**Gi·∫£i ph√°p:** D√πng State Management Libraries chuy√™n nghi·ªáp.

---

#### 10.2. Redux vs Zustand

| Ti√™u ch√≠ | Redux | Zustand |
|---|---|---|
| **ƒê·ªô ph·ª©c t·∫°p** | Cao (nhi·ªÅu boilerplate) | Th·∫•p (code √≠t h∆°n) |
| **Learning curve** | Kh√≥ | D·ªÖ |
| **DevTools** | ‚úÖ M·∫°nh m·∫Ω | ‚úÖ C√≥ |
| **Performance** | T·ªët | T·ªët h∆°n |
| **Khi n√†o d√πng?** | App l·ªõn, team l·ªõn | App v·ª´a/nh·ªè, c·∫ßn ƒë∆°n gi·∫£n |

**Khuy·∫øn ngh·ªã:** B·∫Øt ƒë·∫ßu v·ªõi **Zustand** (d·ªÖ h·ªçc h∆°n), sau ƒë√≥ h·ªçc Redux n·∫øu c·∫ßn.

---

#### 10.3. Zustand - State Management ƒë∆°n gi·∫£n

##### A. C√†i ƒë·∫∑t

```bash
npm install zustand
```

##### B. T·∫°o Store (Kho l∆∞u tr·ªØ state)

```javascript
// src/store/useCartStore.js
import { create } from 'zustand';

const useCartStore = create((set) => ({
  // State
  items: [],
  totalPrice: 0,
  
  // Actions (H√†nh ƒë·ªông thay ƒë·ªïi state)
  addItem: (product) => set((state) => ({
    items: [...state.items, product],
    totalPrice: state.totalPrice + product.price
  })),
  
  removeItem: (productId) => set((state) => ({
    items: state.items.filter(item => item.id !== productId),
    totalPrice: state.items
      .filter(item => item.id !== productId)
      .reduce((sum, item) => sum + item.price, 0)
  })),
  
  clearCart: () => set({ items: [], totalPrice: 0 })
}));

export default useCartStore;
```

##### C. S·ª≠ d·ª•ng trong Component

```jsx
// src/components/ProductCard.js
'use client';

import useCartStore from '@/store/useCartStore';

export default function ProductCard({ product }) {
  const addItem = useCartStore((state) => state.addItem);
  
  return (
    <div>
      <h3>{product.name}</h3>
      <p>${product.price}</p>
      <button onClick={() => addItem(product)}>
        Th√™m v√†o gi·ªè h√†ng
      </button>
    </div>
  );
}
```

```jsx
// src/components/Cart.js
'use client';

import useCartStore from '@/store/useCartStore';

export default function Cart() {
  const items = useCartStore((state) => state.items);
  const totalPrice = useCartStore((state) => state.totalPrice);
  const removeItem = useCartStore((state) => state.removeItem);
  const clearCart = useCartStore((state) => state.clearCart);
  
  return (
    <div>
      <h2>Gi·ªè h√†ng ({items.length} s·∫£n ph·∫©m)</h2>
      
      {items.map(item => (
        <div key={item.id}>
          <span>{item.name} - ${item.price}</span>
          <button onClick={() => removeItem(item.id)}>X√≥a</button>
        </div>
      ))}
      
      <p>T·ªïng: ${totalPrice}</p>
      <button onClick={clearCart}>X√≥a t·∫•t c·∫£</button>
    </div>
  );
}
```

**∆Øu ƒëi·ªÉm Zustand:**
- ‚úÖ Code ng·∫Øn g·ªçn, d·ªÖ hi·ªÉu
- ‚úÖ Kh√¥ng c·∫ßn Provider wrapper
- ‚úÖ T·ª± ƒë·ªông t·ªëi ∆∞u re-render (ch·ªâ component d√πng state n√†o th√¨ re-render khi state ƒë√≥ thay ƒë·ªïi)

---

#### 10.4. Redux Toolkit - State Management cho App l·ªõn

##### A. C√†i ƒë·∫∑t

```bash
npm install @reduxjs/toolkit react-redux
```

##### B. T·∫°o Slice (Ph·∫ßn state)

```javascript
// src/store/cartSlice.js
import { createSlice } from '@reduxjs/toolkit';

const cartSlice = createSlice({
  name: 'cart',
  initialState: {
    items: [],
    totalPrice: 0
  },
  reducers: {
    addItem: (state, action) => {
      state.items.push(action.payload);
      state.totalPrice += action.payload.price;
    },
    removeItem: (state, action) => {
      const index = state.items.findIndex(item => item.id === action.payload);
      if (index !== -1) {
        state.totalPrice -= state.items[index].price;
        state.items.splice(index, 1);
      }
    },
    clearCart: (state) => {
      state.items = [];
      state.totalPrice = 0;
    }
  }
});

export const { addItem, removeItem, clearCart } = cartSlice.actions;
export default cartSlice.reducer;
```

##### C. T·∫°o Store

```javascript
// src/store/store.js
import { configureStore } from '@reduxjs/toolkit';
import cartReducer from './cartSlice';

export const store = configureStore({
  reducer: {
    cart: cartReducer
  }
});
```

##### D. Setup Provider (Next.js App Router)

```jsx
// src/app/layout.js
'use client';

import { Provider } from 'react-redux';
import { store } from '@/store/store';

export default function RootLayout({ children }) {
  return (
    <html lang="vi">
      <body>
        <Provider store={store}>
          {children}
        </Provider>
      </body>
    </html>
  );
}
```

##### E. S·ª≠ d·ª•ng trong Component

```jsx
// src/components/ProductCard.js
'use client';

import { useDispatch } from 'react-redux';
import { addItem } from '@/store/cartSlice';

export default function ProductCard({ product }) {
  const dispatch = useDispatch();
  
  return (
    <div>
      <h3>{product.name}</h3>
      <p>${product.price}</p>
      <button onClick={() => dispatch(addItem(product))}>
        Th√™m v√†o gi·ªè h√†ng
      </button>
    </div>
  );
}
```

```jsx
// src/components/Cart.js
'use client';

import { useSelector, useDispatch } from 'react-redux';
import { removeItem, clearCart } from '@/store/cartSlice';

export default function Cart() {
  const items = useSelector((state) => state.cart.items);
  const totalPrice = useSelector((state) => state.cart.totalPrice);
  const dispatch = useDispatch();
  
  return (
    <div>
      <h2>Gi·ªè h√†ng ({items.length} s·∫£n ph·∫©m)</h2>
      
      {items.map(item => (
        <div key={item.id}>
          <span>{item.name} - ${item.price}</span>
          <button onClick={() => dispatch(removeItem(item.id))}>X√≥a</button>
        </div>
      ))}
      
      <p>T·ªïng: ${totalPrice}</p>
      <button onClick={() => dispatch(clearCart())}>X√≥a t·∫•t c·∫£</button>
    </div>
  );
}
```

**Khi n√†o d√πng Redux?**
- ‚úÖ App c√≥ nhi·ªÅu state ph·ª©c t·∫°p
- ‚úÖ C·∫ßn time-travel debugging (xem l·∫°i l·ªãch s·ª≠ thay ƒë·ªïi state)
- ‚úÖ Team l·ªõn, c·∫ßn quy chu·∫©n code

---

#### 10.5. So s√°nh Context API vs Zustand vs Redux

| T√≠nh nƒÉng | Context API | Zustand | Redux Toolkit |
|---|---|---|---|
| **Setup** | D·ªÖ | D·ªÖ | Trung b√¨nh |
| **Boilerplate** | √çt | R·∫•t √≠t | Trung b√¨nh |
| **Performance** | ‚ö†Ô∏è Re-render nhi·ªÅu | ‚úÖ T·ªëi ∆∞u | ‚úÖ T·ªëi ∆∞u |
| **DevTools** | ‚ùå Kh√¥ng | ‚úÖ C√≥ | ‚úÖ M·∫°nh m·∫Ω |
| **Learning Curve** | D·ªÖ | D·ªÖ | Kh√≥ h∆°n |
| **Use Case** | App nh·ªè | App v·ª´a | App l·ªõn |

**L·ªô tr√¨nh h·ªçc:**
1. Context API (ƒë√£ h·ªçc ·ªü Ph·∫ßn 5)
2. Zustand (h·ªçc ti·∫øp)
3. Redux Toolkit (n·∫øu c·∫ßn)

---

### 11. Authentication: X√°c th·ª±c ng∆∞·ªùi d√πng v·ªõi NextAuth.js

#### 11.1. T·∫°i sao c·∫ßn Authentication?

**Authentication (X√°c th·ª±c)** l√† qu√° tr√¨nh x√°c ƒë·ªãnh "b·∫°n l√† ai" (ƒëƒÉng nh·∫≠p).

**Use cases:**
- ƒêƒÉng nh·∫≠p/ƒêƒÉng k√Ω
- B·∫£o v·ªá trang (ch·ªâ user ƒë√£ ƒëƒÉng nh·∫≠p m·ªõi xem ƒë∆∞·ª£c)
- Ph√¢n quy·ªÅn (admin, user th∆∞·ªùng)

---

#### 11.2. NextAuth.js - Gi·∫£i ph√°p Authentication cho Next.js

**NextAuth.js** l√† th∆∞ vi·ªán authentication ch√≠nh th·ª©c cho Next.js.

**T√≠nh nƒÉng:**
- ‚úÖ ƒêƒÉng nh·∫≠p b·∫±ng Email/Password
- ‚úÖ ƒêƒÉng nh·∫≠p b·∫±ng OAuth (Google, GitHub, Facebook)
- ‚úÖ Session management
- ‚úÖ JWT tokens
- ‚úÖ Database integration

---
##### A. C√†i ƒë·∫∑t

```bash
npm install next-auth
```

##### B. T·∫°o API Route cho NextAuth

```javascript
// src/app/api/auth/[...nextauth]/route.js
import NextAuth from 'next-auth';
import GoogleProvider from 'next-auth/providers/google';
import CredentialsProvider from 'next-auth/providers/credentials';

const handler = NextAuth({
  providers: [
    // 1. ƒêƒÉng nh·∫≠p b·∫±ng Google
    GoogleProvider({
      clientId: process.env.GOOGLE_CLIENT_ID,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET,
    }),
    
    // 2. ƒêƒÉng nh·∫≠p b·∫±ng Email/Password
    CredentialsProvider({
      name: 'Credentials',
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" }
      },
      async authorize(credentials) {
        // Ki·ªÉm tra email/password (v√≠ d·ª• ƒë∆°n gi·∫£n)
        if (credentials.email === 'user@example.com' && credentials.password === '123456') {
          return { id: 1, name: 'User', email: 'user@example.com' };
        }
        return null;  // ƒêƒÉng nh·∫≠p th·∫•t b·∫°i
      }
    })
  ],
  
  // T√πy ch·ªânh pages
  pages: {
    signIn: '/login',  // Trang ƒëƒÉng nh·∫≠p t√πy ch·ªânh
  },
  
  // Callbacks
  callbacks: {
    async session({ session, token }) {
      session.user.id = token.sub;
      return session;
    }
  },
  
  // Secret key (t·∫°o b·∫±ng: openssl rand -base64 32)
  secret: process.env.NEXTAUTH_SECRET,
});

export { handler as GET, handler as POST };
```

##### C. T·∫°o file .env.local

```bash
# .env.local

# NextAuth
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-secret-key-here

# Google OAuth (l·∫•y t·ª´ Google Cloud Console)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
```

##### D. T·∫°o trang ƒëƒÉng nh·∫≠p

```jsx
// src/app/login/page.js
'use client';

import { signIn } from 'next-auth/react';
import { useState } from 'react';

export default function LoginPage() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  
  const handleSubmit = async (e) => {
    e.preventDefault();
    
    const result = await signIn('credentials', {
      email,
      password,
      redirect: true,
      callbackUrl: '/dashboard'
    });
  };
  
  return (
    <div>
      <h1>ƒêƒÉng nh·∫≠p</h1>
      
      {/* ƒêƒÉng nh·∫≠p b·∫±ng Google */}
      <button onClick={() => signIn('google', { callbackUrl: '/dashboard' })}>
        ƒêƒÉng nh·∫≠p b·∫±ng Google
      </button>
      
      <hr />
      
      {/* ƒêƒÉng nh·∫≠p b·∫±ng Email/Password */}
      <form onSubmit={handleSubmit}>
        <input
          type="email"
          placeholder="Email"
          value={email}
          onChange={(e) => setEmail(e.target.value)}
        />
        <input
          type="password"
          placeholder="Password"
          value={password}
          onChange={(e) => setPassword(e.target.value)}
        />
        <button type="submit">ƒêƒÉng nh·∫≠p</button>
      </form>
    </div>
  );
}
```

##### E. S·ª≠ d·ª•ng Session trong Component

```jsx
// src/components/UserProfile.js
'use client';

import { useSession, signOut } from 'next-auth/react';

export default function UserProfile() {
  const { data: session, status } = useSession();
  
  if (status === 'loading') {
    return <p>ƒêang t·∫£i...</p>;
  }
  
  if (status === 'unauthenticated') {
    return <p>B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p</p>;
  }
  
  return (
    <div>
      <p>Xin ch√†o, {session.user.name}!</p>
      <p>Email: {session.user.email}</p>
      <button onClick={() => signOut()}>ƒêƒÉng xu·∫•t</button>
    </div>
  );
}
```

##### F. B·∫£o v·ªá trang (Protected Route)

```jsx
// src/app/dashboard/page.js
import { getServerSession } from 'next-auth';
import { redirect } from 'next/navigation';

export default async function DashboardPage() {
  const session = await getServerSession();
  
  // N·∫øu ch∆∞a ƒëƒÉng nh·∫≠p ‚Üí Redirect v·ªÅ trang login
  if (!session) {
    redirect('/login');
  }
  
  return (
    <div>
      <h1>Dashboard</h1>
      <p>Ch√†o m·ª´ng, {session.user.name}!</p>
    </div>
  );
}
```

##### G. B·∫£o v·ªá API Route

```javascript
// src/app/api/protected/route.js
import { getServerSession } from 'next-auth';

export async function GET(request) {
  const session = await getServerSession();
  
  if (!session) {
    return Response.json(
      { error: 'Unauthorized' },
      { status: 401 }
    );
  }
  
  // User ƒë√£ ƒëƒÉng nh·∫≠p
  return Response.json({
    message: 'Protected data',
    user: session.user
  });
}

```

---

#### 11.3. Deep Dive: C∆° ch·∫ø Session Authentication (Browser ‚Üî Server)

> **Mental Model:** Session gi·ªëng nh∆∞ **V√© xem phim**. Khi v√†o r·∫°p (login), b·∫°n nh·∫≠n v√© (cookie). M·ªói l·∫ßn v√†o ph√≤ng chi·∫øu (request), b·∫°n ƒë∆∞a v√© ‚Üí nh√¢n vi√™n check (server validate) ‚Üí cho v√†o.

Tr∆∞·ªõc khi h·ªçc NextAuth.js, c·∫ßn hi·ªÉu b·∫£n ch·∫•t c·ªßa session authentication ·ªü m·ª©c HTTP. ƒê√¢y l√† ki·∫øn th·ª©c n·ªÅn t·∫£ng √°p d·ª•ng cho m·ªçi framework.

---

##### A. Tr∆∞·ªõc khi ƒëƒÉng nh·∫≠p: M·ªçi request ƒë·ªÅu "·∫©n danh"

**Browser ‚Üí Server**

Khi visitor m·ªõi m·ªü site l·∫ßn ƒë·∫ßu:

```http
GET /dashboard HTTP/1.1
Host: example.com
```

**V·∫•n ƒë·ªÅ:** Kh√¥ng c√≥ cookie, server kh√¥ng bi·∫øt b·∫°n l√† ai.

**Server ‚Üí Browser**

Server ph·∫£n h·ªìi:
- Hi·ªÉn th·ªã trang public, ho·∫∑c
- Redirect v·ªÅ trang login:

```http
HTTP/1.1 302 Found
Location: /login
```

---

##### B. B∆∞·ªõc ƒëƒÉng nh·∫≠p: Server t·∫°o Session

User submit form ƒëƒÉng nh·∫≠p (ho·∫∑c ho√†n t·∫•t Google login callback).

**Browser ‚Üí Server**

```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded

email=phuong@example.com&password=....
```

**Server internal actions (quan tr·ªçng)**

Server th·ª±c hi·ªán:

1. **Verify credentials** (ho·∫∑c verify Google identity)
2. **T·∫°o session object** trong server storage (DB/Redis/memory):

```javascript
// Example internal storage
session_id = "a8f3c9...random..."  // Random string (kh√¥ng c√≥ √Ω nghƒ©a)

session_store[a8f3c9...] = {
  user_id: 123,
  created_at: "2026-01-31T10:00:00Z",
  expires_at: "2026-02-07T10:00:00Z",  // 7 ng√†y sau
  roles: ["admin"]
}
```

> **Key point:** `session_id` ch·ªâ l√† kh√≥a random, v√¥ nghƒ©a n·∫øu ƒë·ª©ng ri√™ng. Gi√° tr·ªã th·∫≠t n·∫±m trong `session_store`.

**Server ‚Üí Browser (Set-Cookie)**

Server reply v·ªõi header `Set-Cookie`:

```http
HTTP/1.1 302 Found
Set-Cookie: session_id=a8f3c9...; Path=/; HttpOnly; Secure; SameSite=Lax
Location: /dashboard
```

Browser l∆∞u cookie n√†y.

**Cookie properties (n·ªÅn t·∫£ng b·∫£o m·∫≠t):**

| Property | √ù nghƒ©a | T·∫°i sao quan tr·ªçng |
|---|---|---|
| `HttpOnly` | JavaScript kh√¥ng th·ªÉ ƒë·ªçc cookie | ‚úÖ Reduce XSS theft (n·∫øu hacker inject JS, kh√¥ng l·∫•y ƒë∆∞·ª£c cookie) |
| `Secure` | Ch·ªâ g·ª≠i qua HTTPS | ‚úÖ Prevent man-in-the-middle attacks (HTTP plain text) |
| `SameSite=Lax` | Cookie kh√¥ng g·ª≠i t·ª´ external sites | ‚úÖ Reduce CSRF (Cross-Site Request Forgery) |
| `Path=/` | Cookie g·ª≠i cho t·∫•t c·∫£ routes | ‚úÖ Apply to whole app |

---

##### C. Sau khi ƒëƒÉng nh·∫≠p: Browser t·ª± ƒë·ªông g·ª≠i Cookie m·ªçi request

User truy c·∫≠p `/dashboard`.

**Browser ‚Üí Server (Automatic)**

Browser **t·ª± ƒë·ªông** g·∫Øn cookie v√†o request:

```http
GET /dashboard HTTP/1.1
Host: example.com
Cookie: session_id=a8f3c9...
```

> **Quan tr·ªçng:** Developer kh√¥ng c·∫ßn code g√¨. Browser engine t·ª± l√†m.

**Server internal actions**

Server:

1. ƒê·ªçc `session_id` t·ª´ cookie header
2. Lookup trong session store: `session_store[a8f3c9...]`
3. L·∫•y ƒë∆∞·ª£c `user_id=123`
4. Load user data/roles n·∫øu c·∫ßn
5. Allow access

**Server ‚Üí Browser**

```http
HTTP/1.1 200 OK
Content-Type: text/html

<!DOCTYPE html>
<html>
  <h1>Welcome, Phuong!</h1>
  ...
</html>
```

**T·ª´ gi·ªù tr·ªü ƒëi, m·ªçi request ƒë·ªÅu c√≥ "ch·ª©ng minh":**
- Cookie ch·ª©a `session_id`
- Server map n√≥ v·ªÅ user

---

##### D. Session Expiration: C∆° ch·∫ø "t·ª± ƒë·ªông ƒëƒÉng xu·∫•t"

Sessions c√≥ th·ªùi h·∫°n s·ª≠ d·ª•ng:

**1. Server-side expiry**

```javascript
session_store[a8f3c9...] = {
  expires_at: "2026-02-07T10:00:00Z"  // 7 ng√†y
}
```

**2. Cookie expiry (optional)**

```http
Set-Cookie: session_id=a8f3c9...; Expires=Fri, 07 Feb 2026 10:00:00 GMT
```

ho·∫∑c d√πng **session cookie** (x√≥a khi ƒë√≥ng browser):

```http
Set-Cookie: session_id=a8f3c9...; (no Expires)
```

**Validation m·ªói request:**

```javascript
// Server checks
if (session.expires_at < now) {
  // Session expired ‚Üí Treat as logged out
  redirect('/login');
}
```

---

##### E. Logout: C√°ch ho·∫°t ƒë·ªông

Logout ph·∫£i l√†m **2 vi·ªác**:

**1. Kill server-side session**

```javascript
// Delete from storage
delete session_store[a8f3c9...];
```

**2. Remove cookie in browser**

Server g·ª≠i header x√≥a cookie:

```http
HTTP/1.1 302 Found
Set-Cookie: session_id=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT
Location: /login
```

> **T·∫°i sao ph·∫£i l√†m c·∫£ 2?**  
> - N·∫øu ch·ªâ x√≥a cookie ‚Üí Hacker c√≥ backup cookie v·∫´n d√πng ƒë∆∞·ª£c (server v·∫´n c√≥ session)
> - N·∫øu ch·ªâ x√≥a server session ‚Üí Cookie v·∫´n g·ª≠i l√™n (d√π server reject)  
> ‚Üí **Ph·∫£i x√≥a c·∫£ 2** ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n

---

##### F. T·∫°i sao g·ªçi l√† "Stateful" Authentication?

Because server ph·∫£i **gi·ªØ tr·∫°ng th√°i (state)**:
- M·ªôt table/store ch·ª©a sessions (`session_id` ‚Üí `user_data`)
- Validation y√™u c·∫ßu lookup (database/Redis query)

**Th√°ch th·ª©c v·ªõi nhi·ªÅu servers:**

```
        Load Balancer
           ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚Üì             ‚Üì
Server 1      Server 2      Server 3
```

**V·∫•n ƒë·ªÅ:** User login ·ªü Server 1 ‚Üí Session l∆∞u ·ªü Server 1.  
Nh∆∞ng request ti·∫øp theo ‚Üí Load balancer route v·ªÅ Server 2 ‚Üí **Kh√¥ng t√¨m th·∫•y session!**

**Gi·∫£i ph√°p:** D√πng **shared session store** (Redis, database):

```
Server 1 ‚îÄ‚îÄ‚îê
Server 2 ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚Üí Redis (shared session store)
Server 3 ‚îÄ‚îÄ‚îò
```

T·∫•t c·∫£ servers ƒë·ªÅu ƒë·ªçc/ghi v√†o c√πng 1 Redis ‚Üí Session works across servers.

---

##### G. Mental Model ƒë∆°n gi·∫£n nh·∫•t

> **Cookie = Ch√¨a kh√≥a (`session_id`)**  
> **Server = T·ªß kh√≥a (session store)**

**M·ªói request:**
1. Browser ƒë∆∞a ch√¨a kh√≥a (cookie)
2. Server m·ªü t·ªß kh√≥a (lookup session)
3. Bi·∫øt b·∫°n l√† ai ‚Üí Cho ph√©p truy c·∫≠p

**Khi logout:**
1. Server v·ª©t ch√¨a kh√≥a (delete session)
2. Browser qu√™n ch√¨a kh√≥a (delete cookie)

---

##### H. So s√°nh: Stateful vs Stateless (JWT)

| Aspect | Stateful Session (Cookie-based) | Stateless JWT (Token-based) |
|---|---|---|
| **Storage** | Server l∆∞u session (DB/Redis) | Kh√¥ng l∆∞u g√¨, t·∫•t c·∫£ info trong token |
| **Validation** | Lookup database m·ªói request | Ch·ªâ verify signature (kh√¥ng query DB) |
| **Logout** | X√≥a session t·ª´ DB | Kh√¥ng th·ªÉ "x√≥a" token (ph·∫£i ƒë·ª£i expire) |
| **Scalability** | C·∫ßn shared storage (Redis) | D·ªÖ scale (stateless) |
| **Security** | Revoke ngay l·∫≠p t·ª©c (x√≥a session) | Kh√¥ng revoke ƒë∆∞·ª£c (token c√≤n h·∫°n v·∫´n valid) |

**Khi n√†o d√πng g√¨?**
- **Stateful Session:** Web apps truy·ªÅn th·ªëng, c·∫ßn revoke t·ª©c th√¨ (admin ban user)
- **JWT:** Mobile apps, microservices, kh√¥ng c·∫ßn revoke ngay

---

#### 11.3. OAuth v·ªõi Google - H∆∞·ªõng d·∫´n setup

**B∆∞·ªõc 1: T·∫°o Google OAuth Credentials**

1. Truy c·∫≠p: [Google Cloud Console](https://console.cloud.google.com/)
2. T·∫°o project m·ªõi
3. V√†o **APIs & Services** ‚Üí **Credentials**
4. Click **Create Credentials** ‚Üí **OAuth 2.0 Client ID**
5. Ch·ªçn **Web application**
6. Th√™m **Authorized redirect URIs**:
   - Development: `http://localhost:3000/api/auth/callback/google`
   - Production: `https://yourdomain.com/api/auth/callback/google`
7. Copy **Client ID** v√† **Client Secret** v√†o `.env.local`

**B∆∞·ªõc 2: Test**

```bash
npm run dev
```

Truy c·∫≠p `http://localhost:3000/login` ‚Üí Click "ƒêƒÉng nh·∫≠p b·∫±ng Google"

---

#### 11.4. Best Practices

**‚úÖ N√äN:**
- D√πng `NEXTAUTH_SECRET` m·∫°nh (random string)
- L∆∞u session v√†o database (production)
- Validate user input
- D√πng HTTPS (production)

**‚ùå KH√îNG N√äN:**
- Commit `.env.local` l√™n Git
- L∆∞u password d·∫°ng plain text
- D√πng HTTP (production)

---

### 12. Testing: Ki·ªÉm th·ª≠ ·ª©ng d·ª•ng

#### 12.1. T·∫°i sao c·∫ßn Testing?

**Testing** gi√∫p:
- ‚úÖ Ph√°t hi·ªán bug s·ªõm
- ‚úÖ T·ª± tin khi refactor code
- ‚úÖ Document code (test = v√≠ d·ª• s·ª≠ d·ª•ng)
- ‚úÖ Gi·∫£m bug ·ªü production

**C√°c lo·∫°i test:**
1. **Unit Test** - Test t·ª´ng function/component ri√™ng l·∫ª
2. **Integration Test** - Test nhi·ªÅu components ho·∫°t ƒë·ªông c√πng nhau
3. **E2E Test** - Test to√†n b·ªô user flow (nh∆∞ user th·∫≠t)

---

#### 12.2. Jest - Unit Testing

**Jest** l√† framework test ph·ªï bi·∫øn nh·∫•t cho JavaScript/React.

##### A. C√†i ƒë·∫∑t

```bash
npm install --save-dev jest @testing-library/react @testing-library/jest-dom
```

##### B. C·∫•u h√¨nh Jest

```javascript
// jest.config.js
const nextJest = require('next/jest');

const createJestConfig = nextJest({
  dir: './',
});

const customJestConfig = {
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  testEnvironment: 'jest-environment-jsdom',
};

module.exports = createJestConfig(customJestConfig);
```

```javascript
// jest.setup.js
import '@testing-library/jest-dom';
```

##### C. Vi·∫øt Unit Test

**Test m·ªôt function:**

```javascript
// src/lib/utils.js
export function add(a, b) {
  return a + b;
}

export function formatPrice(price) {
  return `$${price.toFixed(2)}`;
}
```

```javascript
// src/lib/utils.test.js
import { add, formatPrice } from './utils';

describe('Utils', () => {
  test('add() c·ªông 2 s·ªë', () => {
    expect(add(2, 3)).toBe(5);
    expect(add(-1, 1)).toBe(0);
  });
  
  test('formatPrice() format gi√° ti·ªÅn', () => {
    expect(formatPrice(10)).toBe('$10.00');
    expect(formatPrice(9.99)).toBe('$9.99');
  });
});
```

**Test m·ªôt Component:**

```jsx
// src/components/Button.js
export default function Button({ children, onClick, disabled }) {
  return (
    <button onClick={onClick} disabled={disabled}>
      {children}
    </button>
  );
}
```

```javascript
// src/components/Button.test.js
import { render, screen, fireEvent } from '@testing-library/react';
import Button from './Button';

describe('Button Component', () => {
  test('render text ƒë√∫ng', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });
  
  test('g·ªçi onClick khi click', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    
    fireEvent.click(screen.getByText('Click me'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });
  
  test('disabled khi c√≥ prop disabled', () => {
    render(<Button disabled>Click me</Button>);
    expect(screen.getByText('Click me')).toBeDisabled();
  });
});
```

##### D. Ch·∫°y tests

```bash
# Ch·∫°y t·∫•t c·∫£ tests
npm test

# Ch·∫°y tests v·ªõi coverage
npm test -- --coverage

# Ch·∫°y tests ·ªü watch mode
npm test -- --watch
```

---

#### 12.3. Cypress - End-to-End Testing

**Cypress** test ·ª©ng d·ª•ng nh∆∞ m·ªôt user th·∫≠t (m·ªü browser, click, nh·∫≠p text).

##### A. C√†i ƒë·∫∑t

```bash
npm install --save-dev cypress
```

##### B. Kh·ªüi t·∫°o Cypress

```bash
npx cypress open
```

##### C. Vi·∫øt E2E Test

```javascript
// cypress/e2e/login.cy.js

describe('Login Flow', () => {
  it('ƒëƒÉng nh·∫≠p th√†nh c√¥ng', () => {
    // 1. M·ªü trang login
    cy.visit('http://localhost:3000/login');
    
    // 2. Nh·∫≠p email
    cy.get('input[type="email"]').type('user@example.com');
    
    // 3. Nh·∫≠p password
    cy.get('input[type="password"]').type('123456');
    
    // 4. Click n√∫t ƒëƒÉng nh·∫≠p
    cy.get('button[type="submit"]').click();
    
    // 5. Ki·ªÉm tra redirect v·ªÅ dashboard
    cy.url().should('include', '/dashboard');
    
    // 6. Ki·ªÉm tra hi·ªÉn th·ªã t√™n user
    cy.contains('Xin ch√†o, User').should('be.visible');
  });
  
  it('hi·ªÉn th·ªã l·ªói khi sai password', () => {
    cy.visit('http://localhost:3000/login');
    
    cy.get('input[type="email"]').type('user@example.com');
    cy.get('input[type="password"]').type('wrong-password');
    cy.get('button[type="submit"]').click();
    
    // Ki·ªÉm tra hi·ªÉn th·ªã th√¥ng b√°o l·ªói
    cy.contains('Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng').should('be.visible');
  });
});
```

```javascript
// cypress/e2e/shopping-cart.cy.js

describe('Shopping Cart', () => {
  it('th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng', () => {
    cy.visit('http://localhost:3000/products');
    
    // Click n√∫t "Th√™m v√†o gi·ªè h√†ng" c·ªßa s·∫£n ph·∫©m ƒë·∫ßu ti√™n
    cy.get('[data-testid="add-to-cart"]').first().click();
    
    // Ki·ªÉm tra s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè h√†ng
    cy.get('[data-testid="cart-count"]').should('contain', '1');
    
    // M·ªü gi·ªè h√†ng
    cy.get('[data-testid="cart-icon"]').click();
    
    // Ki·ªÉm tra s·∫£n ph·∫©m c√≥ trong gi·ªè h√†ng
    cy.get('[data-testid="cart-item"]').should('have.length', 1);
  });
});
```

##### D. Ch·∫°y Cypress tests

```bash
# M·ªü Cypress UI
npx cypress open

# Ch·∫°y headless (CI/CD)
npx cypress run
```

---

#### 12.4. Best Practices

**Unit Tests:**
- ‚úÖ Test logic ph·ª©c t·∫°p (utils, helpers)
- ‚úÖ Test components c√≥ nhi·ªÅu states
- ‚úÖ Nhanh, ch·∫°y th∆∞·ªùng xuy√™n

**E2E Tests:**
- ‚úÖ Test user flows quan tr·ªçng (ƒëƒÉng nh·∫≠p, thanh to√°n)
- ‚úÖ Test tr∆∞·ªõc khi deploy
- ‚ö†Ô∏è Ch·∫≠m h∆°n unit tests

**Quy t·∫Øc v√†ng:**
- Vi·∫øt tests cho code quan tr·ªçng (authentication, payment)
- Kh√¥ng c·∫ßn test m·ªçi th·ª© (UI ƒë∆°n gi·∫£n kh√¥ng c·∫ßn test)
- Test behavior, kh√¥ng test implementation

---

#### 12.5. Test Coverage

**Coverage** = T·ª∑ l·ªá code ƒë∆∞·ª£c test.

```bash
npm test -- --coverage
```

**Output:**
```
--------------------|---------|----------|---------|---------|
File                | % Stmts | % Branch | % Funcs | % Lines |
--------------------|---------|----------|---------|---------|
All files           |   85.5  |   78.2   |   90.1  |   85.5  |
 components/        |   92.3  |   85.7   |   100   |   92.3  |
  Button.js         |   100   |   100    |   100   |   100   |
  Card.js           |   85.7  |   75     |   100   |   85.7  |
 lib/               |   78.9  |   70.5   |   80.2  |   78.9  |
  utils.js          |   100   |   100    |   100   |   100   |
--------------------|---------|----------|---------|---------|
```

**M·ª•c ti√™u:** 70-80% coverage l√† t·ªët. 100% kh√¥ng c·∫ßn thi·∫øt.

---

### 13. So s√°nh Next.js vs React thu·∫ßn

| T√≠nh nƒÉng | React (CRA) | Next.js |
|---|---|---|
| **Routing** | C·∫ßn c√†i `react-router-dom` | ‚úÖ Built-in, file-based |
| **SEO** | ‚ùå K√©m (CSR) | ‚úÖ T·ªët (SSR/SSG) |
| **Performance** | Ph·∫£i t·ª± t·ªëi ∆∞u | ‚úÖ T·ª± ƒë·ªông (code splitting, image optimization) |
| **API Backend** | C·∫ßn server ri√™ng (Express, Node.js) | ‚úÖ API Routes built-in |
| **Deployment** | Ph·ª©c t·∫°p | ‚úÖ 1-click v·ªõi Vercel |
| **Learning Curve** | D·ªÖ h∆°n | Kh√≥ h∆°n (nhi·ªÅu kh√°i ni·ªám m·ªõi) |

---

### 14. Khi n√†o d√πng Next.js?

**‚úÖ D√πng Next.js khi:**
- C·∫ßn SEO t·ªët (blog, e-commerce, landing page).
- C·∫ßn performance cao (SSG/ISR).
- Mu·ªën full-stack app (frontend + API backend).
- Mu·ªën deploy nhanh.

**‚ùå Kh√¥ng c·∫ßn Next.js khi:**
- App n·ªôi b·ªô (kh√¥ng c·∫ßn SEO).
- Dashboard/Admin panel (√≠t ng∆∞·ªùi d√πng).
- ƒêang h·ªçc React c∆° b·∫£n (n√™n h·ªçc React thu·∫ßn tr∆∞·ªõc).

---

### 15. T√†i nguy√™n h·ªçc th√™m

- **Official Docs:** [nextjs.org/docs](https://nextjs.org/docs)
- **Tutorial:** [nextjs.org/learn](https://nextjs.org/learn)
- **Examples:** [github.com/vercel/next.js/tree/canary/examples](https://github.com/vercel/next.js/tree/canary/examples)

---

## PH·∫¶N 8: KI·∫æN TH·ª®C B·ªî SUNG ƒê·ªÇ HI·ªÇU NEXT.JS

### Gi·ªõi thi·ªáu

B·∫°n ƒë√£ h·ªçc React r·∫•t t·ªët qua c√°c ph·∫ßn tr∆∞·ªõc. Tuy nhi√™n, ƒë·ªÉ hi·ªÉu v√† vi·∫øt Next.js code hi·ªáu qu·∫£, b·∫°n c·∫ßn b·ªï sung th√™m m·ªôt s·ªë ki·∫øn th·ª©c v·ªÅ JavaScript n√¢ng cao v√† web development. Ph·∫ßn n√†y s·∫Ω gi√∫p b·∫°n l·∫•p ƒë·∫ßy nh·ªØng kho·∫£ng tr·ªëng ƒë√≥.

> **T·ª∑ l·ªá ki·∫øn th·ª©c:** V·ªõi React mastery t·ª´ t√†i li·ªáu n√†y, b·∫°n ƒë√£ c√≥ **~70%** ki·∫øn th·ª©c c·∫ßn thi·∫øt. Ph·∫ßn 8 n√†y s·∫Ω b·ªï sung **30%** c√≤n l·∫°i.

---

### 1. Async/Await: X·ª≠ l√Ω b·∫•t ƒë·ªìng b·ªô ‚≠ê‚≠ê‚≠ê

**T·∫°i sao quan tr·ªçng?** Next.js Server Components d√πng `async/await` r·∫•t nhi·ªÅu ƒë·ªÉ fetch data.

#### 1.1. V·∫•n ƒë·ªÅ: JavaScript l√† ƒë∆°n lu·ªìng (Single-threaded)

JavaScript ch·ªâ c√≥ **1 lu·ªìng x·ª≠ l√Ω**. N·∫øu m·ªôt t√°c v·ª• ch·∫≠m (g·ªçi API, ƒë·ªçc file) ch·∫°y ƒë·ªìng b·ªô ‚Üí To√†n b·ªô ch∆∞∆°ng tr√¨nh b·ªã "ƒë√≥ng bƒÉng".

**V√≠ d·ª• sai (ƒê·ªìng b·ªô - Blocking):**

```javascript
// Gi·∫£ s·ª≠ h√†m n√†y m·∫•t 5 gi√¢y
function fetchData() {
  // ... ch·ªù 5 gi√¢y ...
  return { name: "An" };
}

console.log("1. B·∫Øt ƒë·∫ßu");
const data = fetchData();  // ‚Üê Ch∆∞∆°ng tr√¨nh ƒë√≥ng bƒÉng 5 gi√¢y ·ªü ƒë√¢y!
console.log("2. Data:", data);
console.log("3. K·∫øt th√∫c");

// Output:
// 1. B·∫Øt ƒë·∫ßu
// ... (ƒë·ª£i 5 gi√¢y) ...
// 2. Data: { name: "An" }
// 3. K·∫øt th√∫c
```

**V·∫•n ƒë·ªÅ:** Trong 5 gi√¢y ƒë√≥, tr√¨nh duy·ªát/server kh√¥ng l√†m g√¨ ƒë∆∞·ª£c (UI ƒë√≥ng bƒÉng, kh√¥ng x·ª≠ l√Ω request kh√°c).

---

#### 1.2. Gi·∫£i ph√°p: Promise v√† Async/Await

**Promise** l√† m·ªôt object ƒë·∫°i di·ªán cho k·∫øt qu·∫£ c·ªßa m·ªôt t√°c v·ª• b·∫•t ƒë·ªìng b·ªô trong t∆∞∆°ng lai.

**Mental Model: Phi·∫øu l·∫•y s·ªë ·ªü ng√¢n h√†ng**
- B·∫°n ƒë·∫øn ng√¢n h√†ng ‚Üí L·∫•y phi·∫øu s·ªë 42 (Promise)
- B·∫°n ng·ªìi ch·ªù, l√†m vi·ªác kh√°c (kh√¥ng ƒë√≥ng bƒÉng)
- Khi ƒë·∫øn l∆∞·ª£t ‚Üí Nh√¢n vi√™n g·ªçi s·ªë 42 ‚Üí B·∫°n nh·∫≠n k·∫øt qu·∫£

##### A. Promise Basics

```javascript
// T·∫°o m·ªôt Promise
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    const success = true;
    if (success) {
      resolve({ name: "An" });  // Th√†nh c√¥ng
    } else {
      reject(new Error("Failed"));  // Th·∫•t b·∫°i
    }
  }, 2000);  // 2 gi√¢y
});

// S·ª≠ d·ª•ng Promise (c√°ch c≈© - .then/.catch)
promise
  .then(data => console.log("Success:", data))
  .catch(error => console.log("Error:", error));
```

##### B. Async/Await (C√°ch hi·ªán ƒë·∫°i - D·ªÖ ƒë·ªçc h∆°n)

```javascript
// H√†m async t·ª± ƒë·ªông tr·∫£ v·ªÅ Promise
async function fetchUser() {
  // await = "ƒë·ª£i Promise ho√†n th√†nh, nh∆∞ng kh√¥ng block code kh√°c"
  const response = await fetch('https://api.example.com/user/1');
  const data = await response.json();
  return data;
}

// S·ª≠ d·ª•ng
async function main() {
  console.log("1. B·∫Øt ƒë·∫ßu");
  
  const user = await fetchUser();  // ƒê·ª£i k·∫øt qu·∫£
  console.log("2. User:", user);
  
  console.log("3. K·∫øt th√∫c");
}

main();
```

**Quy t·∫Øc:**
- H√†m c√≥ `async` ‚Üí T·ª± ƒë·ªông tr·∫£ v·ªÅ Promise
- `await` ch·ªâ d√πng ƒë∆∞·ª£c trong h√†m `async`
- `await` = "t·∫°m d·ª´ng" h√†m n√†y, nh∆∞ng kh√¥ng block to√†n b·ªô ch∆∞∆°ng tr√¨nh

---

#### 1.3. Error Handling v·ªõi try/catch

```javascript
async function fetchUserSafe() {
  try {
    const response = await fetch('https://api.example.com/user/1');
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    return data;
  } catch (error) {
    console.error("L·ªói khi fetch:", error.message);
    return null;  // Tr·∫£ v·ªÅ gi√° tr·ªã m·∫∑c ƒë·ªãnh
  }
}
```

---

#### 1.4. Async/Await trong Next.js

**Server Component (Next.js):**

```jsx
// src/app/users/page.js
// Component n√†y l√† async function!

async function getUsers() {
  const res = await fetch('https://jsonplaceholder.typicode.com/users');
  if (!res.ok) throw new Error('Failed to fetch users');
  return res.json();
}

export default async function UsersPage() {
  const users = await getUsers();  // Fetch data tr·ª±c ti·∫øp!
  
  return (
    <div>
      <h1>Users</h1>
      <ul>
        {users.map(user => (
          <li key={user.id}>{user.name}</li>
        ))}
      </ul>
    </div>
  );
}
```

**ƒêi·ªÉm kh√°c bi·ªát v·ªõi React thu·∫ßn:**
- React thu·∫ßn: Ph·∫£i d√πng `useEffect` + `useState`
- Next.js Server Component: D√πng `async/await` tr·ª±c ti·∫øp trong component

---

#### 1.5. B√†i t·∫≠p th·ª±c h√†nh

**B√†i 1:** Vi·∫øt h√†m `delay(ms)` tr·∫£ v·ªÅ Promise ch·ªù `ms` milliseconds:

```javascript
function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

// S·ª≠ d·ª•ng
async function demo() {
  console.log("B·∫Øt ƒë·∫ßu");
  await delay(2000);  // Ch·ªù 2 gi√¢y
  console.log("Sau 2 gi√¢y");
}
```

**B√†i 2:** Fetch data t·ª´ API v√† x·ª≠ l√Ω l·ªói:

```javascript
async function fetchPosts() {
  try {
    const res = await fetch('https://jsonplaceholder.typicode.com/posts');
    const posts = await res.json();
    return posts.slice(0, 5);  // L·∫•y 5 posts ƒë·∫ßu
  } catch (error) {
    console.error("Error:", error);
    return [];
  }
}
```

---

### 2. HTTP & REST API Concepts ‚≠ê‚≠ê‚≠ê

#### 2.0. Ki·∫øn th·ª©c n·ªÅn t·∫£ng: JSON.stringify() v√† JSON.parse()

Tr∆∞·ªõc khi l√†m vi·ªác v·ªõi APIs, b·∫°n c·∫ßn hi·ªÉu c√°ch chuy·ªÉn ƒë·ªïi gi·ªØa JavaScript objects v√† JSON strings.

##### A. JSON l√† g√¨?

**JSON (JavaScript Object Notation)** l√† ƒë·ªãnh d·∫°ng text ƒë·ªÉ trao ƒë·ªïi d·ªØ li·ªáu gi·ªØa client v√† server.

**Mental Model:** JSON gi·ªëng nh∆∞ "ng√¥n ng·ªØ chung" m√† c·∫£ JavaScript v√† server ƒë·ªÅu hi·ªÉu.

**V√≠ d·ª•:**

```javascript
// JavaScript Object (trong code)
const user = {
  name: "An",
  age: 25,
  hobbies: ["coding", "gaming"]
};

// JSON String (g·ª≠i qua m·∫°ng)
const jsonString = '{"name":"An","age":25,"hobbies":["coding","gaming"]}';
```

**S·ª± kh√°c bi·ªát:**

| JavaScript Object | JSON String |
|---|---|
| D√πng trong code | G·ª≠i qua HTTP |
| Keys kh√¥ng c√≥ d·∫•u ngo·∫∑c k√©p | Keys **ph·∫£i** c√≥ d·∫•u ngo·∫∑c k√©p |
| `{ name: "An" }` | `'{"name":"An"}'` |

---

##### B. JSON.stringify() - Object ‚Üí String

**M·ª•c ƒë√≠ch:** Chuy·ªÉn JavaScript object th√†nh JSON string ƒë·ªÉ g·ª≠i l√™n server.

```javascript
const user = {
  name: "An",
  age: 25,
  isActive: true
};

// Chuy·ªÉn object ‚Üí JSON string
const jsonString = JSON.stringify(user);
console.log(jsonString);
// Output: '{"name":"An","age":25,"isActive":true}'

console.log(typeof jsonString);  // "string"
```

**Khi n√†o d√πng?**
- ‚úÖ G·ª≠i data l√™n server qua `fetch()` (POST, PATCH)
- ‚úÖ L∆∞u data v√†o `localStorage`
- ‚úÖ Debug (xem c·∫•u tr√∫c object)

**V√≠ d·ª• th·ª±c t·∫ø:**

```javascript
// G·ª≠i data l√™n server
fetch('https://api.example.com/users', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: "An", age: 25 })  // ‚Üê Object ‚Üí String
});
```

---

##### C. JSON.parse() - String ‚Üí Object

**M·ª•c ƒë√≠ch:** Chuy·ªÉn JSON string (t·ª´ server) th√†nh JavaScript object ƒë·ªÉ d√πng trong code.

```javascript
const jsonString = '{"name":"An","age":25}';

// Chuy·ªÉn JSON string ‚Üí object
const user = JSON.parse(jsonString);
console.log(user.name);  // "An"
console.log(user.age);   // 25

console.log(typeof user);  // "object"
```

**Khi n√†o d√πng?**
- ‚úÖ Nh·∫≠n data t·ª´ server (response.json() t·ª± ƒë·ªông g·ªçi JSON.parse())
- ‚úÖ ƒê·ªçc data t·ª´ `localStorage`
- ‚úÖ Parse JSON string t·ª´ b·∫•t k·ª≥ ngu·ªìn n√†o

**V√≠ d·ª• th·ª±c t·∫ø:**

```javascript
// Fetch data t·ª´ server
const response = await fetch('https://api.example.com/users/1');
const jsonString = await response.text();  // L·∫•y raw string
const user = JSON.parse(jsonString);       // String ‚Üí Object

// Ho·∫∑c d√πng shortcut (Next.js/React th∆∞·ªùng d√πng):
const user = await response.json();  // T·ª± ƒë·ªông parse!
```

---

##### D. L·ªói th∆∞·ªùng g·∫∑p

**‚ùå L·ªói 1: Stringify m·ªôt object ƒë√£ l√† string**

```javascript
const user = '{"name":"An"}';  // ƒê√£ l√† string r·ªìi
const result = JSON.stringify(user);
console.log(result);  // '"{\\"name\\":\\"An\\"}"' ‚Üê Sai! String l·ªìng string
```

**‚úÖ S·ª≠a:** Ch·ªâ stringify object, kh√¥ng stringify string.

---

**‚ùå L·ªói 2: Parse m·ªôt object (kh√¥ng ph·∫£i string)**

```javascript
const user = { name: "An" };  // ƒê√£ l√† object r·ªìi
const result = JSON.parse(user);  // ‚ùå Error: Unexpected token o in JSON
```

**‚úÖ S·ª≠a:** Ch·ªâ parse string, kh√¥ng parse object.

---

**‚ùå L·ªói 3: Parse JSON kh√¥ng h·ª£p l·ªá**

```javascript
const invalidJson = "{name: 'An'}";  // ‚ùå Keys kh√¥ng c√≥ d·∫•u ngo·∫∑c k√©p
const result = JSON.parse(invalidJson);  // ‚ùå Error: Unexpected token n
```

**‚úÖ S·ª≠a:** ƒê·∫£m b·∫£o JSON string h·ª£p l·ªá (keys ph·∫£i c√≥ d·∫•u ngo·∫∑c k√©p).

---

##### E. B·∫£ng t√≥m t·∫Øt

| H√†m | Input | Output | Khi n√†o d√πng? |
|---|---|---|---|
| **`JSON.stringify()`** | JavaScript Object | JSON String | G·ª≠i data l√™n server |
| **`JSON.parse()`** | JSON String | JavaScript Object | Nh·∫≠n data t·ª´ server |

**Quy t·∫Øc v√†ng:**
- G·ª≠i data ‚Üí `JSON.stringify()`
- Nh·∫≠n data ‚Üí `JSON.parse()` (ho·∫∑c `response.json()`)

---

#### 2.1. HTTP Methods (CRUD Operations)

| Method | M·ª•c ƒë√≠ch | V√≠ d·ª• | C√≥ body? |
|---|---|---|---|
| **GET** | L·∫•y d·ªØ li·ªáu | Xem danh s√°ch users | ‚ùå Kh√¥ng |
| **POST** | T·∫°o m·ªõi | T·∫°o user m·ªõi | ‚úÖ C√≥ |
| **PUT** | C·∫≠p nh·∫≠t to√†n b·ªô | S·ª≠a to√†n b·ªô th√¥ng tin user | ‚úÖ C√≥ |
| **PATCH** | C·∫≠p nh·∫≠t m·ªôt ph·∫ßn | Ch·ªâ s·ª≠a t√™n user | ‚úÖ C√≥ |
| **DELETE** | X√≥a | X√≥a user | ‚ùå Kh√¥ng |

#### 2.2. Fetch API - C√°c v√≠ d·ª• th·ª±c t·∫ø

##### A. GET - L·∫•y d·ªØ li·ªáu

```javascript
// L·∫•y danh s√°ch users
async function getUsers() {
  const response = await fetch('https://api.example.com/users');
  const users = await response.json();
  return users;
}

// L·∫•y 1 user c·ª• th·ªÉ
async function getUser(id) {
  const response = await fetch(`https://api.example.com/users/${id}`);
  const user = await response.json();
  return user;
}
```

##### B. POST - T·∫°o m·ªõi

```javascript
async function createUser(userData) {
  const response = await fetch('https://api.example.com/users', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(userData),  // Chuy·ªÉn object ‚Üí JSON string
  });
  
  const newUser = await response.json();
  return newUser;
}

// S·ª≠ d·ª•ng
const user = await createUser({ name: 'An', email: 'an@example.com' });
```

##### C. PATCH - C·∫≠p nh·∫≠t

```javascript
async function updateUser(id, updates) {
  const response = await fetch(`https://api.example.com/users/${id}`, {
    method: 'PATCH',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(updates),
  });
  
  return response.json();
}

// S·ª≠ d·ª•ng
await updateUser(1, { name: 'B√¨nh' });  // Ch·ªâ s·ª≠a t√™n
```

##### D. DELETE - X√≥a

```javascript
async function deleteUser(id) {
  const response = await fetch(`https://api.example.com/users/${id}`, {
    method: 'DELETE',
  });
  
  return response.ok;  // true n·∫øu th√†nh c√¥ng
}
```

---

#### 2.3. HTTP Status Codes

| Code | √ù nghƒ©a | Khi n√†o x·∫£y ra? |
|---|---|---|
| **200** | OK | Request th√†nh c√¥ng |
| **201** | Created | T·∫°o m·ªõi th√†nh c√¥ng (POST) |
| **204** | No Content | X√≥a th√†nh c√¥ng (DELETE) |
| **400** | Bad Request | D·ªØ li·ªáu g·ª≠i l√™n sai format |
| **401** | Unauthorized | Ch∆∞a ƒëƒÉng nh·∫≠p |
| **403** | Forbidden | Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p |
| **404** | Not Found | Kh√¥ng t√¨m th·∫•y resource |
| **500** | Server Error | L·ªói server |

**Ki·ªÉm tra status code:**

```javascript
async function fetchData() {
  const response = await fetch('https://api.example.com/data');
  
  if (!response.ok) {
    if (response.status === 404) {
      throw new Error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu');
    } else if (response.status === 401) {
      throw new Error('Vui l√≤ng ƒëƒÉng nh·∫≠p');
    } else {
      throw new Error(`HTTP Error: ${response.status}`);
    }
  }
  
  return response.json();
}
```

---

#### 2.4. Headers (Request & Response)

**Request Headers** - G·ª≠i l√™n server:

```javascript
fetch('https://api.example.com/data', {
  headers: {
    'Content-Type': 'application/json',      // Lo·∫°i d·ªØ li·ªáu g·ª≠i ƒëi
    'Authorization': 'Bearer token123',      // Token x√°c th·ª±c
    'Accept-Language': 'vi-VN',              // Ng√¥n ng·ªØ mong mu·ªën
  }
})
```

**Response Headers** - Server tr·∫£ v·ªÅ:

```javascript
const response = await fetch('https://api.example.com/data');

console.log(response.headers.get('Content-Type'));  // "application/json"
console.log(response.headers.get('Cache-Control')); // "max-age=3600"
```

---

#### 2.5. Next.js API Routes

Next.js cho ph√©p t·∫°o API endpoints ngay trong project:

```javascript
// src/app/api/users/route.js

export async function GET(request) {
  // L·∫•y query params: /api/users?page=2
  const { searchParams } = new URL(request.url);
  const page = searchParams.get('page') || '1';
  
  const users = [
    { id: 1, name: 'An' },
    { id: 2, name: 'B√¨nh' },
  ];
  
  return Response.json({ users, page });
}

export async function POST(request) {
  const body = await request.json();  // Parse JSON body
  
  // Validate
  if (!body.name) {
    return Response.json(
      { error: 'Name is required' },
      { status: 400 }
    );
  }
  
  // L∆∞u v√†o database (gi·∫£ l·∫≠p)
  const newUser = { id: Date.now(), ...body };
  
  return Response.json(newUser, { status: 201 });
}
```

---

### 3. Environment Variables (Bi·∫øn m√¥i tr∆∞·ªùng)

#### 3.1. T·∫°i sao c·∫ßn Environment Variables?

**V·∫•n ƒë·ªÅ:** B·∫°n c√≥ nh·ªØng th√¥ng tin nh·∫°y c·∫£m kh√¥ng n√™n commit l√™n Git:
- API keys
- Database passwords
- Secret tokens

**Gi·∫£i ph√°p:** L∆∞u v√†o file `.env.local` (file n√†y ƒë∆∞·ª£c Git ignore).

---

#### 3.2. C√°ch s·ª≠ d·ª•ng trong Next.js

**T·∫°o file `.env.local`:**

```bash
# .env.local (·ªü root project)

# Server-only variables (ch·ªâ d√πng ·ªü server)
DATABASE_URL=postgres://user:pass@localhost/mydb
API_SECRET_KEY=super-secret-key-123

# Client-accessible variables (d√πng ƒë∆∞·ª£c ·ªü browser)
NEXT_PUBLIC_API_URL=https://api.example.com
NEXT_PUBLIC_SITE_NAME=My App
```

**Quy t·∫Øc quan tr·ªçng:**
- Bi·∫øn **KH√îNG** c√≥ prefix `NEXT_PUBLIC_` ‚Üí Ch·ªâ d√πng ƒë∆∞·ª£c ·ªü **server**
- Bi·∫øn **C√ì** prefix `NEXT_PUBLIC_` ‚Üí D√πng ƒë∆∞·ª£c ·ªü **c·∫£ server v√† client**

---

#### 3.3. S·ª≠ d·ª•ng trong code

**Server Component / API Route:**

```javascript
// src/app/api/data/route.js

export async function GET() {
  // ‚úÖ OK - Ch·∫°y tr√™n server
  const dbUrl = process.env.DATABASE_URL;
  const apiKey = process.env.API_SECRET_KEY;
  
  // K·∫øt n·ªëi database, g·ªçi API...
  
  return Response.json({ success: true });
}
```

**Client Component:**

```javascript
// src/components/Header.js
'use client';

export default function Header() {
  // ‚úÖ OK - C√≥ NEXT_PUBLIC_
  const siteName = process.env.NEXT_PUBLIC_SITE_NAME;
  const apiUrl = process.env.NEXT_PUBLIC_API_URL;
  
  // ‚ùå undefined - Kh√¥ng c√≥ NEXT_PUBLIC_
  const dbUrl = process.env.DATABASE_URL;  // undefined!
  
  return <h1>{siteName}</h1>;
}
```

---

#### 3.4. C√°c file .env kh√°c nhau

| File | Khi n√†o d√πng? | Commit l√™n Git? |
|---|---|---|
| `.env.local` | Development (local machine) | ‚ùå Kh√¥ng |
| `.env.development` | Development (shared settings) | ‚úÖ C√≥ th·ªÉ |
| `.env.production` | Production (Vercel t·ª± ƒë·ªông d√πng) | ‚ùå Kh√¥ng |
| `.env` | Default cho t·∫•t c·∫£ m√¥i tr∆∞·ªùng | ‚úÖ C√≥ th·ªÉ |

**Th·ª© t·ª± ∆∞u ti√™n:** `.env.local` > `.env.development` > `.env`

---

#### 3.5. B·∫£o m·∫≠t

**‚ùå KH√îNG BAO GI·ªú:**
- Commit `.env.local` l√™n Git
- ƒê·ªÉ API keys trong code
- D√πng `NEXT_PUBLIC_` cho th√¥ng tin nh·∫°y c·∫£m

**‚úÖ N√äN:**
- Th√™m `.env*.local` v√†o `.gitignore`
- D√πng Vercel Environment Variables cho production
- Document c√°c bi·∫øn c·∫ßn thi·∫øt trong README

---

### 4. JavaScript ES6+ Features

#### 4.1. Optional Chaining (`?.`)

**V·∫•n ƒë·ªÅ:** Truy c·∫≠p nested properties c√≥ th·ªÉ g√¢y l·ªói n·∫øu object null/undefined.

```javascript
// ‚ùå L·ªói n·∫øu user null
const name = user.profile.name;  // TypeError: Cannot read property 'profile' of null

// ‚úÖ C√°ch c≈© - Ki·ªÉm tra t·ª´ng c·∫•p
const name = user && user.profile && user.profile.name;

// ‚úÖ C√°ch m·ªõi - Optional chaining
const name = user?.profile?.name;  // undefined n·∫øu user ho·∫∑c profile null
```

**Trong Next.js:**

```jsx
export default function UserProfile({ user }) {
  return (
    <div>
      <h1>{user?.name ?? 'Guest'}</h1>
      <p>{user?.profile?.bio ?? 'No bio'}</p>
      <img src={user?.avatar?.url ?? '/default.png'} />
    </div>
  );
}
```

---

#### 4.2. Nullish Coalescing (`??`)

**Kh√°c bi·ªát v·ªõi `||`:**

```javascript
const value1 = 0;
const value2 = '';
const value3 = null;

// || - Coi 0, '', false l√† "falsy" ‚Üí D√πng default
console.log(value1 || 10);  // 10 (v√¨ 0 l√† falsy)
console.log(value2 || 'default');  // 'default' (v√¨ '' l√† falsy)

// ?? - Ch·ªâ coi null/undefined l√† "nullish" ‚Üí D√πng default
console.log(value1 ?? 10);  // 0 (v√¨ 0 kh√¥ng ph·∫£i null/undefined)
console.log(value2 ?? 'default');  // '' (v√¨ '' kh√¥ng ph·∫£i null/undefined)
console.log(value3 ?? 'default');  // 'default' (v√¨ null)
```

**Khi n√†o d√πng `??`:**
- Khi `0`, `''`, `false` l√† gi√° tr·ªã h·ª£p l·ªá
- Ch·ªâ mu·ªën fallback khi `null` ho·∫∑c `undefined`

---

#### 4.3. Dynamic Imports

**V·∫•n ƒë·ªÅ:** Import t·∫•t c·∫£ components ‚Üí Bundle size l·ªõn.

**Gi·∫£i ph√°p:** Ch·ªâ load component khi c·∫ßn (Code Splitting).

```javascript
// src/app/page.js
import dynamic from 'next/dynamic';

// Component n·∫∑ng ch·ªâ load khi c·∫ßn
const HeavyChart = dynamic(() => import('@/components/HeavyChart'), {
  loading: () => <p>ƒêang t·∫£i bi·ªÉu ƒë·ªì...</p>,
  ssr: false,  // Kh√¥ng render tr√™n server (n·∫øu d√πng browser APIs)
});

export default function Dashboard() {
  return (
    <div>
      <h1>Dashboard</h1>
      <HeavyChart />  {/* Ch·ªâ load khi component n√†y render */}
    </div>
  );
}
```

---

### 5. T√≥m t·∫Øt: Checklist ki·∫øn th·ª©c

Tr∆∞·ªõc khi h·ªçc Next.js, h√£y ch·∫Øc ch·∫Øn b·∫°n hi·ªÉu:

**JavaScript:**
- ‚úÖ Async/Await v√† Promises
- ‚úÖ `try/catch` error handling
- ‚úÖ Optional chaining (`?.`)
- ‚úÖ Nullish coalescing (`??`)

**HTTP/API:**
- ‚úÖ HTTP methods (GET, POST, PUT, DELETE)
- ‚úÖ Fetch API
- ‚úÖ Request/Response headers
- ‚úÖ Status codes (200, 404, 500, etc.)

**Next.js Specific:**
- ‚úÖ Environment variables (`.env.local`, `NEXT_PUBLIC_`)
- ‚úÖ Server vs Client concepts
- ‚úÖ File-based routing

---

### 6. L·ªô tr√¨nh h·ªçc ƒë·ªÅ xu·∫•t

**Tu·∫ßn 1: JavaScript Async (Quan tr·ªçng nh·∫•t!)**
1. H·ªçc Promise basics (1 ng√†y)
2. H·ªçc Async/Await (2 ng√†y)
3. Th·ª±c h√†nh fetch API (2 ng√†y)

**Tu·∫ßn 2: HTTP & APIs**
1. Hi·ªÉu REST API (1 ng√†y)
2. Th·ª±c h√†nh CRUD v·ªõi fetch (2 ng√†y)
3. H·ªçc v·ªÅ headers, status codes (1 ng√†y)

**Tu·∫ßn 3: Next.js Basics**
1. Setup project, hi·ªÉu c·∫•u tr√∫c (1 ng√†y)
2. Server vs Client Components (2 ng√†y)
3. File-based routing (2 ng√†y)

**Tu·∫ßn 4: Practice**
1. Build m·ªôt blog app ƒë∆°n gi·∫£n
2. Fetch data t·ª´ API
3. T·∫°o API routes
4. Deploy l√™n Vercel

---

### 7. T√†i nguy√™n h·ªçc t·∫≠p

**JavaScript Async:**
- [JavaScript.info - Async/Await](https://javascript.info/async-await) ‚≠ê
- [MDN - Using Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises)

**HTTP/REST API:**
- [MDN - Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)
- [HTTP Status Codes](https://httpstatuses.com/)

**Next.js:**
- [Next.js Learn Course](https://nextjs.org/learn) ‚≠ê **B·∫Øt ƒë·∫ßu t·ª´ ƒë√¢y!**
- [Next.js Docs](https://nextjs.org/docs)

---

### 8. K·∫øt lu·∫≠n

**B·∫°n ƒë√£ c√≥ t·ª´ React (70%):**
- ‚úÖ Components, JSX, Props, State
- ‚úÖ Hooks (useState, useEffect, useContext)
- ‚úÖ Event handling, Forms, Lists

**B·∫°n c·∫ßn b·ªï sung (30%):**
- üéØ **Async/Await** (Quan tr·ªçng nh·∫•t!)
- üéØ HTTP/REST API concepts
- üéØ Environment variables
- üéØ Server vs Client thinking

**Th·ªùi gian ∆∞·ªõc t√≠nh:** 3-4 tu·∫ßn h·ªçc part-time (2-3 gi·ªù/ng√†y)

**L·ªùi khuy√™n cu·ªëi:** ƒê·ª´ng c·ªë h·ªçc h·∫øt l√Ω thuy·∫øt. Sau khi hi·ªÉu async/await v√† fetch API, h√£y **b·∫Øt ƒë·∫ßu build m·ªôt project Next.js nh·ªè ngay**. Learning by doing l√† c√°ch nhanh nh·∫•t! üöÄ

---


## PH·∫¶N 9: CHI·∫æN L∆Ø·ª¢C DEPLOY REACT TR√äN CHEAP HOSTING

### Gi·ªõi thi·ªáu: React tr√™n hosting gi√° r·∫ª nh∆∞ WordPress?

**C√¢u h·ªèi ph·ªï bi·∫øn:** "T√¥i ƒë√£ quen v·ªõi WordPress hosting gi√° r·∫ª (shared hosting). Li·ªáu c√≥ th·ªÉ deploy React/Next.js m√† kh√¥ng c·∫ßn mua VPS ƒë·∫Øt ƒë·ªè?"

**C√¢u tr·∫£ l·ªùi:** **C√ì!** Nh∆∞ng b·∫°n c·∫ßn hi·ªÉu s·ª± kh√°c bi·ªát gi·ªØa c√°c chi·∫øn l∆∞·ª£c deploy.

**Mental Model:**
- **WordPress truy·ªÅn th·ªëng:** Server ch·∫°y PHP + MySQL ‚Üí T·∫°o HTML m·ªói request ‚Üí G·ª≠i v·ªÅ browser
- **React hi·ªán ƒë·∫°i:** Nhi·ªÅu c√°ch kh√°c nhau, t·ª´ "ho√†n to√†n tƒ©nh" (nh∆∞ WordPress + cache) ƒë·∫øn "hybrid" (tƒ©nh + dynamic)

**M·ª•c ti√™u c·ªßa ph·∫ßn n√†y:**
- ‚úÖ Deploy React/Next.js tr√™n hosting gi√° r·∫ª (shared hosting, static hosting)
- ‚úÖ D√πng c√¥ng ngh·ªá hi·ªán ƒë·∫°i nh∆∞ng chi ph√≠ th·∫•p
- ‚úÖ Hi·ªÉu trade-offs gi·ªØa c√°c ph∆∞∆°ng ph√°p

---

### T·ªïng quan: 2 H∆∞·ªõng ti·∫øp c·∫≠n ch√≠nh

| C√¥ng ngh·ªá | Ph∆∞∆°ng ph√°p | Chi ph√≠ | ƒê·ªô ph·ª©c t·∫°p |
|-----------|-------------|---------|-------------|
| **1. Next.js** | Monorepo (SSG + SSR) | Trung b√¨nh - Cao | Cao |
| **2. Vite + React** | Static-first (SSG/SPA) | R·∫•t th·∫•p | Th·∫•p - Trung b√¨nh |

---

## 1. Next.js: Monorepo Approach

### √ù t∆∞·ªüng

Chia ·ª©ng d·ª•ng th√†nh **2 ph·∫ßn** trong c√πng m·ªôt monorepo:

1. **Ph·∫ßn SSG (Static Site Generation):** Deploy l√™n cheap hosting
2. **Ph·∫ßn SSR (Server-Side Rendering):** Ch·∫°y local ho·∫∑c VPS nh·ªè, k·∫øt n·ªëi database

**Mental Model:** Gi·ªëng nh∆∞ c√≥ 2 website:
- Website tƒ©nh (marketing, blog) ‚Üí Hosting gi√° r·∫ª
- API/Admin backend ‚Üí Server ri√™ng (c√≥ th·ªÉ l√† m√°y t√≠nh c√° nh√¢n)

---

### C·∫•u tr√∫c Monorepo

```
my-project/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ public-site/        # Next.js SSG ‚Üí Deploy l√™n cheap hosting
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ page.js           # Trang ch·ªß (SSG)
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ about/page.js     # V·ªÅ ch√∫ng t√¥i (SSG)
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ blog/
‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ [slug]/page.js # Blog posts (SSG)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ next.config.js
‚îÇ   ‚îÇ       # output: 'export' ‚Üí T·∫°o static files
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ admin-api/          # Next.js SSR ‚Üí Ch·∫°y local/VPS
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ api/
‚îÇ       ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ posts/route.js    # API CRUD posts
‚îÇ       ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ products/route.js # API CRUD products
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ admin/
‚îÇ       ‚îÇ           ‚îî‚îÄ‚îÄ page.js           # Admin dashboard (SSR)
‚îÇ       ‚îî‚îÄ‚îÄ next.config.js
‚îÇ           # Kh√¥ng c√≥ output: 'export' ‚Üí Ch·∫°y nh∆∞ server
‚îÇ
‚îú‚îÄ‚îÄ packages/               # Shared code
‚îÇ   ‚îî‚îÄ‚îÄ database/          # Database models, queries
‚îÇ       ‚îî‚îÄ‚îÄ prisma/
‚îÇ
‚îî‚îÄ‚îÄ package.json
```

---

### Workflow: C·∫≠p nh·∫≠t n·ªôi dung

**K·ªãch b·∫£n:** B·∫°n mu·ªën th√™m b√†i blog m·ªõi.

```
1. M·ªü admin dashboard (local: http://localhost:3001/admin)
   ‚Üì
2. Vi·∫øt b√†i blog m·ªõi ‚Üí L∆∞u v√†o database (MongoDB/PostgreSQL)
   ‚Üì
3. Rebuild public-site:
   cd apps/public-site
   npm run build  # Fetch data t·ª´ DB ‚Üí T·∫°o static HTML
   ‚Üì
4. Upload static files l√™n cheap hosting:
   rsync -avz out/ user@cheaphost.com:/public_html/
   ‚Üì
5. Website c·∫≠p nh·∫≠t v·ªõi b√†i blog m·ªõi!
```

**Timeline:**

```
User vi·∫øt b√†i ‚Üí L∆∞u DB (1s) ‚Üí Build static (30s) ‚Üí Upload (1 ph√∫t) ‚Üí Live (t·ªïng ~2 ph√∫t)
```

---

### ∆Øu/Nh∆∞·ª£c ƒëi·ªÉm

**‚úÖ ∆Øu ƒëi·ªÉm:**
- Public site c·ª±c nhanh (static files)
- Chi ph√≠ th·∫•p cho ph·∫ßn public (shared hosting ~$5/th√°ng)
- SEO tuy·ªát v·ªùi (HTML tƒ©nh)
- B·∫£o m·∫≠t t·ªët (admin kh√¥ng public)

**‚ùå Nh∆∞·ª£c ƒëi·ªÉm:**
- C·∫ßn rebuild + redeploy m·ªói l·∫ßn c·∫≠p nh·∫≠t n·ªôi dung
- Ph·ª©c t·∫°p h∆°n (2 apps, monorepo setup)
- C·∫ßn server ri√™ng cho admin (c√≥ th·ªÉ l√† m√°y t√≠nh c√° nh√¢n)

**Khi n√†o d√πng:**
- ‚úÖ Blog, marketing site v·ªõi n·ªôi dung kh√¥ng ƒë·ªïi th∆∞·ªùng xuy√™n
- ‚úÖ B·∫°n OK v·ªõi vi·ªác rebuild khi c·∫≠p nh·∫≠t
- ‚úÖ Mu·ªën performance t·ªëi ƒëa + chi ph√≠ th·∫•p

---

### Code Example: Public Site (SSG)

```javascript
// apps/public-site/src/app/blog/[slug]/page.js

import { db } from '@my-project/database';

// T·∫°o static paths cho t·∫•t c·∫£ blog posts l√∫c build time
export async function generateStaticParams() {
  const posts = await db.post.findMany();
  return posts.map(post => ({ slug: post.slug }));
}

// Fetch data cho m·ªói post l√∫c build time
export default async function BlogPost({ params }) {
  const post = await db.post.findUnique({
    where: { slug: params.slug }
  });
  
  return (
    <article>
      <h1>{post.title}</h1>
      <div dangerouslySetInnerHTML={{ __html: post.content }} />
    </article>
  );
}
```

```javascript
// apps/public-site/next.config.js

module.exports = {
  output: 'export',  // ‚Üê T·∫°o static files thay v√¨ server
  images: {
    unoptimized: true  // Static hosting kh√¥ng h·ªó tr·ª£ Image Optimization
  }
};
```

**K·∫øt qu·∫£ build:**

```
apps/public-site/out/
‚îú‚îÄ‚îÄ index.html              # Trang ch·ªß
‚îú‚îÄ‚îÄ about.html              # V·ªÅ ch√∫ng t√¥i
‚îú‚îÄ‚îÄ blog/
‚îÇ   ‚îú‚îÄ‚îÄ first-post.html     # Blog post 1
‚îÇ   ‚îú‚îÄ‚îÄ second-post.html    # Blog post 2
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ _next/                  # JS/CSS assets
```

---

### Code Example: Admin API (SSR)

```javascript
// apps/admin-api/src/app/api/posts/route.js

import { db } from '@my-project/database';

// API ƒë·ªÉ t·∫°o post m·ªõi
export async function POST(request) {
  const { title, content, slug } = await request.json();
  
  const post = await db.post.create({
    data: { title, content, slug }
  });
  
  return Response.json({ success: true, post });
}

// API ƒë·ªÉ l·∫•y t·∫•t c·∫£ posts
export async function GET() {
  const posts = await db.post.findMany();
  return Response.json(posts);
}
```

```javascript
// apps/admin-api/src/app/admin/page.js
'use client';

import { useState } from 'react';

export default function AdminDashboard() {
  const [title, setTitle] = useState('');
  const [content, setContent] = useState('');
  
  async function handleSubmit(e) {
    e.preventDefault();
    
    await fetch('/api/posts', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ title, content, slug: slugify(title) })
    });
    
    alert('Post created! Now rebuild public-site.');
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <input value={title} onChange={e => setTitle(e.target.value)} />
      <textarea value={content} onChange={e => setContent(e.target.value)} />
      <button type="submit">Create Post</button>
    </form>
  );
}
```

---

## 2. Vite + React: Static-First Approach

### T·ªïng quan

V·ªõi **Vite + React**, b·∫°n c√≥ 3 chi·∫øn l∆∞·ª£c ch√≠nh:

```
A) Build-time static (SSG/export)
   ‚îú‚îÄ‚îÄ A1: Static SPA (Single Page App)
   ‚îî‚îÄ‚îÄ A2: True SSG / Prerender (nhi·ªÅu HTML files)

B) Static frontend + Supabase (Backend-as-a-Service)

C) Static frontend + Custom API + MongoDB Atlas
```

---

### A) Build-time Static (SSG/Export)

**√ù t∆∞·ªüng:** T·∫°o static files (HTML/JS/CSS) ‚Üí Upload l√™n cheap hosting.

**Workflow:**

```
1. Edit content locally (ho·∫∑c trong local admin)
   ‚Üì
2. Build/export ‚Üí T·∫°o static files
   ‚Üì
3. Upload l√™n cheap hosting
   ‚Üì
4. N·ªôi dung live c·ªë ƒë·ªãnh cho ƒë·∫øn khi rebuild
   (Update = Rebuild + Redeploy)
```

**Mental Model:**
- Gi·ªëng nh∆∞ xu·∫•t b·∫£n s√°ch: In xong th√¨ n·ªôi dung c·ªë ƒë·ªãnh, mu·ªën s·ª≠a ph·∫£i in l·∫°i.

---

### A1 ‚Äî Static SPA (Single Page App)

**ƒê·∫∑c ƒëi·ªÉm:**
- **1 file HTML duy nh·∫•t** (`index.html`)
- React x√¢y d·ª±ng "pages" trong browser
- Routing: client-side (React Router)

**C·∫•u tr√∫c sau khi build:**

```
dist/
‚îú‚îÄ‚îÄ index.html          # ‚Üê Ch·ªâ 1 file HTML
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ index-abc123.js   # React bundle
‚îÇ   ‚îî‚îÄ‚îÄ index-def456.css
‚îî‚îÄ‚îÄ images/
```

**C√°ch ho·∫°t ƒë·ªông:**

```
1. Browser t·∫£i index.html (r·∫•t nh·ªè, ~1KB)
   ‚Üì
2. Browser t·∫£i JS bundle (~200KB)
   ‚Üì
3. React ch·∫°y v√† render m·ªçi th·ª© (home, products, product detail...) trong browser
   ‚Üì
4. User click link ‚Üí React Router thay ƒë·ªïi component (kh√¥ng reload trang)
```

**Routing:**
- Client-side (React Router)
- N·∫øu user m·ªü `/products/abc` tr·ª±c ti·∫øp, server ph·∫£i redirect v·ªÅ `index.html` ho·∫∑c s·∫Ω 404

**SEO:**
- ‚ùå Y·∫øu h∆°n (Google c√≥ th·ªÉ handle m·ªôt s·ªë, nh∆∞ng kh√¥ng m·∫°nh b·∫±ng HTML-per-page)

**Khi n√†o d√πng:**
- ‚úÖ Dashboards, internal tools
- ‚úÖ Simple brochure sites kh√¥ng c·∫ßn SEO m·∫°nh
- ‚úÖ Apps c·∫ßn interactivity cao

---

#### Code Example: Vite SPA

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  // Kh√¥ng c·∫ßn config ƒë·∫∑c bi·ªát, m·∫∑c ƒë·ªãnh l√† SPA
});
```

```jsx
// src/main.jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import Home from './pages/Home';
import Products from './pages/Products';
import ProductDetail from './pages/ProductDetail';

ReactDOM.createRoot(document.getElementById('root')).render(
  <BrowserRouter>
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/products" element={<Products />} />
      <Route path="/products/:id" element={<ProductDetail />} />
    </Routes>
  </BrowserRouter>
);
```

**Build:**

```bash
npm run build
# ‚Üí T·∫°o dist/ v·ªõi 1 index.html + assets
```

**Upload l√™n hosting:**

```bash
# C·∫•u h√¨nh .htaccess cho Apache (shared hosting)
# Redirect t·∫•t c·∫£ requests v·ªÅ index.html
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>
```

---

### A2 ‚Äî True SSG / Prerender (Nhi·ªÅu HTML files)

**ƒê·∫∑c ƒëi·ªÉm:**
- **Nhi·ªÅu HTML files**, m·ªói route = 1 HTML file
- HTML ƒë√£ ch·ª©a n·ªôi dung (product title, description, etc.)
- JS load sau v√† "hydrate" (th√™m interactivity)

**C·∫•u tr√∫c sau khi build:**

```
dist/
‚îú‚îÄ‚îÄ index.html                    # Trang ch·ªß
‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îú‚îÄ‚îÄ index.html                # /products
‚îÇ   ‚îî‚îÄ‚îÄ abc/
‚îÇ       ‚îî‚îÄ‚îÄ index.html            # /products/abc
‚îú‚îÄ‚îÄ about/
‚îÇ   ‚îî‚îÄ‚îÄ index.html                # /about
‚îî‚îÄ‚îÄ assets/
    ‚îú‚îÄ‚îÄ index-abc123.js
    ‚îî‚îÄ‚îÄ index-def456.css
```

**C√°ch ho·∫°t ƒë·ªông:**

```
1. Browser t·∫£i HTML page ƒë√£ c√≥ n·ªôi dung (product title, description...)
   ‚Üì
2. User th·∫•y n·ªôi dung ngay l·∫≠p t·ª©c
   ‚Üì
3. JS load sau v√† hydrate (th√™m event handlers, interactivity)
```

**Routing:**
- Server serve real files cho m·ªói route
- Deep links ho·∫°t ƒë·ªông t·ª± nhi√™n (`/products/abc` ‚Üí `products/abc/index.html`)

**SEO:**
- ‚úÖ M·∫°nh (search engines th·∫•y real HTML ngay l·∫≠p t·ª©c)

**Khi n√†o d√πng:**
- ‚úÖ Product catalogs, blogs, marketing sites
- ‚úÖ SEO quan tr·ªçng
- ‚úÖ N·ªôi dung kh√¥ng ƒë·ªïi th∆∞·ªùng xuy√™n

---

#### Code Example: Vite SSG v·ªõi vite-plugin-ssr

```bash
npm install vite-plugin-ssr
```

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import ssr from 'vite-plugin-ssr/plugin';

export default defineConfig({
  plugins: [react(), ssr()]
});
```

```jsx
// pages/products/@id/+Page.jsx
export { Page };

function Page({ product }) {
  return (
    <div>
      <h1>{product.name}</h1>
      <p>{product.description}</p>
      <p>Price: ${product.price}</p>
    </div>
  );
}
```

```javascript
// pages/products/@id/+data.js
export { data };

async function data(pageContext) {
  const { id } = pageContext.routeParams;
  
  // Fetch data l√∫c build time
  const product = await fetchProduct(id);
  
  return { product };
}

// T·∫°o static paths cho t·∫•t c·∫£ products
export async function prerender() {
  const products = await fetchAllProducts();
  
  return products.map(p => `/products/${p.id}`);
}
```

**Build:**

```bash
npm run build
# ‚Üí T·∫°o dist/ v·ªõi nhi·ªÅu HTML files
```

**Ki·ªÉm tra:**

```bash
ls dist/
# index.html
# products/
#   index.html
#   abc/
#     index.html
#   xyz/
#     index.html
```

---

### C√°ch ph√¢n bi·ªát A1 vs A2

**Test ƒë∆°n gi·∫£n:** Nh√¨n v√†o folder `dist/` sau khi build:

```
N·∫øu ch·ªâ th·∫•y 1 HTML ‚Üí A1 (SPA)
N·∫øu th·∫•y nhi·ªÅu HTML files/folders ‚Üí A2 (SSG/Prerender)
```

**So s√°nh:**

| Ti√™u ch√≠ | A1 (SPA) | A2 (SSG) |
|----------|----------|----------|
| **S·ªë file HTML** | 1 file | Nhi·ªÅu files |
| **N·ªôi dung trong HTML** | R·ªóng (ch·ªâ `<div id="root">`) | ƒê·∫ßy ƒë·ªß (title, text, etc.) |
| **SEO** | Y·∫øu | M·∫°nh |
| **Deep links** | C·∫ßn config server | Ho·∫°t ƒë·ªông t·ª± nhi√™n |
| **Build time** | Nhanh | Ch·∫≠m h∆°n (t·∫°o nhi·ªÅu HTML) |

---

### B) Static Frontend + Supabase

**√ù t∆∞·ªüng:**
- Frontend v·∫´n l√† static (A1 ho·∫∑c A2)
- Data + Auth ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi **Supabase** (Backend-as-a-Service)

**Supabase cung c·∫•p:**
- ‚úÖ PostgreSQL database (hosted)
- ‚úÖ Authentication (login, signup, OAuth)
- ‚úÖ Real-time subscriptions
- ‚úÖ Storage (file uploads)
- ‚úÖ Auto-generated REST APIs

**Workflow:**

```
1. Build static frontend ‚Üí Upload l√™n cheap hosting
   ‚Üì
2. Frontend fetch data t·ª´ Supabase APIs
   ‚Üì
3. N·ªôi dung live c√≥ th·ªÉ thay ƒë·ªïi ngay khi DB thay ƒë·ªïi
   (KH√îNG c·∫ßn rebuild frontend!)
```

**Mental Model:**
- Frontend = Giao di·ªán c·ª≠a h√†ng (tƒ©nh, kh√¥ng ƒë·ªïi)
- Supabase = Kho h√†ng + nh√¢n vi√™n (data ƒë·ªông, thay ƒë·ªïi li√™n t·ª•c)

---

#### Code Example: Vite + Supabase

```bash
npm install @supabase/supabase-js
```

```javascript
// src/lib/supabase.js
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = 'https://your-project.supabase.co';
const supabaseKey = 'your-anon-key';

export const supabase = createClient(supabaseUrl, supabaseKey);
```

```jsx
// src/pages/Products.jsx
import { useEffect, useState } from 'react';
import { supabase } from '../lib/supabase';

export default function Products() {
  const [products, setProducts] = useState([]);
  
  useEffect(() => {
    async function fetchProducts() {
      const { data } = await supabase
        .from('products')
        .select('*');
      
      setProducts(data);
    }
    
    fetchProducts();
  }, []);
  
  return (
    <div>
      <h1>Products</h1>
      {products.map(p => (
        <div key={p.id}>
          <h2>{p.name}</h2>
          <p>${p.price}</p>
        </div>
      ))}
    </div>
  );
}
```

**∆Øu ƒëi·ªÉm:**
- ‚úÖ N·ªôi dung c·∫≠p nh·∫≠t real-time (kh√¥ng c·∫ßn rebuild)
- ‚úÖ Kh√¥ng c·∫ßn qu·∫£n l√Ω server/database
- ‚úÖ Authentication built-in
- ‚úÖ Chi ph√≠ th·∫•p (Supabase free tier r·ªông r√£i)

**Nh∆∞·ª£c ƒëi·ªÉm:**
- ‚ùå SEO y·∫øu h∆°n (data fetch ·ªü client)
- ‚ùå Ph·ª• thu·ªôc v√†o Supabase (vendor lock-in)

**Khi n√†o d√πng:**
- ‚úÖ Apps c·∫ßn real-time data
- ‚úÖ Kh√¥ng mu·ªën qu·∫£n l√Ω backend
- ‚úÖ SEO kh√¥ng quan tr·ªçng l·∫Øm

---

### C) Static Frontend + Custom API + MongoDB Atlas

**√ù t∆∞·ªüng:**
- Frontend v·∫´n l√† static
- B·∫°n t·ª± x√¢y d·ª±ng backend API (Node.js/Express, serverless functions)
- Database: MongoDB Atlas (ho·∫∑c PostgreSQL, MySQL hosted)

**Ki·∫øn tr√∫c:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Static Frontend ‚îÇ ‚Üí Hosted tr√™n cheap hosting ($5/th√°ng)
‚îÇ (Vite + React)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ Fetch data qua API
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Your API      ‚îÇ ‚Üí Hosted tr√™n Vercel/Railway/Render (free tier)
‚îÇ (Node.js/Next)  ‚îÇ    ho·∫∑c VPS nh·ªè ($5/th√°ng)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ Query database
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ MongoDB Atlas   ‚îÇ ‚Üí Free tier (512MB)
‚îÇ   (Database)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Workflow:**

```
1. Build static frontend ‚Üí Upload l√™n cheap hosting
   ‚Üì
2. Deploy API l√™n serverless platform (Vercel, Railway) ho·∫∑c VPS
   ‚Üì
3. Frontend fetch data t·ª´ API c·ªßa b·∫°n
   ‚Üì
4. API query MongoDB Atlas ‚Üí Tr·∫£ v·ªÅ JSON
   ‚Üì
5. N·ªôi dung live c·∫≠p nh·∫≠t khi DB thay ƒë·ªïi (kh√¥ng c·∫ßn rebuild frontend)
```

---

#### Code Example: API v·ªõi Next.js API Routes

```javascript
// api-server/src/app/api/products/route.js
import { MongoClient } from 'mongodb';

const client = new MongoClient(process.env.MONGODB_URI);

export async function GET() {
  await client.connect();
  const db = client.db('mystore');
  const products = await db.collection('products').find({}).toArray();
  
  return Response.json(products);
}

export async function POST(request) {
  const { name, price } = await request.json();
  
  await client.connect();
  const db = client.db('mystore');
  const result = await db.collection('products').insertOne({ name, price });
  
  return Response.json({ success: true, id: result.insertedId });
}
```

**Frontend fetch data:**

```jsx
// frontend/src/pages/Products.jsx
import { useEffect, useState } from 'react';

export default function Products() {
  const [products, setProducts] = useState([]);
  
  useEffect(() => {
    fetch('https://your-api.vercel.app/api/products')
      .then(res => res.json())
      .then(data => setProducts(data));
  }, []);
  
  return (
    <div>
      <h1>Products</h1>
      {products.map(p => (
        <div key={p._id}>
          <h2>{p.name}</h2>
          <p>${p.price}</p>
        </div>
      ))}
    </div>
  );
}
```

**∆Øu ƒëi·ªÉm:**
- ‚úÖ Ki·ªÉm so√°t ho√†n to√†n backend
- ‚úÖ Kh√¥ng vendor lock-in
- ‚úÖ C√≥ th·ªÉ implement auth/permissions t√πy ch·ªânh
- ‚úÖ Chi ph√≠ th·∫•p (free tiers + cheap hosting)

**Nh∆∞·ª£c ƒëi·ªÉm:**
- ‚ùå Ph·∫£i t·ª± qu·∫£n l√Ω API + database
- ‚ùå Ph·ª©c t·∫°p h∆°n Supabase
- ‚ùå SEO y·∫øu h∆°n (data fetch ·ªü client)

**Khi n√†o d√πng:**
- ‚úÖ Mu·ªën ki·ªÉm so√°t ho√†n to√†n
- ‚úÖ C√≥ kinh nghi·ªám backend
- ‚úÖ C·∫ßn logic ph·ª©c t·∫°p kh√¥ng c√≥ s·∫µn trong Supabase

---

## So s√°nh t·ªïng h·ª£p c√°c ph∆∞∆°ng ph√°p

| Ph∆∞∆°ng ph√°p | Chi ph√≠ | SEO | Real-time Update | ƒê·ªô ph·ª©c t·∫°p | Khi n√†o d√πng |
|-------------|---------|-----|------------------|-------------|--------------|
| **Next.js Monorepo (SSG + SSR)** | Trung b√¨nh | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚ùå (C·∫ßn rebuild) | Cao | Blog, marketing site, content √≠t ƒë·ªïi |
| **Vite SPA (A1)** | R·∫•t th·∫•p | ‚≠ê‚≠ê | ‚ùå | Th·∫•p | Dashboards, internal tools |
| **Vite SSG (A2)** | R·∫•t th·∫•p | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚ùå (C·∫ßn rebuild) | Trung b√¨nh | Product catalogs, blogs |
| **Static + Supabase (B)** | Th·∫•p | ‚≠ê‚≠ê‚≠ê | ‚úÖ | Th·∫•p | Apps c·∫ßn real-time, kh√¥ng mu·ªën qu·∫£n l√Ω backend |
| **Static + Custom API (C)** | Th·∫•p | ‚≠ê‚≠ê‚≠ê | ‚úÖ | Trung b√¨nh | Mu·ªën ki·ªÉm so√°t ho√†n to√†n, logic ph·ª©c t·∫°p |

---

## Khuy·∫øn ngh·ªã theo Use Case

### 1. Blog c√° nh√¢n / Portfolio

**Ph∆∞∆°ng ph√°p:** Vite SSG (A2) ho·∫∑c Next.js SSG

**L√Ω do:**
- N·ªôi dung √≠t thay ƒë·ªïi
- SEO quan tr·ªçng
- Chi ph√≠ c·ª±c th·∫•p (~$5/th√°ng)

**Hosting:** Netlify, Vercel (free tier), ho·∫∑c shared hosting

---

### 2. E-commerce nh·ªè (< 100 s·∫£n ph·∫©m)

**Ph∆∞∆°ng ph√°p:** Next.js Monorepo ho·∫∑c Vite SSG + Supabase

**L√Ω do:**
- C·∫ßn SEO cho product pages
- Gi√°/stock c√≥ th·ªÉ c·∫≠p nh·∫≠t qua admin
- Chi ph√≠ th·∫•p

**Hosting:**
- Frontend: Netlify/Vercel (free)
- Admin/API: Vercel (free tier) ho·∫∑c VPS nh·ªè

---

### 3. Dashboard / Internal Tool

**Ph∆∞∆°ng ph√°p:** Vite SPA (A1) + Supabase

**L√Ω do:**
- Kh√¥ng c·∫ßn SEO
- C·∫ßn real-time data
- Nhanh ch√≥ng setup

**Hosting:** Netlify/Vercel (free tier)

---

### 4. Social Media / Real-time App

**Ph∆∞∆°ng ph√°p:** Vite SPA + Custom API + MongoDB Atlas

**L√Ω do:**
- C·∫ßn real-time updates
- Logic ph·ª©c t·∫°p (chat, notifications)
- Ki·ªÉm so√°t ho√†n to√†n

**Hosting:**
- Frontend: Netlify (free)
- API: Railway/Render (free tier) ho·∫∑c VPS
- DB: MongoDB Atlas (free 512MB)

---

## T√≥m t·∫Øt

**Quy t·∫Øc v√†ng:**

1. **C·∫ßn SEO m·∫°nh + n·ªôi dung √≠t ƒë·ªïi?** ‚Üí SSG (Next.js ho·∫∑c Vite A2)
2. **C·∫ßn real-time data + kh√¥ng mu·ªën qu·∫£n l√Ω backend?** ‚Üí Static + Supabase
3. **C·∫ßn ki·ªÉm so√°t ho√†n to√†n + logic ph·ª©c t·∫°p?** ‚Üí Static + Custom API
4. **Internal tool, kh√¥ng c·∫ßn SEO?** ‚Üí SPA (Vite A1)

**Chi ph√≠ t·ªïng:**
- T·ªëi thi·ªÉu: **$0** (Netlify + Supabase free tiers)
- T·ªëi ƒëa: **$10-20/th√°ng** (Shared hosting + VPS nh·ªè)

**So v·ªõi WordPress:**
- WordPress: ~$5-10/th√°ng (hosting + domain)
- React modern: ~$0-20/th√°ng (t√πy ph∆∞∆°ng ph√°p)

**K·∫øt lu·∫≠n:** B·∫°n ho√†n to√†n c√≥ th·ªÉ deploy React/Next.js v·ªõi chi ph√≠ t∆∞∆°ng ƒë∆∞∆°ng ho·∫∑c th·∫•p h∆°n WordPress, nh∆∞ng v·ªõi hi·ªáu su·∫•t v√† tr·∫£i nghi·ªám ng∆∞·ªùi d√πng t·ªët h∆°n nhi·ªÅu! üöÄ

---
The Bridge (ORM): In Mongo, you likely use Mongoose. In the Postgres world, Prisma or Drizzle are the gold standards. They give you full TypeScript safety, so your IDE knows exactly what your database looks like.

Postgres



## PH·∫¶N K·∫æT: T·ª™ H·ªåC GI·∫¢ ƒê·∫æN K·ª∏ S∆Ø

Ch√∫c m·ª´ng b·∫°n! Ch√∫ng ta ƒë√£ ƒëi t·ª´ nh·ªØng vi√™n g·∫°ch c∆° b·∫£n nh·∫•t (Element Object) ƒë·∫øn ki·∫øn tr√∫c m·ªôt ·ª©ng d·ª•ng ho√†n ch·ªânh.

_H·∫øt t√†i li·ªáu._